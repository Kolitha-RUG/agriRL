{"timers": {"training_iteration": 22.38051540000015, "restore_env_runners": 3.399999695830047e-05, "training_step": 22.379977899996447, "env_runner_sampling_timer": 12.029323100010515, "learner_update_timer": 10.339169400001992, "synch_weights": 0.003913399996235967}, "env_runners": {"rlmodule_inference_timer": 0.00034776176855182497, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.850000499980524e-05, "numpy_to_tensor": 0.0001062500014086254, "batch_individual_items": 6.470000516856089e-05, "add_time_dim_to_batch_and_zero_pad": 2.305000089108944e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "add_states_from_episodes_to_batch": 1.1000003723893315e-05}}, "num_agent_steps_sampled": {"human_1": 4000.0, "human_0": 4000.0, "human_2": 4000.0}, "agent_episode_returns_mean": {"human_0": -4181.511916666666, "human_2": -4136.829916666666, "human_1": -4170.638416666665}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008669805466310129, "timers": {"connectors": {"un_batch_to_individual_items": 7.481002516121562e-05, "module_to_agent_unmapping": 7.751949336517882e-06, "remove_single_ts_time_rank_from_batch": 3.445481626043537e-06, "listify_data_for_vector_env": 2.8237650944868884e-05, "get_actions": 0.00035418349397706823, "normalize_and_clip_actions": 0.00010301618456126294, "tensor_to_numpy": 0.00011686990667037017}}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0267361875304608e-05, "agent_to_module_mapping": 1.12397341531701e-05, "add_states_from_episodes_to_batch": 1.0522018569051927e-05, "add_observations_from_episodes_to_batch": 6.587543205369614e-05, "numpy_to_tensor": 7.759807916178037e-05, "batch_individual_items": 5.322379380379491e-05}}, "connector_pipeline_timer": 0.0003780886088976485}, "agent_steps": {"human_2": 2000.0, "human_1": 2000.0, "human_0": 2000.0}, "episode_len_max": 2000, "time_between_sampling": 0.03707106090110936, "connector_pipeline_timer": 0.000801100002718158, "env_reset_timer": 2.77403124999546, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled_lifetime": {"human_0": 22000.0, "human_2": 22000.0, "human_1": 22000.0}, "sample": 3.611731609671664, "episode_len_mean": 2000.0, "episode_len_min": 2000, "num_episodes": 2.0, "num_episodes_lifetime": 2.0, "module_episode_returns_mean": {"shared_policy": -11603.775416666664}, "episode_return_mean": -12488.980249999997, "env_step_timer": 0.002046086249725026, "env_to_module_sum_episodes_length_in": 129.70023112683015, "episode_return_min": -13824.628499999995, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_out": 129.70023112683015, "num_module_steps_sampled_lifetime": {"shared_policy": 66000.0}, "num_env_steps_sampled_lifetime": 22000.0, "episode_duration_sec_mean": 8.847536100009165, "episode_return_max": -11153.331999999997, "num_module_steps_sampled": {"shared_policy": 12000.0}, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"shared_policy": {"policy_loss": 0.0947612076997757, "num_module_steps_trained": 120832, "num_module_steps_trained_lifetime": 120832, "weights_seq_no": 1.0, "entropy": 1.096901535987854, "vf_loss": 9.85963249206543, "mean_kl_loss": 0.0011241923784837127, "total_loss": 9.943650245666504, "vf_loss_unclipped": 17689.0859375, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.10000000149011612, "vf_explained_var": 0.00027114152908325195, "num_trainable_parameters": 294916, "default_optimizer_learning_rate": 0.0003, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2200005585327744e-05, "add_observations_from_episodes_to_batch": 0.0014356999890878797, "add_columns_from_episodes_to_train_batch": 0.44240410000202246, "agent_to_module_mapping": 0.020411599994986318, "add_one_ts_to_episodes_and_truncate": 0.038586200011195615, "numpy_to_tensor": 0.0004932000010740012, "batch_individual_items": 0.47238479999941774, "add_time_dim_to_batch_and_zero_pad": 3.9699996705166996e-05, "general_advantage_estimation": 0.12299009998969268}}, "connector_pipeline_timer": 1.0999572000000626}, "num_module_steps_trained_lifetime": 120832, "num_env_steps_trained": 1888000, "learner_connector_sum_episodes_length_out": 4000, "num_env_steps_trained_lifetime": 1888000, "num_module_steps_trained": 120832, "num_non_trainable_parameters": 0, "num_trainable_parameters": 294916, "learner_connector_sum_episodes_length_in": 4000, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 22000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 1, "trial_id": "2fc41_00000", "date": "2026-01-15_15-34-31", "timestamp": 1768487671, "time_this_iter_s": 22.389569520950317, "time_total_s": 22.389569520950317, "pid": 34592, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x00000118D1E752D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.389569520950317, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.015625, "ram_util_percent": 45.253125000000004}}
{"timers": {"training_iteration": 22.383540941000103, "restore_env_runners": 3.388699697097763e-05, "training_step": 22.38300200299651, "env_runner_sampling_timer": 12.029701419010381, "learner_update_timer": 10.341772697002016, "synch_weights": 0.00391021199626266, "synch_env_connectors": 0.0050760000012815}, "env_runners": {"rlmodule_inference_timer": 0.00032562662287423264, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.850000499980524e-05, "numpy_to_tensor": 0.0001062500014086254, "batch_individual_items": 6.470000516856089e-05, "add_time_dim_to_batch_and_zero_pad": 2.305000089108944e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "add_states_from_episodes_to_batch": 1.1000003723893315e-05}}, "num_agent_steps_sampled": {"human_1": 4000.0, "human_0": 4000.0, "human_2": 4000.0}, "agent_episode_returns_mean": {"human_0": -4231.938083333333, "human_2": -4186.6871742424255, "human_1": -4221.07624242424}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008373873080595449, "timers": {"connectors": {"un_batch_to_individual_items": 7.526977103586059e-05, "module_to_agent_unmapping": 7.841574195550644e-06, "remove_single_ts_time_rank_from_batch": 3.4380523300935724e-06, "listify_data_for_vector_env": 2.7753851615702257e-05, "get_actions": 0.00034102592077887774, "normalize_and_clip_actions": 9.690326274207247e-05, "tensor_to_numpy": 0.00011057609172814685}}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.002260319044664e-05, "agent_to_module_mapping": 1.1255664922516296e-05, "add_states_from_episodes_to_batch": 9.996718517675668e-06, "add_observations_from_episodes_to_batch": 6.457479285869867e-05, "numpy_to_tensor": 7.598954435954603e-05, "batch_individual_items": 5.122746511337865e-05}}, "connector_pipeline_timer": 0.00036819037022727495}, "agent_steps": {"human_2": 2000.0, "human_1": 2000.0, "human_0": 2000.0}, "episode_len_max": 2000, "time_between_sampling": 0.13550692715478804, "connector_pipeline_timer": 0.000801100002718158, "env_reset_timer": 2.77403124999546, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled_lifetime": {"human_0": 26000.0, "human_2": 26000.0, "human_1": 26000.0}, "sample": 3.378094407084613, "episode_len_mean": 2000.0, "episode_len_min": 2000, "num_episodes": 2.0, "num_episodes_lifetime": 4.000000000000002, "module_episode_returns_mean": {"shared_policy": -11731.498598484844}, "episode_return_mean": -12639.701499999996, "env_step_timer": 0.002486355744527925, "env_to_module_sum_episodes_length_in": 131.69041762873871, "episode_return_min": -14397.921499999997, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 131.69041762873871, "num_module_steps_sampled_lifetime": {"shared_policy": 78000.0}, "num_env_steps_sampled_lifetime": 26000.0, "episode_duration_sec_mean": 8.84516959091641, "episode_return_max": -11153.331999999997, "num_module_steps_sampled": {"shared_policy": 12000.0}, "num_env_steps_sampled_lifetime_throughput": 178.12293093513028}, "learners": {"shared_policy": {"policy_loss": 0.0037082151975482702, "num_module_steps_trained": 120832, "num_module_steps_trained_lifetime": 241664, "weights_seq_no": 2.0, "entropy": 1.0921130180358887, "vf_loss": 9.944926261901855, "mean_kl_loss": 0.004564633127301931, "total_loss": 9.938169479370117, "vf_loss_unclipped": 22536.9765625, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.05000000074505806, "vf_explained_var": 0.0006407499313354492, "num_trainable_parameters": 294916, "default_optimizer_learning_rate": 0.0003, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2189005501568317e-05, "add_observations_from_episodes_to_batch": 0.0014320629891881255, "add_columns_from_episodes_to_train_batch": 0.4423616530020081, "agent_to_module_mapping": 0.020418622995057374, "add_one_ts_to_episodes_and_truncate": 0.03848959301103604, "numpy_to_tensor": 0.000490882001031423, "batch_individual_items": 0.47404693999938896, "add_time_dim_to_batch_and_zero_pad": 3.966699674492702e-05, "general_advantage_estimation": 0.12284456198976841}}, "connector_pipeline_timer": 1.101329212000128}, "num_module_steps_trained_lifetime": 241664, "num_env_steps_trained": 1888000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 3776000, "num_module_steps_trained": 120832, "num_non_trainable_parameters": 0, "num_trainable_parameters": 294916, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 26000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 2, "trial_id": "2fc41_00000", "date": "2026-01-15_15-34-54", "timestamp": 1768487694, "time_this_iter_s": 22.691225051879883, "time_total_s": 45.0807945728302, "pid": 34592, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x00000118D1E76C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.0807945728302, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.759375, "ram_util_percent": 45.425}}
{"timers": {"training_iteration": 22.39978880359015, "restore_env_runners": 3.378712707490194e-05, "training_step": 22.399249383966563, "env_runner_sampling_timer": 12.037649917820278, "learner_update_timer": 10.350049744032058, "synch_weights": 0.003910214876332611, "synch_env_connectors": 0.005061610001284862}, "env_runners": {"rlmodule_inference_timer": 0.00037462458131828577, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.850000499980524e-05, "numpy_to_tensor": 0.0001062500014086254, "batch_individual_items": 6.470000516856089e-05, "add_time_dim_to_batch_and_zero_pad": 2.305000089108944e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "add_states_from_episodes_to_batch": 1.1000003723893315e-05}}, "num_agent_steps_sampled": {"human_1": 4000.0, "human_0": 4000.0, "human_2": 4000.0}, "agent_episode_returns_mean": {"human_0": -4452.484444444444, "human_2": -4406.669861111111, "human_1": -4442.1640039682525}, "module_to_env_connector": {"connector_pipeline_timer": 0.000916529407888814, "timers": {"connectors": {"un_batch_to_individual_items": 7.887559800718958e-05, "module_to_agent_unmapping": 8.179818326840528e-06, "remove_single_ts_time_rank_from_batch": 3.735648063251034e-06, "listify_data_for_vector_env": 2.9259667110257032e-05, "get_actions": 0.0003835080538263001, "normalize_and_clip_actions": 0.00010556085070290871, "tensor_to_numpy": 0.00011869787308459777}}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.303691927371967e-05, "agent_to_module_mapping": 1.245780712196696e-05, "add_states_from_episodes_to_batch": 1.1377429259123087e-05, "add_observations_from_episodes_to_batch": 7.13618663166298e-05, "numpy_to_tensor": 8.877357732371363e-05, "batch_individual_items": 5.8104157064769805e-05}}, "connector_pipeline_timer": 0.0004120614080042852}, "agent_steps": {"human_2": 2000.0, "human_1": 2000.0, "human_0": 2000.0}, "episode_len_max": 2000, "time_between_sampling": 0.22700811067308066, "connector_pipeline_timer": 0.000801100002718158, "env_reset_timer": 2.77403124999546, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled_lifetime": {"human_0": 30000.0, "human_2": 30000.0, "human_1": 30000.0}, "sample": 3.1711427259841076, "episode_len_mean": 2000.0, "episode_len_min": 2000, "num_episodes": 2.0, "num_episodes_lifetime": 6.0000000000000036, "module_episode_returns_mean": {"shared_policy": -12290.28156349206}, "episode_return_mean": -13301.31830952381, "env_step_timer": 0.0025982820963862917, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_return_min": -14397.921499999997, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 131.6904176324108, "num_module_steps_sampled_lifetime": {"shared_policy": 90000.0}, "num_env_steps_sampled_lifetime": 30000.0, "episode_duration_sec_mean": 8.874522823808851, "episode_return_max": -11153.331999999997, "num_module_steps_sampled": {"shared_policy": 12000.0}, "num_env_steps_sampled_lifetime_throughput": 177.73505846712905}, "learners": {"shared_policy": {"policy_loss": -0.0008370072464458644, "num_module_steps_trained": 120832, "num_module_steps_trained_lifetime": 362496, "weights_seq_no": 3.0, "entropy": 1.0972435474395752, "vf_loss": 9.863926887512207, "mean_kl_loss": 0.005015017930418253, "total_loss": 9.852367401123047, "vf_loss_unclipped": 17764.234375, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.05000000074505806, "vf_explained_var": 5.5670738220214844e-05, "num_trainable_parameters": 294916, "default_optimizer_learning_rate": 0.0003, "num_module_steps_trained_lifetime_throughput": 5024.33525169579}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2182115449104457e-05, "add_observations_from_episodes_to_batch": 0.0014287563591977234, "add_columns_from_episodes_to_train_batch": 0.44253875847201996, "agent_to_module_mapping": 0.020425750765150585, "add_one_ts_to_episodes_and_truncate": 0.038421233080953236, "numpy_to_tensor": 0.0004904971809810377, "batch_individual_items": 0.47395886059936887, "add_time_dim_to_batch_and_zero_pad": 3.962032682320569e-05, "general_advantage_estimation": 0.12274886836984661}}, "connector_pipeline_timer": 1.1012506498801349}, "num_module_steps_trained_lifetime": 362496, "num_env_steps_trained": 1888000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 5664000, "num_module_steps_trained": 120832, "num_non_trainable_parameters": 0, "num_trainable_parameters": 294916, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime_throughput": 78505.19652424134, "num_module_steps_trained_lifetime_throughput": 5024.337696034557}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 3, "trial_id": "2fc41_00000", "date": "2026-01-15_15-35-18", "timestamp": 1768487718, "time_this_iter_s": 24.017356395721436, "time_total_s": 69.09815096855164, "pid": 34592, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x00000118D1E751B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.09815096855164, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 32.66969696969697, "ram_util_percent": 46.16363636363636}}
{"timers": {"training_iteration": 22.40736336455433, "restore_env_runners": 3.374225585241219e-05, "training_step": 22.406819665126953, "env_runner_sampling_timer": 12.042621605642129, "learner_update_timer": 10.352647404591687, "synch_weights": 0.00390555172757931, "synch_env_connectors": 0.005056038901278225}, "env_runners": {"rlmodule_inference_timer": 0.0003541808187770076, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.850000499980524e-05, "numpy_to_tensor": 0.0001062500014086254, "batch_individual_items": 6.470000516856089e-05, "add_time_dim_to_batch_and_zero_pad": 2.305000089108944e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "add_states_from_episodes_to_batch": 1.1000003723893315e-05}}, "num_agent_steps_sampled": {"human_1": 4000.0, "human_0": 4000.0, "human_2": 4000.0}, "agent_episode_returns_mean": {"human_0": -4483.318913333333, "human_2": -4453.252703333333, "human_1": -4475.352348333334}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008991110610367884, "timers": {"connectors": {"un_batch_to_individual_items": 7.74841680924454e-05, "module_to_agent_unmapping": 8.145749764439723e-06, "remove_single_ts_time_rank_from_batch": 3.605380796725674e-06, "listify_data_for_vector_env": 2.8754588548251116e-05, "get_actions": 0.0003754707334714618, "normalize_and_clip_actions": 0.00010262221911222971, "tensor_to_numpy": 0.00011649061613432016}}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2522091253333793e-05, "agent_to_module_mapping": 1.1716087036495406e-05, "add_states_from_episodes_to_batch": 1.0688646774515022e-05, "add_observations_from_episodes_to_batch": 6.931158093617911e-05, "numpy_to_tensor": 8.732997855149879e-05, "batch_individual_items": 5.55680211967709e-05}}, "connector_pipeline_timer": 0.00040127403698754103}, "agent_steps": {"human_2": 2000.0, "human_1": 2000.0, "human_0": 2000.0}, "episode_len_max": 2000, "time_between_sampling": 0.31541924373136365, "connector_pipeline_timer": 0.000801100002718158, "env_reset_timer": 2.77403124999546, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled_lifetime": {"human_0": 34000.0, "human_2": 34000.0, "human_1": 34000.0}, "sample": 2.989204551900598, "episode_len_mean": 2000.0, "episode_len_min": 2000, "num_episodes": 2.0, "num_episodes_lifetime": 8.000000000000004, "module_episode_returns_mean": {"shared_policy": -12370.888663333331}, "episode_return_mean": -13411.923964999998, "env_step_timer": 0.0025654167951164775, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_return_min": -15187.640500000001, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 131.6904176324108, "num_module_steps_sampled_lifetime": {"shared_policy": 102000.0}, "num_env_steps_sampled_lifetime": 34000.0, "episode_duration_sec_mean": 9.183777300000367, "episode_return_max": -11153.331999999997, "num_module_steps_sampled": {"shared_policy": 12000.0}, "num_env_steps_sampled_lifetime_throughput": 177.2630998359652}, "learners": {"shared_policy": {"policy_loss": -0.04275822266936302, "num_module_steps_trained": 120832, "num_module_steps_trained_lifetime": 483328, "weights_seq_no": 4.0, "entropy": 1.0957722663879395, "vf_loss": 9.970606803894043, "mean_kl_loss": 0.00344825885258615, "total_loss": 9.91706371307373, "vf_loss_unclipped": 23890.828125, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.02500000037252903, "vf_explained_var": 0.00015729665756225586, "num_trainable_parameters": 294916, "default_optimizer_learning_rate": 0.0003, "num_module_steps_trained_lifetime_throughput": 5033.472267302069}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2174294289550744e-05, "add_observations_from_episodes_to_batch": 0.0014255247955359956, "add_columns_from_episodes_to_train_batch": 0.44240704388721985, "agent_to_module_mapping": 0.020409712257473275, "add_one_ts_to_episodes_and_truncate": 0.038359889750081484, "numpy_to_tensor": 0.00048807220913768106, "batch_individual_items": 0.47569915699338305, "add_time_dim_to_batch_and_zero_pad": 3.956012363961782e-05, "general_advantage_estimation": 0.12256286968606407}}, "connector_pipeline_timer": 1.1025826453813843}, "num_module_steps_trained_lifetime": 483328, "num_env_steps_trained": 1888000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 7552000, "num_module_steps_trained": 120832, "num_non_trainable_parameters": 0, "num_trainable_parameters": 294916, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime_throughput": 78647.95491059664, "num_module_steps_trained_lifetime_throughput": 5033.475738311777}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 34000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 4, "trial_id": "2fc41_00000", "date": "2026-01-15_15-35-41", "timestamp": 1768487741, "time_this_iter_s": 23.16526484489441, "time_total_s": 92.26341581344604, "pid": 34592, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x00000118D1E77880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.26341581344604, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 31.84242424242424, "ram_util_percent": 46.22727272727273}}
{"timers": {"training_iteration": 22.40574354390882, "restore_env_runners": 3.362683323807577e-05, "training_step": 22.405199403475773, "env_runner_sampling_timer": 12.042850549585731, "learner_update_timer": 10.350781888545763, "synch_weights": 0.003906351210226198, "synch_env_connectors": 0.005042132512261349}, "env_runners": {"rlmodule_inference_timer": 0.00032261718954498564, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.850000499980524e-05, "numpy_to_tensor": 0.0001062500014086254, "batch_individual_items": 6.470000516856089e-05, "add_time_dim_to_batch_and_zero_pad": 2.305000089108944e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "add_states_from_episodes_to_batch": 1.1000003723893315e-05}}, "num_agent_steps_sampled": {"human_1": 4000.0, "human_0": 4000.0, "human_2": 4000.0}, "agent_episode_returns_mean": {"human_0": -4671.647484999999, "human_2": -4655.705649999999, "human_1": -4650.765945}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008330526427893835, "timers": {"connectors": {"un_batch_to_individual_items": 7.506958986968247e-05, "module_to_agent_unmapping": 7.6172177241320855e-06, "remove_single_ts_time_rank_from_batch": 3.3698706845498104e-06, "listify_data_for_vector_env": 2.8646355604739177e-05, "get_actions": 0.0003370620259082849, "normalize_and_clip_actions": 9.701236360629343e-05, "tensor_to_numpy": 0.00010880355783125166}}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.9582339801559693e-05, "agent_to_module_mapping": 1.0846241329581108e-05, "add_states_from_episodes_to_batch": 1.0123235229485107e-05, "add_observations_from_episodes_to_batch": 6.419947814462189e-05, "numpy_to_tensor": 7.5891477969776e-05, "batch_individual_items": 5.076069311831183e-05}}, "connector_pipeline_timer": 0.0003661988322930876}, "agent_steps": {"human_2": 2000.0, "human_1": 2000.0, "human_0": 2000.0}, "episode_len_max": 2000, "time_between_sampling": 0.38985931564888116, "connector_pipeline_timer": 0.000801100002718158, "env_reset_timer": 2.77403124999546, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled_lifetime": {"human_0": 38000.0, "human_2": 38000.0, "human_1": 38000.0}, "sample": 2.81589267215216, "episode_len_mean": 2000.0, "episode_len_min": 2000, "num_episodes": 2.0, "num_episodes_lifetime": 9.999999999999991, "module_episode_returns_mean": {"shared_policy": -12857.362971666666}, "episode_return_mean": -13978.119079999993, "env_step_timer": 0.0024991294757299265, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_return_min": -15187.640500000001, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 131.6904176324108, "num_module_steps_sampled_lifetime": {"shared_policy": 114000.0}, "num_env_steps_sampled_lifetime": 38000.0, "episode_duration_sec_mean": 9.309259416005515, "episode_return_max": -11909.119999999999, "num_module_steps_sampled": {"shared_policy": 12000.0}, "num_env_steps_sampled_lifetime_throughput": 177.19876111125518}, "learners": {"shared_policy": {"policy_loss": 0.002966426545754075, "num_module_steps_trained": 120832, "num_module_steps_trained_lifetime": 604160, "weights_seq_no": 5.0, "entropy": 1.0964441299438477, "vf_loss": 9.867818832397461, "mean_kl_loss": 0.004034086596220732, "total_loss": 9.8599214553833, "vf_loss_unclipped": 16407.123046875, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.012500000186264515, "vf_explained_var": 0.00015556812286376953, "num_trainable_parameters": 294916, "default_optimizer_learning_rate": 0.0003, "num_module_steps_trained_lifetime_throughput": 5052.882067002191}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2190551378821256e-05, "add_observations_from_episodes_to_batch": 0.0014220595476682172, "add_columns_from_episodes_to_train_batch": 0.44234834444836935, "agent_to_module_mapping": 0.02042672313486735, "add_one_ts_to_episodes_and_truncate": 0.03829288985250586, "numpy_to_tensor": 0.0004856524871591209, "batch_individual_items": 0.4756098934235078, "add_time_dim_to_batch_and_zero_pad": 3.9771522368606245e-05, "general_advantage_estimation": 0.12242719798913444}}, "connector_pipeline_timer": 1.1022365579276132}, "num_module_steps_trained_lifetime": 604160, "num_env_steps_trained": 1888000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 9440000, "num_module_steps_trained": 120832, "num_non_trainable_parameters": 0, "num_trainable_parameters": 294916, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime_throughput": 78951.24716347945, "num_module_steps_trained_lifetime_throughput": 5052.8842953054}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 38000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 5, "trial_id": "2fc41_00000", "date": "2026-01-15_15-36-03", "timestamp": 1768487763, "time_this_iter_s": 22.253250122070312, "time_total_s": 114.51666593551636, "pid": 34592, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x00000118D1ED1F30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 114.51666593551636, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.403225806451612, "ram_util_percent": 45.65806451612901}}
{"timers": {"training_iteration": 22.405622230469742, "restore_env_runners": 3.3540564917569376e-05, "training_step": 22.405076479440883, "env_runner_sampling_timer": 12.041027432089871, "learner_update_timer": 10.352473310660388, "synch_weights": 0.003903755698158738, "synch_env_connectors": 0.00502816018717438}, "env_runners": {"rlmodule_inference_timer": 0.00032550759157093064, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.850000499980524e-05, "numpy_to_tensor": 0.0001062500014086254, "batch_individual_items": 6.470000516856089e-05, "add_time_dim_to_batch_and_zero_pad": 2.305000089108944e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "add_states_from_episodes_to_batch": 1.1000003723893315e-05}}, "num_agent_steps_sampled": {"human_1": 4000.0, "human_0": 4000.0, "human_2": 4000.0}, "agent_episode_returns_mean": {"human_0": -4530.825341666666, "human_2": -4511.302871666666, "human_1": -4497.681386666666}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008363306719951679, "timers": {"connectors": {"un_batch_to_individual_items": 7.406644533598293e-05, "module_to_agent_unmapping": 8.507333999731958e-06, "remove_single_ts_time_rank_from_batch": 3.3045138718512473e-06, "listify_data_for_vector_env": 2.781959311553687e-05, "get_actions": 0.00033949011477436554, "normalize_and_clip_actions": 9.684362961102785e-05, "tensor_to_numpy": 0.00010923957133383125}}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.9685903282973273e-05, "agent_to_module_mapping": 1.0896431411851256e-05, "add_states_from_episodes_to_batch": 1.1006598990194902e-05, "add_observations_from_episodes_to_batch": 6.385051551415611e-05, "numpy_to_tensor": 7.598284491981649e-05, "batch_individual_items": 5.1745870398326574e-05}}, "connector_pipeline_timer": 0.00036894992475633925}, "agent_steps": {"human_2": 2000.0, "human_1": 2000.0, "human_0": 2000.0}, "episode_len_max": 2000, "time_between_sampling": 0.4529821719665305, "connector_pipeline_timer": 0.000801100002718158, "env_reset_timer": 2.77403124999546, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled_lifetime": {"human_0": 42000.0, "human_2": 42000.0, "human_1": 42000.0}, "sample": 2.6577916098667487, "episode_len_mean": 2000.0, "episode_len_min": 2000, "num_episodes": 2.0, "num_episodes_lifetime": 11.999999999999991, "module_episode_returns_mean": {"shared_policy": -12484.382821666664}, "episode_return_mean": -13539.8096, "env_step_timer": 0.0024751689140373257, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_return_min": -15187.640500000001, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 131.6904176324108, "num_module_steps_sampled_lifetime": {"shared_policy": 126000.0}, "num_env_steps_sampled_lifetime": 42000.0, "episode_duration_sec_mean": 9.131500758007169, "episode_return_max": -11909.119999999999, "num_module_steps_sampled": {"shared_policy": 12000.0}, "num_env_steps_sampled_lifetime_throughput": 177.3959803617236}, "learners": {"shared_policy": {"policy_loss": -0.08830160647630692, "num_module_steps_trained": 120832, "num_module_steps_trained_lifetime": 724992, "weights_seq_no": 6.0, "entropy": 1.0891666412353516, "vf_loss": 9.915205955505371, "mean_kl_loss": 0.0061145955696702, "total_loss": 9.81609058380127, "vf_loss_unclipped": 16695.248046875, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.012500000186264515, "vf_explained_var": 3.987550735473633e-05, "num_trainable_parameters": 294916, "default_optimizer_learning_rate": 0.0003, "num_module_steps_trained_lifetime_throughput": 5069.511907129126}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2188645760138182e-05, "add_observations_from_episodes_to_batch": 0.001418594952165743, "add_columns_from_episodes_to_train_batch": 0.44249007900394727, "agent_to_module_mapping": 0.020427027903593808, "add_one_ts_to_episodes_and_truncate": 0.03820321495397005, "numpy_to_tensor": 0.0004832399622709, "batch_individual_items": 0.477461564489246, "add_time_dim_to_batch_and_zero_pad": 3.9775807150044316e-05, "general_advantage_estimation": 0.12227330600926231}}, "connector_pipeline_timer": 1.1039740443483546}, "num_module_steps_trained_lifetime": 724992, "num_env_steps_trained": 1888000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 11328000, "num_module_steps_trained": 120832, "num_non_trainable_parameters": 0, "num_trainable_parameters": 294916, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime_throughput": 79211.08861568522, "num_module_steps_trained_lifetime_throughput": 5069.513871597863}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 42000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 6, "trial_id": "2fc41_00000", "date": "2026-01-15_15-36-26", "timestamp": 1768487786, "time_this_iter_s": 22.402220487594604, "time_total_s": 136.91888642311096, "pid": 34592, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x00000118D1ED23B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.91888642311096, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.680645161290315, "ram_util_percent": 45.5}}
{"timers": {"training_iteration": 22.40453326416502, "restore_env_runners": 3.3463159341183986e-05, "training_step": 22.4039869516466, "env_runner_sampling_timer": 12.040090020768947, "learner_update_timer": 10.352302440553723, "synch_weights": 0.003908146141239854, "synch_env_connectors": 0.005010430585350509}, "env_runners": {"rlmodule_inference_timer": 0.0003304218662899285, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.850000499980524e-05, "numpy_to_tensor": 0.0001062500014086254, "batch_individual_items": 6.470000516856089e-05, "add_time_dim_to_batch_and_zero_pad": 2.305000089108944e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "add_states_from_episodes_to_batch": 1.1000003723893315e-05}}, "num_agent_steps_sampled": {"human_1": 4000.0, "human_0": 4000.0, "human_2": 4000.0}, "agent_episode_returns_mean": {"human_0": -4399.094783333333, "human_2": -4370.154898333331, "human_1": -4371.650358333332}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008337650510450545, "timers": {"connectors": {"un_batch_to_individual_items": 7.617531722894474e-05, "module_to_agent_unmapping": 7.787382231855242e-06, "remove_single_ts_time_rank_from_batch": 3.349105243924824e-06, "listify_data_for_vector_env": 2.770568979648338e-05, "get_actions": 0.0003403502163719213, "normalize_and_clip_actions": 9.609179927432591e-05, "tensor_to_numpy": 0.00010754597761379599}}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.9617183638015983e-05, "agent_to_module_mapping": 1.075584408938274e-05, "add_states_from_episodes_to_batch": 1.013137166315871e-05, "add_observations_from_episodes_to_batch": 6.376347298192787e-05, "numpy_to_tensor": 7.673748045118038e-05, "batch_individual_items": 5.156761950840447e-05}}, "connector_pipeline_timer": 0.0003661470266957733}, "agent_steps": {"human_2": 2000.0, "human_1": 2000.0, "human_0": 2000.0}, "episode_len_max": 2000, "time_between_sampling": 0.5133438543050671, "connector_pipeline_timer": 0.000801100002718158, "env_reset_timer": 2.77403124999546, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled_lifetime": {"human_0": 46000.0, "human_2": 46000.0, "human_1": 46000.0}, "sample": 2.515329029158953, "episode_len_mean": 2000.0, "episode_len_min": 2000, "num_episodes": 2.0, "num_episodes_lifetime": 13.999999999999984, "module_episode_returns_mean": {"shared_policy": -12161.155178333334}, "episode_return_mean": -13140.900039999997, "env_step_timer": 0.002489025478314261, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_return_min": -15187.640500000001, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 131.6904176324108, "num_module_steps_sampled_lifetime": {"shared_policy": 138000.0}, "num_env_steps_sampled_lifetime": 46000.0, "episode_duration_sec_mean": 8.906292780001968, "episode_return_max": -10775.5415, "num_module_steps_sampled": {"shared_policy": 12000.0}, "num_env_steps_sampled_lifetime_throughput": 177.40665422810426}, "learners": {"shared_policy": {"policy_loss": 0.06222536042332649, "num_module_steps_trained": 120832, "num_module_steps_trained_lifetime": 845824, "weights_seq_no": 7.0, "entropy": 1.0730798244476318, "vf_loss": 9.891790390014648, "mean_kl_loss": 0.007779764477163553, "total_loss": 9.943380355834961, "vf_loss_unclipped": 16436.8984375, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.012500000186264515, "vf_explained_var": 0.0001265406608581543, "num_trainable_parameters": 294916, "default_optimizer_learning_rate": 0.0003, "num_module_steps_trained_lifetime_throughput": 5086.502512844939}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2173759389691829e-05, "add_observations_from_episodes_to_batch": 0.0014190610027439718, "add_columns_from_episodes_to_train_batch": 0.4424221962139175, "agent_to_module_mapping": 0.020432802624543125, "add_one_ts_to_episodes_and_truncate": 0.03812580480439726, "numpy_to_tensor": 0.0004810735627212681, "batch_individual_items": 0.477639129844325, "add_time_dim_to_batch_and_zero_pad": 3.970304907942863e-05, "general_advantage_estimation": 0.12218529494915764}}, "connector_pipeline_timer": 1.1039156719047916}, "num_module_steps_trained_lifetime": 845824, "num_env_steps_trained": 1888000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 13216000, "num_module_steps_trained": 120832, "num_non_trainable_parameters": 0, "num_trainable_parameters": 294916, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime_throughput": 79476.56874692586, "num_module_steps_trained_lifetime_throughput": 5086.5047544402005}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 46000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 7, "trial_id": "2fc41_00000", "date": "2026-01-15_15-36-48", "timestamp": 1768487808, "time_this_iter_s": 22.305041074752808, "time_total_s": 159.22392749786377, "pid": 34592, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x00000118D1E771C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 159.22392749786377, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.79375, "ram_util_percent": 45.409375}}
{"timers": {"training_iteration": 22.404825442523418, "restore_env_runners": 3.335452772241782e-05, "training_step": 22.404278945130105, "env_runner_sampling_timer": 12.039627206561295, "learner_update_timer": 10.353047170148214, "synch_weights": 0.0039033736798662305, "synch_env_connectors": 0.004994995279366613}, "env_runners": {"rlmodule_inference_timer": 0.00032649562945172316, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.850000499980524e-05, "numpy_to_tensor": 0.0001062500014086254, "batch_individual_items": 6.470000516856089e-05, "add_time_dim_to_batch_and_zero_pad": 2.305000089108944e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "add_states_from_episodes_to_batch": 1.1000003723893315e-05}}, "num_agent_steps_sampled": {"human_1": 4000.0, "human_0": 4000.0, "human_2": 4000.0}, "agent_episode_returns_mean": {"human_0": -4187.870588333332, "human_2": -4158.767978333331, "human_1": -4168.345273333332}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008237671478617245, "timers": {"connectors": {"un_batch_to_individual_items": 7.336992170491693e-05, "module_to_agent_unmapping": 7.459212198536814e-06, "remove_single_ts_time_rank_from_batch": 3.280130356299752e-06, "listify_data_for_vector_env": 2.701098565916502e-05, "get_actions": 0.0003361734215435859, "normalize_and_clip_actions": 9.625731283524508e-05, "tensor_to_numpy": 0.00010770439843552383}}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.9900348000425954e-05, "agent_to_module_mapping": 1.085788153786262e-05, "add_states_from_episodes_to_batch": 1.0215513784259584e-05, "add_observations_from_episodes_to_batch": 6.426089303262429e-05, "numpy_to_tensor": 7.672354689481392e-05, "batch_individual_items": 5.167889238783985e-05}}, "connector_pipeline_timer": 0.00036886291768930185}, "agent_steps": {"human_2": 2000.0, "human_1": 2000.0, "human_0": 2000.0}, "episode_len_max": 2000, "time_between_sampling": 0.5663053891502143, "connector_pipeline_timer": 0.000801100002718158, "env_reset_timer": 2.77403124999546, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled_lifetime": {"human_0": 50000.0, "human_2": 50000.0, "human_1": 50000.0}, "sample": 2.386899121471196, "episode_len_mean": 2000.0, "episode_len_min": 2000, "num_episodes": 2.0, "num_episodes_lifetime": 15.999999999999984, "module_episode_returns_mean": {"shared_policy": -11572.06426833333}, "episode_return_mean": -12514.983839999995, "env_step_timer": 0.0024730497168974296, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_return_min": -13555.397499999995, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 131.6904176324108, "num_module_steps_sampled_lifetime": {"shared_policy": 150000.0}, "num_env_steps_sampled_lifetime": 50000.0, "episode_duration_sec_mean": 8.835822588988957, "episode_return_max": -10775.5415, "num_module_steps_sampled": {"shared_policy": 12000.0}, "num_env_steps_sampled_lifetime_throughput": 177.47046290380996}, "learners": {"shared_policy": {"policy_loss": 0.08634443581104279, "num_module_steps_trained": 120832, "num_module_steps_trained_lifetime": 966656, "weights_seq_no": 8.0, "entropy": 1.0866409540176392, "vf_loss": 9.9596529006958, "mean_kl_loss": 0.00822671689093113, "total_loss": 10.035232543945312, "vf_loss_unclipped": 16480.724609375, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.012500000186264515, "vf_explained_var": 0.00047147274017333984, "num_trainable_parameters": 294916, "default_optimizer_learning_rate": 0.0003, "num_module_steps_trained_lifetime_throughput": 5100.971628627705}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2169021813575722e-05, "add_observations_from_episodes_to_batch": 0.001415988392827842, "add_columns_from_episodes_to_train_batch": 0.44243724025175046, "agent_to_module_mapping": 0.020432138598298264, "add_one_ts_to_episodes_and_truncate": 0.038057545756369424, "numpy_to_tensor": 0.0004791208271739238, "batch_individual_items": 0.4793087315459702, "add_time_dim_to_batch_and_zero_pad": 3.963201859713359e-05, "general_advantage_estimation": 0.12202015399965657}}, "connector_pipeline_timer": 1.1053544081857756}, "num_module_steps_trained_lifetime": 966656, "num_env_steps_trained": 1888000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 15104000, "num_module_steps_trained": 120832, "num_non_trainable_parameters": 0, "num_trainable_parameters": 294916, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime_throughput": 79702.65335891984, "num_module_steps_trained_lifetime_throughput": 5100.973144657697}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 50000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 8, "trial_id": "2fc41_00000", "date": "2026-01-15_15-37-10", "timestamp": 1768487830, "time_this_iter_s": 22.440924406051636, "time_total_s": 181.6648519039154, "pid": 34592, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x00000118D1ED32E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 181.6648519039154, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.04193548387097, "ram_util_percent": 45.40000000000002}}
{"timers": {"training_iteration": 22.40652202209811, "restore_env_runners": 3.325298246552628e-05, "training_step": 22.40597497367876, "env_runner_sampling_timer": 12.04004078849579, "learner_update_timer": 10.354283311446688, "synch_weights": 0.003901961943158346, "synch_env_connectors": 0.0049790793265550035}, "env_runners": {"rlmodule_inference_timer": 0.0003414404188840933, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.850000499980524e-05, "numpy_to_tensor": 0.0001062500014086254, "batch_individual_items": 6.470000516856089e-05, "add_time_dim_to_batch_and_zero_pad": 2.305000089108944e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "add_states_from_episodes_to_batch": 1.1000003723893315e-05}}, "num_agent_steps_sampled": {"human_1": 4000.0, "human_0": 4000.0, "human_2": 4000.0}, "agent_episode_returns_mean": {"human_0": -4094.7347066666653, "human_2": -4066.2215916666646, "human_1": -4070.6722016666654}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008486286911056307, "timers": {"connectors": {"un_batch_to_individual_items": 7.477204666733492e-05, "module_to_agent_unmapping": 7.678618156121664e-06, "remove_single_ts_time_rank_from_batch": 3.431774069748206e-06, "listify_data_for_vector_env": 2.8760547375127662e-05, "get_actions": 0.00034735048883814126, "normalize_and_clip_actions": 9.841168125203242e-05, "tensor_to_numpy": 0.00011098692112303909}}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0415179064013983e-05, "agent_to_module_mapping": 1.1614380386703687e-05, "add_states_from_episodes_to_batch": 1.0341104388064082e-05, "add_observations_from_episodes_to_batch": 6.631661065429535e-05, "numpy_to_tensor": 8.002829976502565e-05, "batch_individual_items": 5.352201605728492e-05}}, "connector_pipeline_timer": 0.0003794374442240871}, "agent_steps": {"human_2": 2000.0, "human_1": 2000.0, "human_0": 2000.0}, "episode_len_max": 2000, "time_between_sampling": 0.6148612625141389, "connector_pipeline_timer": 0.000801100002718158, "env_reset_timer": 2.77403124999546, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled_lifetime": {"human_0": 54000.0, "human_2": 54000.0, "human_1": 54000.0}, "sample": 2.271444057165659, "episode_len_mean": 2000.0, "episode_len_min": 2000, "num_episodes": 2.0, "num_episodes_lifetime": 17.999999999999986, "module_episode_returns_mean": {"shared_policy": -11298.830173333332}, "episode_return_mean": -12231.628499999997, "env_step_timer": 0.002494297642519409, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_return_min": -13555.397499999995, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 131.6904176324108, "num_module_steps_sampled_lifetime": {"shared_policy": 162000.0}, "num_env_steps_sampled_lifetime": 54000.0, "episode_duration_sec_mean": 8.846368509984604, "episode_return_max": -10775.5415, "num_module_steps_sampled": {"shared_policy": 12000.0}, "num_env_steps_sampled_lifetime_throughput": 177.461109786592}, "learners": {"shared_policy": {"policy_loss": -0.08941809087991714, "num_module_steps_trained": 120832, "num_module_steps_trained_lifetime": 1087488, "weights_seq_no": 9.0, "entropy": 1.0936362743377686, "vf_loss": 9.765631675720215, "mean_kl_loss": 0.00277996645309031, "total_loss": 9.665311813354492, "vf_loss_unclipped": 14367.7646484375, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0062500000931322575, "vf_explained_var": 7.158517837524414e-05, "num_trainable_parameters": 294916, "default_optimizer_learning_rate": 0.0003, "num_module_steps_trained_lifetime_throughput": 5113.104961259099}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2158331567533815e-05, "add_observations_from_episodes_to_batch": 0.0014126535089626143, "add_columns_from_episodes_to_train_batch": 0.4428111718492292, "agent_to_module_mapping": 0.02043551321231295, "add_one_ts_to_episodes_and_truncate": 0.037971972298862865, "numpy_to_tensor": 0.00047764361896180226, "batch_individual_items": 0.4794620862305837, "add_time_dim_to_batch_and_zero_pad": 3.956869847296295e-05, "general_advantage_estimation": 0.12190313745961628}}, "connector_pipeline_timer": 1.1056710761039559}, "num_module_steps_trained_lifetime": 1087488, "num_env_steps_trained": 1888000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 16992000, "num_module_steps_trained": 120832, "num_non_trainable_parameters": 0, "num_trainable_parameters": 294916, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime_throughput": 79892.23420269827, "num_module_steps_trained_lifetime_throughput": 5113.109449991852}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 54000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 9, "trial_id": "2fc41_00000", "date": "2026-01-15_15-37-33", "timestamp": 1768487853, "time_this_iter_s": 22.582221746444702, "time_total_s": 204.2470736503601, "pid": 34592, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x00000118D1ED2F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 204.2470736503601, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 21.831249999999997, "ram_util_percent": 45.340624999999996}}
{"timers": {"training_iteration": 22.412748051876992, "restore_env_runners": 3.3292452708598655e-05, "training_step": 22.412199501942005, "env_runner_sampling_timer": 12.04212135761092, "learner_update_timer": 10.358413271332314, "synch_weights": 0.003899888323763313, "synch_env_connectors": 0.004968552533368583}, "env_runners": {"rlmodule_inference_timer": 0.0003434311124308661, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.850000499980524e-05, "numpy_to_tensor": 0.0001062500014086254, "batch_individual_items": 6.470000516856089e-05, "add_time_dim_to_batch_and_zero_pad": 2.305000089108944e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "add_states_from_episodes_to_batch": 1.1000003723893315e-05}}, "num_agent_steps_sampled": {"human_1": 4000.0, "human_0": 4000.0, "human_2": 4000.0}, "agent_episode_returns_mean": {"human_0": -4054.0383433333323, "human_2": -4028.3861733333324, "human_1": -4024.9725883333326}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008606560968888646, "timers": {"connectors": {"un_batch_to_individual_items": 7.592224365829024e-05, "module_to_agent_unmapping": 8.022377049109959e-06, "remove_single_ts_time_rank_from_batch": 3.556962380531962e-06, "listify_data_for_vector_env": 2.8666133677173246e-05, "get_actions": 0.00035099791091345835, "normalize_and_clip_actions": 9.953755605212498e-05, "tensor_to_numpy": 0.00011310142839853514}}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1376011984593392e-05, "agent_to_module_mapping": 1.153204572313574e-05, "add_states_from_episodes_to_batch": 1.0677125672277589e-05, "add_observations_from_episodes_to_batch": 6.76105489148309e-05, "numpy_to_tensor": 8.074306682823024e-05, "batch_individual_items": 5.3383106139530074e-05}}, "connector_pipeline_timer": 0.0003867157095750283}, "agent_steps": {"human_2": 2000.0, "human_1": 2000.0, "human_0": 2000.0}, "episode_len_max": 2000, "time_between_sampling": 0.659488074742674, "connector_pipeline_timer": 0.000801100002718158, "env_reset_timer": 2.77403124999546, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled_lifetime": {"human_0": 58000.0, "human_2": 58000.0, "human_1": 58000.0}, "sample": 2.1677250883368226, "episode_len_mean": 2000.0, "episode_len_min": 2000, "num_episodes": 2.0, "num_episodes_lifetime": 19.999999999999986, "module_episode_returns_mean": {"shared_policy": -11097.331788333333}, "episode_return_mean": -12107.397104999996, "env_step_timer": 0.0025430846385150196, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_return_min": -14527.672, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 131.6904176324108, "num_module_steps_sampled_lifetime": {"shared_policy": 174000.0}, "num_env_steps_sampled_lifetime": 58000.0, "episode_duration_sec_mean": 8.877645203990252, "episode_return_max": -10775.5415, "num_module_steps_sampled": {"shared_policy": 12000.0}, "num_env_steps_sampled_lifetime_throughput": 177.36663092892792}, "learners": {"shared_policy": {"policy_loss": 0.06645479053258896, "num_module_steps_trained": 120832, "num_module_steps_trained_lifetime": 1208320, "weights_seq_no": 10.0, "entropy": 1.0913041830062866, "vf_loss": 9.963461875915527, "mean_kl_loss": 0.0031860487069934607, "total_loss": 10.019023895263672, "vf_loss_unclipped": 19685.099609375, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0031250000465661287, "vf_explained_var": 8.690357208251953e-05, "num_trainable_parameters": 294916, "default_optimizer_learning_rate": 0.0003, "num_module_steps_trained_lifetime_throughput": 5119.28258403016}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2192748130047071e-05, "add_observations_from_episodes_to_batch": 0.0014111089737814224, "add_columns_from_episodes_to_train_batch": 0.44290413013063756, "agent_to_module_mapping": 0.020473649080288932, "add_one_ts_to_episodes_and_truncate": 0.037881525575963686, "numpy_to_tensor": 0.00047532818273948176, "batch_individual_items": 0.4814254903682952, "add_time_dim_to_batch_and_zero_pad": 3.981501142908689e-05, "general_advantage_estimation": 0.12190304708499018}}, "connector_pipeline_timer": 1.1076652913429126}, "num_module_steps_trained_lifetime": 1208320, "num_env_steps_trained": 1888000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 18880000, "num_module_steps_trained": 120832, "num_non_trainable_parameters": 0, "num_trainable_parameters": 294916, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime_throughput": 79988.75976956946, "num_module_steps_trained_lifetime_throughput": 5119.285581962487}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 58000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": true, "training_iteration": 10, "trial_id": "2fc41_00000", "date": "2026-01-15_15-37-56", "timestamp": 1768487876, "time_this_iter_s": 23.0363187789917, "time_total_s": 227.2833924293518, "pid": 34592, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x00000118D1ED17E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 227.2833924293518, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 23.45, "ram_util_percent": 45.35625}}
