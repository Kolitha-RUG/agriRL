{"timers": {"training_iteration": 21.32112639999832, "restore_env_runners": 2.8700000257231295e-05, "training_step": 21.320685599988792, "env_runner_sampling_timer": 14.553302900007111, "learner_update_timer": 6.7571602999960305, "synch_weights": 0.004273600003216416}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.3050003265962e-05, "agent_to_module_mapping": 1.4650002412963659e-05, "add_time_dim_to_batch_and_zero_pad": 3.565000224625692e-05, "batch_individual_items": 7.714999810559675e-05, "numpy_to_tensor": 0.05599349999829428, "add_states_from_episodes_to_batch": 1.8449994968250394e-05}}, "env_to_module_sum_episodes_length_in": 129.70023112683015, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.474703842939864e-05, "listify_data_for_vector_env": 2.5238379692037127e-05, "module_to_agent_unmapping": 8.739385824960368e-06, "un_batch_to_individual_items": 6.780242527569529e-05, "get_actions": 0.005354535331078533, "tensor_to_numpy": 0.000599568406476156, "remove_single_ts_time_rank_from_batch": 3.950037546131277e-06}}, "connector_pipeline_timer": 0.006373860431968257}, "weights_seq_no": 0.0, "num_agent_steps_sampled": {"human_0": 4000.0, "human_1": 4000.0}, "episode_len_mean": 2000.0, "num_agent_steps_sampled_lifetime": {"human_0": 22000.0, "human_1": 22000.0}, "env_to_module_sum_episodes_length_out": 129.70023112683015, "episode_return_min": -7110.383500000008, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.133675830860156e-05, "numpy_to_tensor": 0.0002744988982779327, "add_states_from_episodes_to_batch": 1.1113013437214713e-05, "add_observations_from_episodes_to_batch": 6.065487576512236e-05, "agent_to_module_mapping": 1.1403766460143941e-05, "add_time_dim_to_batch_and_zero_pad": 2.2807566630049935e-05}}, "connector_pipeline_timer": 0.0005808583318691438}, "agent_steps": {"human_0": 2000.0, "human_1": 2000.0}, "num_env_steps_sampled_lifetime": 22000.0, "episode_duration_sec_mean": 11.347120899998117, "num_episodes": 2.0, "agent_episode_returns_mean": {"human_1": -3423.8642500000033, "human_0": -3424.3237500000037}, "time_between_sampling": 0.02397477078735978, "connector_pipeline_timer": 0.05687870000110706, "episode_return_mean": -6848.188000000007, "num_episodes_lifetime": 2.0, "env_reset_timer": 2.718273999991652, "env_step_timer": 0.0014758490336199675, "sample": 4.174244948807887, "num_module_steps_sampled_lifetime": {"shared_policy": 44000.0}, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 8000.0}, "episode_return_max": -6585.992500000006, "rlmodule_inference_timer": 0.002846975467424935, "module_episode_returns_mean": {"shared_policy": -6457.394250000005}, "episode_len_max": 2000, "num_env_steps_sampled": 4000.0, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.013653400004841387, "batch_individual_items": 0.38554600000497885, "add_one_ts_to_episodes_and_truncate": 0.024081200012005866, "add_states_from_episodes_to_batch": 1.170000177808106e-05, "general_advantage_estimation": 0.07925199999590404, "add_columns_from_episodes_to_train_batch": 0.29551830000127666, "add_time_dim_to_batch_and_zero_pad": 3.270000161137432e-05, "numpy_to_tensor": 0.0003403000009711832, "add_observations_from_episodes_to_batch": 0.0007530000002589077}}, "connector_pipeline_timer": 0.8001918999943882}, "num_module_steps_trained": 80640, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 4000, "num_env_steps_trained_lifetime": 1260000, "num_env_steps_trained": 1260000, "num_module_steps_trained_lifetime": 80640, "learner_connector_sum_episodes_length_in": 4000, "num_trainable_parameters": 293380, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "shared_policy": {"weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.01, "num_module_steps_trained": 80640, "total_loss": 9.872834205627441, "module_train_batch_size_mean": 256.0, "vf_loss_unclipped": 11353.6376953125, "entropy": 1.0908215045928955, "vf_loss": 9.793481826782227, "vf_explained_var": 2.676248550415039e-05, "curr_kl_coeff": 0.10000000149011612, "num_module_steps_trained_lifetime": 80640, "num_trainable_parameters": 293380, "default_optimizer_learning_rate": 0.0003, "mean_kl_loss": 0.001713827601633966, "policy_loss": 0.08991701900959015, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 22000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 1, "trial_id": "845c7_00000", "date": "2026-01-15_17-24-15", "timestamp": 1768494255, "time_this_iter_s": 21.32953691482544, "time_total_s": 21.32953691482544, "pid": 15888, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 2, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0.5, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x0000021E0B654820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (313,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.32953691482544, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 20.336666666666666, "ram_util_percent": 42.61666666666668}}
{"timers": {"training_iteration": 21.334266093998448, "restore_env_runners": 2.8691000188700855e-05, "training_step": 21.333820919988938, "env_runner_sampling_timer": 14.554106093006993, "learner_update_timer": 6.769446553996095, "synch_weights": 0.004290377003198956, "synch_env_connectors": 0.003001300006872043}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.3050003265962e-05, "agent_to_module_mapping": 1.4650002412963659e-05, "add_time_dim_to_batch_and_zero_pad": 3.565000224625692e-05, "batch_individual_items": 7.714999810559675e-05, "numpy_to_tensor": 0.05599349999829428, "add_states_from_episodes_to_batch": 1.8449994968250394e-05}}, "env_to_module_sum_episodes_length_in": 131.69041762873871, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.124334279894997e-05, "listify_data_for_vector_env": 2.543443776886006e-05, "module_to_agent_unmapping": 9.437126693506124e-06, "un_batch_to_individual_items": 6.963995014750523e-05, "get_actions": 0.0010922248281130423, "tensor_to_numpy": 0.0007662953140808775, "remove_single_ts_time_rank_from_batch": 4.149473523530636e-06}}, "connector_pipeline_timer": 0.002284919058013364}, "weights_seq_no": 1.0, "num_agent_steps_sampled": {"human_0": 4000.0, "human_1": 4000.0}, "episode_len_mean": 2000.0, "num_agent_steps_sampled_lifetime": {"human_0": 26000.0, "human_1": 26000.0}, "env_to_module_sum_episodes_length_out": 131.69041762873871, "episode_return_min": -7110.383500000008, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.3758226643788965e-05, "numpy_to_tensor": 0.00028315015179111453, "add_states_from_episodes_to_batch": 1.2076491644021558e-05, "add_observations_from_episodes_to_batch": 6.242875595966187e-05, "agent_to_module_mapping": 1.1825191609680147e-05, "add_time_dim_to_batch_and_zero_pad": 2.282429163306003e-05}}, "connector_pipeline_timer": 0.0006012354645519517}, "agent_steps": {"human_0": 2000.0, "human_1": 2000.0}, "num_env_steps_sampled_lifetime": 26000.0, "episode_duration_sec_mean": 11.35899961818094, "num_episodes": 2.0, "agent_episode_returns_mean": {"human_1": -3385.709590909095, "human_0": -3385.110750000004}, "time_between_sampling": 0.09029043475047932, "connector_pipeline_timer": 0.05687870000110706, "episode_return_mean": -6770.820340909098, "num_episodes_lifetime": 4.000000000000002, "env_reset_timer": 2.718273999991652, "env_step_timer": 0.0019270642564651007, "sample": 3.9081888378425838, "num_module_steps_sampled_lifetime": {"shared_policy": 52000.0}, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 8000.0}, "episode_return_max": -5552.029000000004, "rlmodule_inference_timer": 0.0005666832466721311, "module_episode_returns_mean": {"shared_policy": -6382.198250000005}, "episode_len_max": 2000, "num_env_steps_sampled": 4000.0, "num_env_steps_sampled_lifetime_throughput": 186.4724059299004}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.01372132900491124, "batch_individual_items": 0.3863913080049679, "add_one_ts_to_episodes_and_truncate": 0.02405051801193622, "add_states_from_episodes_to_batch": 1.1745001684175804e-05, "general_advantage_estimation": 0.07943510699595209, "add_columns_from_episodes_to_train_batch": 0.2965006560011534, "add_time_dim_to_batch_and_zero_pad": 3.301400152849965e-05, "numpy_to_tensor": 0.00034700000091106634, "add_observations_from_episodes_to_batch": 0.0007538330001989378}}, "connector_pipeline_timer": 0.8022450999944704}, "num_module_steps_trained": 80640, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 2520000, "num_env_steps_trained": 1260000, "num_module_steps_trained_lifetime": 161280, "learner_connector_sum_episodes_length_in": 4000.0, "num_trainable_parameters": 293380, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "shared_policy": {"weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.01, "num_module_steps_trained": 80640, "total_loss": 9.641064643859863, "module_train_batch_size_mean": 256.0, "vf_loss_unclipped": 9368.25, "entropy": 1.0691568851470947, "vf_loss": 9.681145668029785, "vf_explained_var": 0.004033327102661133, "curr_kl_coeff": 0.10000000149011612, "num_module_steps_trained_lifetime": 161280, "num_trainable_parameters": 293380, "default_optimizer_learning_rate": 0.0003, "mean_kl_loss": 0.008938739076256752, "policy_loss": -0.030282679945230484, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 26000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 2, "trial_id": "845c7_00000", "date": "2026-01-15_17-24-38", "timestamp": 1768494278, "time_this_iter_s": 22.646766424179077, "time_total_s": 43.97630333900452, "pid": 15888, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 2, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0.5, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x0000021E0B655E10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (313,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43.97630333900452, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.009375, "ram_util_percent": 42.96875}}
{"timers": {"training_iteration": 21.363066023058465, "restore_env_runners": 2.8681090258760378e-05, "training_step": 21.362618327788923, "env_runner_sampling_timer": 14.582321090076922, "learner_update_timer": 6.770032407456175, "synch_weights": 0.004285677233178285, "synch_env_connectors": 0.003017542006855365}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.3050003265962e-05, "agent_to_module_mapping": 1.4650002412963659e-05, "add_time_dim_to_batch_and_zero_pad": 3.565000224625692e-05, "batch_individual_items": 7.714999810559675e-05, "numpy_to_tensor": 0.05599349999829428, "add_states_from_episodes_to_batch": 1.8449994968250394e-05}}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010369801046398788, "listify_data_for_vector_env": 3.0358119303816514e-05, "module_to_agent_unmapping": 1.028217101867509e-05, "un_batch_to_individual_items": 7.97339061274535e-05, "get_actions": 0.001149801804777671, "tensor_to_numpy": 0.0010045481790135241, "remove_single_ts_time_rank_from_batch": 4.747130412077193e-06}}, "connector_pipeline_timer": 0.0026317679924395356}, "weights_seq_no": 2.0, "num_agent_steps_sampled": {"human_0": 4000.0, "human_1": 4000.0}, "episode_len_mean": 2000.0, "num_agent_steps_sampled_lifetime": {"human_0": 30000.0, "human_1": 30000.0}, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_return_min": -7110.383500000008, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.051618138221994e-05, "numpy_to_tensor": 0.00030414023290186663, "add_states_from_episodes_to_batch": 1.3466539868375136e-05, "add_observations_from_episodes_to_batch": 7.08958412429388e-05, "agent_to_module_mapping": 1.3904141352128022e-05, "add_time_dim_to_batch_and_zero_pad": 2.6119418173940095e-05}}, "connector_pipeline_timer": 0.0006686046906349463}, "agent_steps": {"human_0": 2000.0, "human_1": 2000.0}, "num_env_steps_sampled_lifetime": 30000.0, "episode_duration_sec_mean": 11.50455185952818, "num_episodes": 2.0, "agent_episode_returns_mean": {"human_1": -3182.0226547619072, "human_0": -3178.260714285717}, "time_between_sampling": 0.1616491586070119, "connector_pipeline_timer": 0.05687870000110706, "episode_return_mean": -6360.2833690476255, "num_episodes_lifetime": 6.0000000000000036, "env_reset_timer": 2.718273999991652, "env_step_timer": 0.002403181646545352, "sample": 3.692413716303485, "num_module_steps_sampled_lifetime": {"shared_policy": 60000.0}, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 8000.0}, "episode_return_max": -4949.025500000005, "rlmodule_inference_timer": 0.000600036754119522, "module_episode_returns_mean": {"shared_policy": -5986.91715476191}, "episode_len_max": 2000, "num_env_steps_sampled": 4000.0, "num_env_steps_sampled_lifetime_throughput": 185.01153845235933}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.01372957871479739, "batch_individual_items": 0.3845298249249114, "add_one_ts_to_episodes_and_truncate": 0.023994073831853164, "add_states_from_episodes_to_batch": 1.1752551600511652e-05, "general_advantage_estimation": 0.07936228992588731, "add_columns_from_episodes_to_train_batch": 0.2964962204411451, "add_time_dim_to_batch_and_zero_pad": 3.3006861498870426e-05, "numpy_to_tensor": 0.00034620200087520067, "add_observations_from_episodes_to_batch": 0.0007542986701708286}}, "connector_pipeline_timer": 0.8002524909945147}, "num_module_steps_trained": 80640, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 3780000, "num_env_steps_trained": 1260000, "num_module_steps_trained_lifetime": 241920, "learner_connector_sum_episodes_length_in": 4000.0, "num_trainable_parameters": 293380, "num_env_steps_trained_lifetime_throughput": 51904.36753749196, "num_module_steps_trained_lifetime_throughput": 3321.9055087690317}, "shared_policy": {"weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.01, "num_module_steps_trained": 80640, "total_loss": 9.90685749053955, "module_train_batch_size_mean": 256.0, "vf_loss_unclipped": 7785.58837890625, "entropy": 1.0826654434204102, "vf_loss": 9.754600524902344, "vf_explained_var": 0.009478926658630371, "curr_kl_coeff": 0.05000000074505806, "num_module_steps_trained_lifetime": 241920, "num_trainable_parameters": 293380, "default_optimizer_learning_rate": 0.0003, "mean_kl_loss": 0.004442150238901377, "policy_loss": 0.16264063119888306, "num_module_steps_trained_lifetime_throughput": 3321.899241350687}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 3, "trial_id": "845c7_00000", "date": "2026-01-15_17-25-02", "timestamp": 1768494302, "time_this_iter_s": 24.22386384010315, "time_total_s": 68.20016717910767, "pid": 15888, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 2, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0.5, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x0000021E0B6541F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (313,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.20016717910767, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.75588235294118, "ram_util_percent": 43.04705882352941}}
{"timers": {"training_iteration": 21.392554191827895, "restore_env_runners": 2.868927927414188e-05, "training_step": 21.392103826510905, "env_runner_sampling_timer": 14.608837320176084, "learner_update_timer": 6.772987487381603, "synch_weights": 0.004281963460877392, "synch_env_connectors": 0.0030224125867622208}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.3050003265962e-05, "agent_to_module_mapping": 1.4650002412963659e-05, "add_time_dim_to_batch_and_zero_pad": 3.565000224625692e-05, "batch_individual_items": 7.714999810559675e-05, "numpy_to_tensor": 0.05599349999829428, "add_states_from_episodes_to_batch": 1.8449994968250394e-05}}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010125128750654422, "listify_data_for_vector_env": 3.013181183268795e-05, "module_to_agent_unmapping": 9.980055774703423e-06, "un_batch_to_individual_items": 7.793628642792101e-05, "get_actions": 0.0011276675089726595, "tensor_to_numpy": 0.0010615260994260368, "remove_single_ts_time_rank_from_batch": 4.672153693282221e-06}}, "connector_pipeline_timer": 0.002658543053664638}, "weights_seq_no": 3.0, "num_agent_steps_sampled": {"human_0": 4000.0, "human_1": 4000.0}, "episode_len_mean": 2000.0, "num_agent_steps_sampled_lifetime": {"human_0": 34000.0, "human_1": 34000.0}, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_return_min": -7110.383500000008, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.911338296807713e-05, "numpy_to_tensor": 0.00030573001401078547, "add_states_from_episodes_to_batch": 1.3256412569544984e-05, "add_observations_from_episodes_to_batch": 6.874171412981401e-05, "agent_to_module_mapping": 1.2852166037527875e-05, "add_time_dim_to_batch_and_zero_pad": 2.6069743840447994e-05}}, "connector_pipeline_timer": 0.000660122281312401}, "agent_steps": {"human_0": 2000.0, "human_1": 2000.0}, "num_env_steps_sampled_lifetime": 34000.0, "episode_duration_sec_mean": 12.274125530011371, "num_episodes": 2.0, "agent_episode_returns_mean": {"human_1": -2892.355775000002, "human_0": -2898.8156500000027}, "time_between_sampling": 0.21534381680085432, "connector_pipeline_timer": 0.05687870000110706, "episode_return_mean": -5791.171425000005, "num_episodes_lifetime": 8.000000000000004, "env_reset_timer": 2.718273999991652, "env_step_timer": 0.002333581469446417, "sample": 3.4990924650306794, "num_module_steps_sampled_lifetime": {"shared_policy": 68000.0}, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 8000.0}, "episode_return_max": -4949.025500000005, "rlmodule_inference_timer": 0.0005900903656932905, "module_episode_returns_mean": {"shared_policy": -5462.822560000005}, "episode_len_max": 2000, "num_env_steps_sampled": 4000.0, "num_env_steps_sampled_lifetime_throughput": 184.05087488750647}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.013745193927690474, "batch_individual_items": 0.38247233467574326, "add_one_ts_to_episodes_and_truncate": 0.023969488093498525, "add_states_from_episodes_to_batch": 1.1746026056600387e-05, "general_advantage_estimation": 0.07932044102657416, "add_columns_from_episodes_to_train_batch": 0.29654900523670985, "add_time_dim_to_batch_and_zero_pad": 3.30207928839227e-05, "numpy_to_tensor": 0.00034513398076013263, "add_observations_from_episodes_to_batch": 0.000754148683592677}}, "connector_pipeline_timer": 0.79819047908452}, "num_module_steps_trained": 80640, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 5040000, "num_env_steps_trained": 1260000, "num_module_steps_trained_lifetime": 322560, "learner_connector_sum_episodes_length_in": 4000.0, "num_trainable_parameters": 293380, "num_env_steps_trained_lifetime_throughput": 51895.03239715396, "num_module_steps_trained_lifetime_throughput": 3321.306503696427}, "shared_policy": {"weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.01, "num_module_steps_trained": 80640, "total_loss": 9.462126731872559, "module_train_batch_size_mean": 256.0, "vf_loss_unclipped": 8356.5576171875, "entropy": 1.059604525566101, "vf_loss": 9.523367881774902, "vf_explained_var": 0.003304600715637207, "curr_kl_coeff": 0.05000000074505806, "num_module_steps_trained_lifetime": 322560, "num_trainable_parameters": 293380, "default_optimizer_learning_rate": 0.0003, "mean_kl_loss": 0.006516740191727877, "policy_loss": -0.05097280442714691, "num_module_steps_trained_lifetime_throughput": 3321.300697734524}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 34000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 4, "trial_id": "845c7_00000", "date": "2026-01-15_17-25-27", "timestamp": 1768494327, "time_this_iter_s": 24.32008695602417, "time_total_s": 92.52025413513184, "pid": 15888, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 2, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0.5, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x0000021E0B6571C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (313,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.52025413513184, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.388571428571428, "ram_util_percent": 42.99714285714286}}
{"timers": {"training_iteration": 21.42062701590966, "restore_env_runners": 2.868238643067132e-05, "training_step": 21.4201728872459, "env_runner_sampling_timer": 14.637272860974342, "learner_update_timer": 6.772595377507762, "synch_weights": 0.004280796826203359, "synch_env_connectors": 0.0030273414608116434}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.3050003265962e-05, "agent_to_module_mapping": 1.4650002412963659e-05, "add_time_dim_to_batch_and_zero_pad": 3.565000224625692e-05, "batch_individual_items": 7.714999810559675e-05, "numpy_to_tensor": 0.05599349999829428, "add_states_from_episodes_to_batch": 1.8449994968250394e-05}}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010425027672788041, "listify_data_for_vector_env": 3.076324065289762e-05, "module_to_agent_unmapping": 1.0542936312387208e-05, "un_batch_to_individual_items": 7.965609675821919e-05, "get_actions": 0.0011131642250337473, "tensor_to_numpy": 0.0010362649244059978, "remove_single_ts_time_rank_from_batch": 4.963563268225467e-06}}, "connector_pipeline_timer": 0.0026300431183595143}, "weights_seq_no": 4.0, "num_agent_steps_sampled": {"human_0": 4000.0, "human_1": 4000.0}, "episode_len_mean": 2000.0, "num_agent_steps_sampled_lifetime": {"human_0": 38000.0, "human_1": 38000.0}, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_return_min": -6442.258500000005, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.938549697208363e-05, "numpy_to_tensor": 0.00030532448387756594, "add_states_from_episodes_to_batch": 1.3330620910494243e-05, "add_observations_from_episodes_to_batch": 7.129265420805417e-05, "agent_to_module_mapping": 1.3308980637344496e-05, "add_time_dim_to_batch_and_zero_pad": 2.5921072180742633e-05}}, "connector_pipeline_timer": 0.000664387567611751}, "agent_steps": {"human_0": 2000.0, "human_1": 2000.0}, "num_env_steps_sampled_lifetime": 38000.0, "episode_duration_sec_mean": 12.985038439015916, "num_episodes": 2.0, "agent_episode_returns_mean": {"human_1": -2765.9907350000017, "human_0": -2767.6951950000016}, "time_between_sampling": 0.2679015139390991, "connector_pipeline_timer": 0.05687870000110706, "episode_return_mean": -5533.685930000006, "num_episodes_lifetime": 9.999999999999991, "env_reset_timer": 2.718273999991652, "env_step_timer": 0.002391512398679313, "sample": 3.3265601254841655, "num_module_steps_sampled_lifetime": {"shared_policy": 76000.0}, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 8000.0}, "episode_return_max": -3612.617000000002, "rlmodule_inference_timer": 0.0005857251538690364, "module_episode_returns_mean": {"shared_policy": -5226.432780000004}, "episode_len_max": 2000, "num_env_steps_sampled": 4000.0, "num_env_steps_sampled_lifetime_throughput": 182.98350287884463}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.013761297988418325, "batch_individual_items": 0.38043111732890555, "add_one_ts_to_episodes_and_truncate": 0.023964170212578767, "add_states_from_episodes_to_batch": 1.1758565767284455e-05, "general_advantage_estimation": 0.07921811861621644, "add_columns_from_episodes_to_train_batch": 0.2965989021843931, "add_time_dim_to_batch_and_zero_pad": 3.3239584915384924e-05, "numpy_to_tensor": 0.0003441716409875155, "add_observations_from_episodes_to_batch": 0.0007559481968703865}}, "connector_pipeline_timer": 0.7961047292936114}, "num_module_steps_trained": 80640, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 6300000, "num_env_steps_trained": 1260000, "num_module_steps_trained_lifetime": 403200, "learner_connector_sum_episodes_length_in": 4000.0, "num_trainable_parameters": 293380, "num_env_steps_trained_lifetime_throughput": 51897.91764930747, "num_module_steps_trained_lifetime_throughput": 3321.490380457718}, "shared_policy": {"weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.01, "num_module_steps_trained": 80640, "total_loss": 9.642879486083984, "module_train_batch_size_mean": 256.0, "vf_loss_unclipped": 4702.3916015625, "entropy": 1.0231186151504517, "vf_loss": 9.606563568115234, "vf_explained_var": 0.002533257007598877, "curr_kl_coeff": 0.05000000074505806, "num_module_steps_trained_lifetime": 403200, "num_trainable_parameters": 293380, "default_optimizer_learning_rate": 0.0003, "mean_kl_loss": 0.006807439494878054, "policy_loss": 0.04620571434497833, "num_module_steps_trained_lifetime_throughput": 3321.4847085032466}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 38000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 5, "trial_id": "845c7_00000", "date": "2026-01-15_17-25-51", "timestamp": 1768494351, "time_this_iter_s": 24.211058616638184, "time_total_s": 116.73131275177002, "pid": 15888, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 2, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0.5, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x0000021E0B7B53F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (313,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.73131275177002, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.294117647058822, "ram_util_percent": 42.98823529411765}}
{"timers": {"training_iteration": 21.447763568750577, "restore_env_runners": 2.8607562579926528e-05, "training_step": 21.44730857137344, "env_runner_sampling_timer": 14.662479139364564, "learner_update_timer": 6.774519411732704, "synch_weights": 0.004278075858029859, "synch_env_connectors": 0.0030451590462659407}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.3050003265962e-05, "agent_to_module_mapping": 1.4650002412963659e-05, "add_time_dim_to_batch_and_zero_pad": 3.565000224625692e-05, "batch_individual_items": 7.714999810559675e-05, "numpy_to_tensor": 0.05599349999829428, "add_states_from_episodes_to_batch": 1.8449994968250394e-05}}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010282347558671964, "listify_data_for_vector_env": 3.1240886268181076e-05, "module_to_agent_unmapping": 1.0217424190329823e-05, "un_batch_to_individual_items": 7.783964838469133e-05, "get_actions": 0.0010464968002021784, "tensor_to_numpy": 0.0010685773269505311, "remove_single_ts_time_rank_from_batch": 4.971413935510172e-06}}, "connector_pipeline_timer": 0.0025869410011353415}, "weights_seq_no": 5.0, "num_agent_steps_sampled": {"human_0": 4000.0, "human_1": 4000.0}, "episode_len_mean": 2000.0, "num_agent_steps_sampled_lifetime": {"human_0": 42000.0, "human_1": 42000.0}, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_return_min": -6164.480500000005, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.8303573419982e-05, "numpy_to_tensor": 0.00030016556867268893, "add_states_from_episodes_to_batch": 1.3925936132015252e-05, "add_observations_from_episodes_to_batch": 6.941565404494346e-05, "agent_to_module_mapping": 1.3151993318671043e-05, "add_time_dim_to_batch_and_zero_pad": 2.4880766991366414e-05}}, "connector_pipeline_timer": 0.0006584434613488511}, "agent_steps": {"human_0": 2000.0, "human_1": 2000.0}, "num_env_steps_sampled_lifetime": 42000.0, "episode_duration_sec_mean": 13.306065707007656, "num_episodes": 2.0, "agent_episode_returns_mean": {"human_1": -2468.527020000002, "human_0": -2463.6138050000022}, "time_between_sampling": 0.3108284217626166, "connector_pipeline_timer": 0.05687870000110706, "episode_return_mean": -4932.140825000004, "num_episodes_lifetime": 11.999999999999991, "env_reset_timer": 2.718273999991652, "env_step_timer": 0.0024313360645060716, "sample": 3.170897484155862, "num_module_steps_sampled_lifetime": {"shared_policy": 84000.0}, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 8000.0}, "episode_return_max": -2953.010500000002, "rlmodule_inference_timer": 0.0005611781353152881, "module_episode_returns_mean": {"shared_policy": -4652.307755000003}, "episode_len_max": 2000, "num_env_steps_sampled": 4000.0, "num_env_steps_sampled_lifetime_throughput": 182.1831482346223}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.013807484008612722, "batch_individual_items": 0.38057204015560087, "add_one_ts_to_episodes_and_truncate": 0.023897142510492155, "add_states_from_episodes_to_batch": 1.1749980066476475e-05, "general_advantage_estimation": 0.07911326543011246, "add_columns_from_episodes_to_train_batch": 0.29661960116249547, "add_time_dim_to_batch_and_zero_pad": 3.3313189101813185e-05, "numpy_to_tensor": 0.00034313492455508374, "add_observations_from_episodes_to_batch": 0.0007557897149406362}}, "connector_pipeline_timer": 0.796134378000727}, "num_module_steps_trained": 80640, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 7560000, "num_env_steps_trained": 1260000, "num_module_steps_trained_lifetime": 483840, "learner_connector_sum_episodes_length_in": 4000.0, "num_trainable_parameters": 293380, "num_env_steps_trained_lifetime_throughput": 51907.72184145912, "num_module_steps_trained_lifetime_throughput": 3322.116616586762}, "shared_policy": {"weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.01, "num_module_steps_trained": 80640, "total_loss": 9.29829216003418, "module_train_batch_size_mean": 256.0, "vf_loss_unclipped": 2508.01220703125, "entropy": 1.048516035079956, "vf_loss": 9.29407024383545, "vf_explained_var": 0.07426977157592773, "curr_kl_coeff": 0.05000000074505806, "num_module_steps_trained_lifetime": 483840, "num_trainable_parameters": 293380, "default_optimizer_learning_rate": 0.0003, "mean_kl_loss": 0.007610108703374863, "policy_loss": 0.014326121658086777, "num_module_steps_trained_lifetime_throughput": 3322.1112647584855}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 42000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 6, "trial_id": "845c7_00000", "date": "2026-01-15_17-26-15", "timestamp": 1768494375, "time_this_iter_s": 24.143004655838013, "time_total_s": 140.87431740760803, "pid": 15888, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 2, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0.5, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x0000021E0B7B5BD0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (313,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 140.87431740760803, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 21.802941176470586, "ram_util_percent": 42.90882352941177}}
{"timers": {"training_iteration": 21.480346176063087, "restore_env_runners": 2.883848696180322e-05, "training_step": 21.47988887365962, "env_runner_sampling_timer": 14.686700548970869, "learner_update_timer": 6.782868185615436, "synch_weights": 0.004272109099499632, "synch_env_connectors": 0.0030492754559224605}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.3050003265962e-05, "agent_to_module_mapping": 1.4650002412963659e-05, "add_time_dim_to_batch_and_zero_pad": 3.565000224625692e-05, "batch_individual_items": 7.714999810559675e-05, "numpy_to_tensor": 0.05599349999829428, "add_states_from_episodes_to_batch": 1.8449994968250394e-05}}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010246995578843924, "listify_data_for_vector_env": 3.104042281995583e-05, "module_to_agent_unmapping": 1.0193614252133192e-05, "un_batch_to_individual_items": 7.905425694774041e-05, "get_actions": 0.0010326944444762215, "tensor_to_numpy": 0.0010666181828980345, "remove_single_ts_time_rank_from_batch": 4.880510222574089e-06}}, "connector_pipeline_timer": 0.002569349604662179}, "weights_seq_no": 6.0, "num_agent_steps_sampled": {"human_0": 4000.0, "human_1": 4000.0}, "episode_len_mean": 2000.0, "num_agent_steps_sampled_lifetime": {"human_0": 46000.0, "human_1": 46000.0}, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_return_min": -6164.480500000005, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.7711209901932285e-05, "numpy_to_tensor": 0.0002882411228598808, "add_states_from_episodes_to_batch": 1.3619956731126783e-05, "add_observations_from_episodes_to_batch": 6.87673372278218e-05, "agent_to_module_mapping": 1.2939750822501044e-05, "add_time_dim_to_batch_and_zero_pad": 2.418492355875083e-05}}, "connector_pipeline_timer": 0.0006416712117526251}, "agent_steps": {"human_0": 2000.0, "human_1": 2000.0}, "num_env_steps_sampled_lifetime": 46000.0, "episode_duration_sec_mean": 13.262075466007957, "num_episodes": 2.0, "agent_episode_returns_mean": {"human_1": -2016.1387650000013, "human_0": -2009.2564550000013}, "time_between_sampling": 0.35056601784643643, "connector_pipeline_timer": 0.05687870000110706, "episode_return_mean": -4025.3952200000035, "num_episodes_lifetime": 13.999999999999984, "env_reset_timer": 2.718273999991652, "env_step_timer": 0.0024358358159931653, "sample": 3.029570396360437, "num_module_steps_sampled_lifetime": {"shared_policy": 92000.0}, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 8000.0}, "episode_return_max": -2953.010500000002, "rlmodule_inference_timer": 0.0005512484148884944, "module_episode_returns_mean": {"shared_policy": -3774.6546800000024}, "episode_len_max": 2000, "num_env_steps_sampled": 4000.0, "num_env_steps_sampled_lifetime_throughput": 181.37060389985163}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.013808618168571096, "batch_individual_items": 0.3806112357539885, "add_one_ts_to_episodes_and_truncate": 0.02384802908532694, "add_states_from_episodes_to_batch": 1.1748480275978027e-05, "general_advantage_estimation": 0.07917926977579584, "add_columns_from_episodes_to_train_batch": 0.2965537471509368, "add_time_dim_to_batch_and_zero_pad": 3.332005718037806e-05, "numpy_to_tensor": 0.00034243657531070446, "add_observations_from_episodes_to_batch": 0.0007561908178590152}}, "connector_pipeline_timer": 0.7961204422207561}, "num_module_steps_trained": 80640, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 8820000, "num_env_steps_trained": 1260000, "num_module_steps_trained_lifetime": 564480, "learner_connector_sum_episodes_length_in": 4000.0, "num_trainable_parameters": 293380, "num_env_steps_trained_lifetime_throughput": 51857.48852712978, "num_module_steps_trained_lifetime_throughput": 3318.9005385267415}, "shared_policy": {"weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.01, "num_module_steps_trained": 80640, "total_loss": 9.512386322021484, "module_train_batch_size_mean": 256.0, "vf_loss_unclipped": 5013.05859375, "entropy": 1.0228946208953857, "vf_loss": 9.477776527404785, "vf_explained_var": 0.0427510142326355, "curr_kl_coeff": 0.05000000074505806, "num_module_steps_trained_lifetime": 564480, "num_trainable_parameters": 293380, "default_optimizer_learning_rate": 0.0003, "mean_kl_loss": 0.00807946640998125, "policy_loss": 0.04443487524986267, "num_module_steps_trained_lifetime_throughput": 3318.8953937480924}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 46000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 7, "trial_id": "845c7_00000", "date": "2026-01-15_17-26-40", "timestamp": 1768494400, "time_this_iter_s": 24.714490175247192, "time_total_s": 165.58880758285522, "pid": 15888, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 2, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0.5, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x0000021E0B56DD80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (313,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 165.58880758285522, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.34705882352941, "ram_util_percent": 42.9029411764706}}
{"timers": {"training_iteration": 21.484277512302388, "restore_env_runners": 2.8772102181892042e-05, "training_step": 21.483819332923076, "env_runner_sampling_timer": 14.689775672481135, "learner_update_timer": 6.783719787759283, "synch_weights": 0.004266129008435407, "synch_env_connectors": 0.003054377701444466}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.3050003265962e-05, "agent_to_module_mapping": 1.4650002412963659e-05, "add_time_dim_to_batch_and_zero_pad": 3.565000224625692e-05, "batch_individual_items": 7.714999810559675e-05, "numpy_to_tensor": 0.05599349999829428, "add_states_from_episodes_to_batch": 1.8449994968250394e-05}}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.136031719716225e-05, "listify_data_for_vector_env": 2.5979698593369445e-05, "module_to_agent_unmapping": 9.364720931148269e-06, "un_batch_to_individual_items": 7.092918652182058e-05, "get_actions": 0.0010766445534898766, "tensor_to_numpy": 0.000971061891143088, "remove_single_ts_time_rank_from_batch": 4.156369291826553e-06}}, "connector_pipeline_timer": 0.002475026795753571}, "weights_seq_no": 7.0, "num_agent_steps_sampled": {"human_0": 4000.0, "human_1": 4000.0}, "episode_len_mean": 2000.0, "num_agent_steps_sampled_lifetime": {"human_0": 50000.0, "human_1": 50000.0}, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_return_min": -4692.524000000004, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.2760125994395746e-05, "numpy_to_tensor": 0.00027971632412151484, "add_states_from_episodes_to_batch": 1.1159515446642172e-05, "add_observations_from_episodes_to_batch": 6.052991580893036e-05, "agent_to_module_mapping": 1.1765752106399748e-05, "add_time_dim_to_batch_and_zero_pad": 2.2069845801119384e-05}}, "connector_pipeline_timer": 0.0005869361219491328}, "agent_steps": {"human_0": 2000.0, "human_1": 2000.0}, "num_env_steps_sampled_lifetime": 50000.0, "episode_duration_sec_mean": 13.103718357999169, "num_episodes": 2.0, "agent_episode_returns_mean": {"human_1": -1848.5218200000015, "human_0": -1844.7797550000012}, "time_between_sampling": 0.39322652824489446, "connector_pipeline_timer": 0.05687870000110706, "episode_return_mean": -3693.301575000003, "num_episodes_lifetime": 15.999999999999984, "env_reset_timer": 2.718273999991652, "env_step_timer": 0.0018954233532859923, "sample": 2.8848391650449416, "num_module_steps_sampled_lifetime": {"shared_policy": 100000.0}, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 8000.0}, "episode_return_max": -2953.010500000002, "rlmodule_inference_timer": 0.0005414557831606847, "module_episode_returns_mean": {"shared_policy": -3401.2165450000025}, "episode_len_max": 2000, "num_env_steps_sampled": 4000.0, "num_env_steps_sampled_lifetime_throughput": 181.12778914250615}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.013803017986814872, "batch_individual_items": 0.3803335763964839, "add_one_ts_to_episodes_and_truncate": 0.023791147794535065, "add_states_from_episodes_to_batch": 1.1740995583216756e-05, "general_advantage_estimation": 0.07907064507799742, "add_columns_from_episodes_to_train_batch": 0.2965065896794739, "add_time_dim_to_batch_and_zero_pad": 3.333485663907323e-05, "numpy_to_tensor": 0.00034154820951390536, "add_observations_from_episodes_to_batch": 0.0007562709096627225}}, "connector_pipeline_timer": 0.7956184137985233}, "num_module_steps_trained": 80640, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 10080000, "num_env_steps_trained": 1260000, "num_module_steps_trained_lifetime": 645120, "learner_connector_sum_episodes_length_in": 4000.0, "num_trainable_parameters": 293380, "num_env_steps_trained_lifetime_throughput": 52139.09095283093, "num_module_steps_trained_lifetime_throughput": 3336.921930246259}, "shared_policy": {"weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.01, "num_module_steps_trained": 80640, "total_loss": 9.728215217590332, "module_train_batch_size_mean": 256.0, "vf_loss_unclipped": 4044.58349609375, "entropy": 0.9970465898513794, "vf_loss": 9.69151782989502, "vf_explained_var": 0.035361289978027344, "curr_kl_coeff": 0.05000000074505806, "num_module_steps_trained_lifetime": 645120, "num_trainable_parameters": 293380, "default_optimizer_learning_rate": 0.0003, "mean_kl_loss": 0.007313295733183622, "policy_loss": 0.04630214720964432, "num_module_steps_trained_lifetime_throughput": 3336.9171325197763}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 50000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 8, "trial_id": "845c7_00000", "date": "2026-01-15_17-27-02", "timestamp": 1768494422, "time_this_iter_s": 21.881935358047485, "time_total_s": 187.4707429409027, "pid": 15888, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 2, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0.5, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x0000021E0B6572E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (313,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 187.4707429409027, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.241935483870968, "ram_util_percent": 42.819354838709664}}
{"timers": {"training_iteration": 21.48386563717937, "restore_env_runners": 2.8706381249779975e-05, "training_step": 21.483406761593823, "env_runner_sampling_timer": 14.688231144756353, "learner_update_timer": 6.78485911288171, "synch_weights": 0.004258091718314568, "synch_env_connectors": 0.003054236924412492}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.3050003265962e-05, "agent_to_module_mapping": 1.4650002412963659e-05, "add_time_dim_to_batch_and_zero_pad": 3.565000224625692e-05, "batch_individual_items": 7.714999810559675e-05, "numpy_to_tensor": 0.05599349999829428, "add_states_from_episodes_to_batch": 1.8449994968250394e-05}}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.797541693170898e-05, "listify_data_for_vector_env": 2.5227742401264902e-05, "module_to_agent_unmapping": 8.63083506875711e-06, "un_batch_to_individual_items": 6.837311529303901e-05, "get_actions": 0.0010336943961684931, "tensor_to_numpy": 0.0009682914294428661, "remove_single_ts_time_rank_from_batch": 4.093113572423754e-06}}, "connector_pipeline_timer": 0.0024148335410860166}, "weights_seq_no": 8.0, "num_agent_steps_sampled": {"human_0": 4000.0, "human_1": 4000.0}, "episode_len_mean": 2000.0, "num_agent_steps_sampled_lifetime": {"human_0": 54000.0, "human_1": 54000.0}, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_return_min": -4385.604000000005, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.0790565859720293e-05, "numpy_to_tensor": 0.0002708398603460432, "add_states_from_episodes_to_batch": 1.1272979521807569e-05, "add_observations_from_episodes_to_batch": 6.0080236252137666e-05, "agent_to_module_mapping": 1.1102464910383824e-05, "add_time_dim_to_batch_and_zero_pad": 2.1588326764270116e-05}}, "connector_pipeline_timer": 0.0005724142737035805}, "agent_steps": {"human_0": 2000.0, "human_1": 2000.0}, "num_env_steps_sampled_lifetime": 54000.0, "episode_duration_sec_mean": 12.503317080987763, "num_episodes": 2.0, "agent_episode_returns_mean": {"human_1": -1803.9801650000015, "human_0": -1802.9982500000012}, "time_between_sampling": 0.4251884199615426, "connector_pipeline_timer": 0.05687870000110706, "episode_return_mean": -3606.978415000003, "num_episodes_lifetime": 17.999999999999986, "env_reset_timer": 2.718273999991652, "env_step_timer": 0.0018693614224984556, "sample": 2.7466497735274595, "num_module_steps_sampled_lifetime": {"shared_policy": 108000.0}, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 8000.0}, "episode_return_max": -2117.4384999999993, "rlmodule_inference_timer": 0.0005205835504975631, "module_episode_returns_mean": {"shared_policy": -3297.8278800000016}, "episode_len_max": 2000, "num_env_steps_sampled": 4000.0, "num_env_steps_sampled_lifetime_throughput": 181.39336743326518}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.013800441807066076, "batch_individual_items": 0.38021002863238207, "add_one_ts_to_episodes_and_truncate": 0.02372254231661496, "add_states_from_episodes_to_batch": 1.1736585614707427e-05, "general_advantage_estimation": 0.07900833762714432, "add_columns_from_episodes_to_train_batch": 0.296436614782634, "add_time_dim_to_batch_and_zero_pad": 3.333150811163972e-05, "numpy_to_tensor": 0.00034074672753244727, "add_observations_from_episodes_to_batch": 0.0007560682004383737}}, "connector_pipeline_timer": 0.7952847426606346}, "num_module_steps_trained": 80640, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 11340000, "num_env_steps_trained": 1260000, "num_module_steps_trained_lifetime": 725760, "learner_connector_sum_episodes_length_in": 4000.0, "num_trainable_parameters": 293380, "num_env_steps_trained_lifetime_throughput": 52464.53606123118, "num_module_steps_trained_lifetime_throughput": 3357.749389881936}, "shared_policy": {"weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.01, "num_module_steps_trained": 80640, "total_loss": 9.071720123291016, "module_train_batch_size_mean": 256.0, "vf_loss_unclipped": 1956.4697265625, "entropy": 0.9416643977165222, "vf_loss": 9.063569068908691, "vf_explained_var": 0.07606935501098633, "curr_kl_coeff": 0.02500000037252903, "num_module_steps_trained_lifetime": 725760, "num_trainable_parameters": 293380, "default_optimizer_learning_rate": 0.0003, "mean_kl_loss": 0.004107596352696419, "policy_loss": 0.017364148050546646, "num_module_steps_trained_lifetime_throughput": 3357.745003256929}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 54000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 9, "trial_id": "845c7_00000", "date": "2026-01-15_17-27-23", "timestamp": 1768494443, "time_this_iter_s": 21.452634572982788, "time_total_s": 208.9233775138855, "pid": 15888, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 2, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0.5, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x0000021E0B56DD80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (313,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 208.9233775138855, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 21.793333333333337, "ram_util_percent": 42.80666666666665}}
{"timers": {"training_iteration": 21.486227861807457, "restore_env_runners": 2.8686317433083775e-05, "training_step": 21.48576655797774, "env_runner_sampling_timer": 14.689681251308706, "learner_update_timer": 6.78575073275286, "synch_weights": 0.004260720801229872, "synch_env_connectors": 0.0030584465552334216}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.3050003265962e-05, "agent_to_module_mapping": 1.4650002412963659e-05, "add_time_dim_to_batch_and_zero_pad": 3.565000224625692e-05, "batch_individual_items": 7.714999810559675e-05, "numpy_to_tensor": 0.05599349999829428, "add_states_from_episodes_to_batch": 1.8449994968250394e-05}}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.930791168412194e-05, "listify_data_for_vector_env": 2.483651833775584e-05, "module_to_agent_unmapping": 9.034913289729106e-06, "un_batch_to_individual_items": 6.884591470688914e-05, "get_actions": 0.0010544418895607332, "tensor_to_numpy": 0.0009550543185395134, "remove_single_ts_time_rank_from_batch": 3.964344403496665e-06}}, "connector_pipeline_timer": 0.00242749970843589}, "weights_seq_no": 9.0, "num_agent_steps_sampled": {"human_0": 4000.0, "human_1": 4000.0}, "episode_len_mean": 2000.0, "num_agent_steps_sampled_lifetime": {"human_0": 58000.0, "human_1": 58000.0}, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_return_min": -4385.604000000005, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.241011565468565e-05, "numpy_to_tensor": 0.0002713735479740587, "add_states_from_episodes_to_batch": 1.1058724270295354e-05, "add_observations_from_episodes_to_batch": 5.978035908603903e-05, "agent_to_module_mapping": 1.0926544054149319e-05, "add_time_dim_to_batch_and_zero_pad": 2.193202338235663e-05}}, "connector_pipeline_timer": 0.0005748841011158642}, "agent_steps": {"human_0": 2000.0, "human_1": 2000.0}, "num_env_steps_sampled_lifetime": 58000.0, "episode_duration_sec_mean": 11.854820056986647, "num_episodes": 2.0, "agent_episode_returns_mean": {"human_1": -1566.645695000001, "human_0": -1571.9163250000006}, "time_between_sampling": 0.4540332709773283, "connector_pipeline_timer": 0.05687870000110706, "episode_return_mean": -3138.5620200000017, "num_episodes_lifetime": 19.999999999999986, "env_reset_timer": 2.718273999991652, "env_step_timer": 0.0018920887226261582, "sample": 2.621965322348749, "num_module_steps_sampled_lifetime": {"shared_policy": 116000.0}, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 8000.0}, "episode_return_max": -1437.5004999999992, "rlmodule_inference_timer": 0.0005357784864372854, "module_episode_returns_mean": {"shared_policy": -2884.3313050000015}, "episode_len_max": 2000, "num_env_steps_sampled": 4000.0, "num_env_steps_sampled_lifetime_throughput": 181.5070854798812}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.013794908389101721, "batch_individual_items": 0.3800874443460329, "add_one_ts_to_episodes_and_truncate": 0.02368990389334712, "add_states_from_episodes_to_batch": 1.1736219776341163e-05, "general_advantage_estimation": 0.07891386825086945, "add_columns_from_episodes_to_train_batch": 0.2962676366347481, "add_time_dim_to_batch_and_zero_pad": 3.349419302381408e-05, "numpy_to_tensor": 0.0003397632602337224, "add_observations_from_episodes_to_batch": 0.0007559785184238814}}, "connector_pipeline_timer": 0.7948547202340792}, "num_module_steps_trained": 80640, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 12600000, "num_env_steps_trained": 1260000, "num_module_steps_trained_lifetime": 806400, "learner_connector_sum_episodes_length_in": 4000.0, "num_trainable_parameters": 293380, "num_env_steps_trained_lifetime_throughput": 52736.78870971816, "num_module_steps_trained_lifetime_throughput": 3375.1690785151486}, "shared_policy": {"weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.01, "num_module_steps_trained": 80640, "total_loss": 9.819462776184082, "module_train_batch_size_mean": 256.0, "vf_loss_unclipped": 1139.3316650390625, "entropy": 0.8590867519378662, "vf_loss": 9.68209171295166, "vf_explained_var": 0.036045968532562256, "curr_kl_coeff": 0.02500000037252903, "num_module_steps_trained_lifetime": 806400, "num_trainable_parameters": 293380, "default_optimizer_learning_rate": 0.0003, "mean_kl_loss": 0.006365153472870588, "policy_loss": 0.14580287039279938, "num_module_steps_trained_lifetime_throughput": 3375.1662866550196}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 58000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": true, "training_iteration": 10, "trial_id": "845c7_00000", "date": "2026-01-15_17-27-45", "timestamp": 1768494465, "time_this_iter_s": 21.73803472518921, "time_total_s": 230.6614122390747, "pid": 15888, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 2, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0.5, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x0000021E0B7B52D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (313,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 230.6614122390747, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 21.719354838709684, "ram_util_percent": 42.79032258064515}}
