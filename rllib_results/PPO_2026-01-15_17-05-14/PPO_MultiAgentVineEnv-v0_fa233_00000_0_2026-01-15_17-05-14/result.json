{"timers": {"training_iteration": 24.739187300001504, "restore_env_runners": 3.460000152699649e-05, "training_step": 24.73872680000204, "env_runner_sampling_timer": 13.92620370000077, "learner_update_timer": 10.799623300001258, "synch_weights": 0.004025700007332489}, "env_runners": {"num_episodes": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.897159403243914e-05, "remove_single_ts_time_rank_from_batch": 3.858105711871432e-06, "module_to_agent_unmapping": 9.174341425909904e-06, "normalize_and_clip_actions": 0.00011704219169634167, "get_actions": 0.00038844349377232054, "tensor_to_numpy": 0.00012392737338322467, "listify_data_for_vector_env": 3.361507452894381e-05}}, "connector_pipeline_timer": 0.0009682595598094439}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0499999411404133e-05, "add_states_from_episodes_to_batch": 1.2899996363557875e-05, "batch_individual_items": 7.745000038994476e-05, "add_observations_from_episodes_to_batch": 8.550000347895548e-05, "agent_to_module_mapping": 1.6500001947861165e-05, "numpy_to_tensor": 0.00011284999345662072}}, "connector_pipeline_timer": 0.0009456499974476171, "num_agent_steps_sampled": {"human_1": 4000.0, "human_2": 4000.0, "human_0": 4000.0}, "time_between_sampling": 0.025559413786789963, "env_to_module_sum_episodes_length_out": 129.70023112683015, "rlmodule_inference_timer": 0.0003874350100698744, "num_agent_steps_sampled_lifetime": {"human_1": 22000.0, "human_2": 22000.0, "human_0": 22000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.238605199967656e-05, "add_states_from_episodes_to_batch": 1.2295045431992029e-05, "batch_individual_items": 5.7016848628735024e-05, "add_observations_from_episodes_to_batch": 7.153607550446592e-05, "agent_to_module_mapping": 1.2571733167238445e-05, "numpy_to_tensor": 8.711469663508628e-05}}, "connector_pipeline_timer": 0.0004184093686507907}, "num_episodes_lifetime": 2.0, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 12000.0}, "agent_episode_returns_mean": {"human_1": -4122.666916666666, "human_2": -4109.326416666667, "human_0": -4130.840916666666}, "agent_steps": {"human_1": 2000.0, "human_2": 2000.0, "human_0": 2000.0}, "episode_return_min": -12504.680499999999, "episode_return_mean": -12362.834249999996, "env_reset_timer": 3.29158379999717, "episode_len_max": 2000, "episode_duration_sec_mean": 10.222597300002235, "num_module_steps_sampled_lifetime": {"shared_policy": 66000.0}, "sample": 4.268050961013565, "num_env_steps_sampled_lifetime": 22000.0, "episode_len_mean": 2000.0, "module_episode_returns_mean": {"shared_policy": -11437.303833333332}, "weights_seq_no": 0.0, "episode_return_max": -12220.987999999994, "env_to_module_sum_episodes_length_in": 129.70023112683015, "num_env_steps_sampled": 4000.0, "env_step_timer": 0.0023797995589666747, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 4000, "learner_connector_sum_episodes_length_out": 4000, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 1888000, "num_module_steps_trained_lifetime": 120832, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.929999365936965e-05, "batch_individual_items": 0.48383470000408124, "add_observations_from_episodes_to_batch": 0.0011691999970935285, "add_columns_from_episodes_to_train_batch": 0.4864772000000812, "general_advantage_estimation": 0.12280389999796171, "numpy_to_tensor": 0.0008726999949431047, "add_states_from_episodes_to_batch": 1.2599994079209864e-05, "add_one_ts_to_episodes_and_truncate": 0.04145089999656193, "agent_to_module_mapping": 0.019622699997853488}}, "connector_pipeline_timer": 1.1574018000101205}, "num_trainable_parameters": 294916, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "shared_policy": {"default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 294916, "vf_loss": 9.8182373046875, "curr_kl_coeff": 0.10000000149011612, "entropy": 1.093187928199768, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 120832, "policy_loss": 0.042616527527570724, "num_module_steps_trained": 120832, "vf_explained_var": 0.00011527538299560547, "curr_entropy_coeff": 0.01, "total_loss": 9.850356101989746, "mean_kl_loss": 0.0021708535496145487, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 1.0, "vf_loss_unclipped": 16673.935546875, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 22000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 1, "trial_id": "fa233_00000", "date": "2026-01-15_17-06-09", "timestamp": 1768493169, "time_this_iter_s": 24.74793314933777, "time_total_s": 24.74793314933777, "pid": 39548, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000002ABA0510790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.74793314933777, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.102857142857143, "ram_util_percent": 39.837142857142865}}
{"timers": {"training_iteration": 24.73441120700154, "restore_env_runners": 3.448400151683018e-05, "training_step": 24.73394918000209, "env_runner_sampling_timer": 13.92575715800078, "learner_update_timer": 10.795306555001298, "synch_weights": 0.00402166500716703, "synch_env_connectors": 0.0038483999960590154}, "env_runners": {"num_episodes": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.626348796813298e-05, "remove_single_ts_time_rank_from_batch": 3.824827476786292e-06, "module_to_agent_unmapping": 8.865775433946696e-06, "normalize_and_clip_actions": 0.0001117720223380149, "get_actions": 0.0003709382265342872, "tensor_to_numpy": 0.0001374071232014364, "listify_data_for_vector_env": 3.373465684803998e-05}}, "connector_pipeline_timer": 0.0009550667474560938}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0499999411404133e-05, "add_states_from_episodes_to_batch": 1.2899996363557875e-05, "batch_individual_items": 7.745000038994476e-05, "add_observations_from_episodes_to_batch": 8.550000347895548e-05, "agent_to_module_mapping": 1.6500001947861165e-05, "numpy_to_tensor": 0.00011284999345662072}}, "connector_pipeline_timer": 0.0009456499974476171, "num_agent_steps_sampled": {"human_1": 4000.0, "human_2": 4000.0, "human_0": 4000.0}, "time_between_sampling": 0.12945839458590583, "env_to_module_sum_episodes_length_out": 131.69041762873871, "rlmodule_inference_timer": 0.00034231544977151766, "num_agent_steps_sampled_lifetime": {"human_1": 26000.0, "human_2": 26000.0, "human_0": 26000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1344153408253742e-05, "add_states_from_episodes_to_batch": 1.1976976482168762e-05, "batch_individual_items": 5.429040984404055e-05, "add_observations_from_episodes_to_batch": 7.081856674751e-05, "agent_to_module_mapping": 1.2100540809634298e-05, "numpy_to_tensor": 8.013797123534197e-05}}, "connector_pipeline_timer": 0.00040800884970854394}, "num_episodes_lifetime": 4.000000000000002, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 12000.0}, "agent_episode_returns_mean": {"human_1": -4175.6513863636355, "human_2": -4163.59865909091, "human_0": -4183.841681818183}, "agent_steps": {"human_1": 2000.0, "human_2": 2000.0, "human_0": 2000.0}, "episode_return_min": -14496.313999999998, "episode_return_mean": -12523.091727272724, "env_reset_timer": 3.29158379999717, "episode_len_max": 2000, "episode_duration_sec_mean": 10.22805440000295, "num_module_steps_sampled_lifetime": {"shared_policy": 78000.0}, "sample": 3.9893779327454872, "num_env_steps_sampled_lifetime": 26000.0, "episode_len_mean": 2000.0, "module_episode_returns_mean": {"shared_policy": -11582.829265151515}, "weights_seq_no": 1.0, "episode_return_max": -12220.987999999994, "env_to_module_sum_episodes_length_in": 131.69041762873871, "num_env_steps_sampled": 4000.0, "env_step_timer": 0.00298938238882521, "num_env_steps_sampled_lifetime_throughput": 161.71920190406286}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 4000.0, "learner_connector_sum_episodes_length_out": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 3776000, "num_module_steps_trained_lifetime": 241664, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.927199359168299e-05, "batch_individual_items": 0.4858310890039138, "add_observations_from_episodes_to_batch": 0.0011682959970494265, "add_columns_from_episodes_to_train_batch": 0.4858208420001029, "general_advantage_estimation": 0.12266854599802172, "numpy_to_tensor": 0.0008673089950752911, "add_states_from_episodes_to_batch": 1.2584994110511615e-05, "add_one_ts_to_episodes_and_truncate": 0.04134310399662354, "agent_to_module_mapping": 0.019621830997784855}}, "connector_pipeline_timer": 1.1584850510099205}, "num_trainable_parameters": 294916, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "shared_policy": {"default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 294916, "vf_loss": 9.945162773132324, "curr_kl_coeff": 0.05000000074505806, "entropy": 1.0848259925842285, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 241664, "policy_loss": -0.03309525549411774, "num_module_steps_trained": 120832, "vf_explained_var": 0.00027698278427124023, "curr_entropy_coeff": 0.01, "total_loss": 9.901514053344727, "mean_kl_loss": 0.0029626989271491766, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 2.0, "vf_loss_unclipped": 21027.26953125, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 26000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 2, "trial_id": "fa233_00000", "date": "2026-01-15_17-06-33", "timestamp": 1768493193, "time_this_iter_s": 24.27030873298645, "time_total_s": 49.01824188232422, "pid": 39548, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000002ABA0511A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.01824188232422, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.188235294117646, "ram_util_percent": 39.885294117647064}}
{"timers": {"training_iteration": 24.715027133931404, "restore_env_runners": 3.443216154992115e-05, "training_step": 24.714561425202035, "env_runner_sampling_timer": 13.913771816420716, "learner_update_timer": 10.787858892451274, "synch_weights": 0.004022161357002915, "synch_env_connectors": 0.0038499969961412715}, "env_runners": {"num_episodes": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.776773157266341e-05, "remove_single_ts_time_rank_from_batch": 3.4707933714323947e-06, "module_to_agent_unmapping": 8.162969624495394e-06, "normalize_and_clip_actions": 0.00010048983373080035, "get_actions": 0.00033523623828068087, "tensor_to_numpy": 0.00010768891015624406, "listify_data_for_vector_env": 2.9201190807187718e-05}}, "connector_pipeline_timer": 0.0008416782294136702}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0499999411404133e-05, "add_states_from_episodes_to_batch": 1.2899996363557875e-05, "batch_individual_items": 7.745000038994476e-05, "add_observations_from_episodes_to_batch": 8.550000347895548e-05, "agent_to_module_mapping": 1.6500001947861165e-05, "numpy_to_tensor": 0.00011284999345662072}}, "connector_pipeline_timer": 0.0009456499974476171, "num_agent_steps_sampled": {"human_1": 4000.0, "human_2": 4000.0, "human_0": 4000.0}, "time_between_sampling": 0.2195140482924109, "env_to_module_sum_episodes_length_out": 131.6904176324108, "rlmodule_inference_timer": 0.00032003171954266094, "num_agent_steps_sampled_lifetime": {"human_1": 30000.0, "human_2": 30000.0, "human_0": 30000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0569865144790056e-05, "add_states_from_episodes_to_batch": 1.067634455282154e-05, "batch_individual_items": 5.0974870183427136e-05, "add_observations_from_episodes_to_batch": 6.509813102377446e-05, "agent_to_module_mapping": 1.128262666467549e-05, "numpy_to_tensor": 7.756105515718298e-05}}, "connector_pipeline_timer": 0.00037568474660320704}, "num_episodes_lifetime": 6.0000000000000036, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 12000.0}, "agent_episode_returns_mean": {"human_1": -4385.70965079365, "human_2": -4379.441960317462, "human_0": -4394.889603174603}, "agent_steps": {"human_1": 2000.0, "human_2": 2000.0, "human_0": 2000.0}, "episode_return_min": -14496.313999999998, "episode_return_mean": -13160.041214285713, "env_reset_timer": 3.29158379999717, "episode_len_max": 2000, "episode_duration_sec_mean": 10.19583695714807, "num_module_steps_sampled_lifetime": {"shared_policy": 90000.0}, "sample": 3.7343743597459813, "num_env_steps_sampled_lifetime": 30000.0, "episode_len_mean": 2000.0, "module_episode_returns_mean": {"shared_policy": -12163.722428571427}, "weights_seq_no": 2.0, "episode_return_max": -11466.101499999997, "env_to_module_sum_episodes_length_in": 131.6904176324108, "num_env_steps_sampled": 4000.0, "env_step_timer": 0.002645286045985476, "num_env_steps_sampled_lifetime_throughput": 162.26841350304022}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 4000.0, "learner_connector_sum_episodes_length_out": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 5664000, "num_module_steps_trained_lifetime": 362496, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.922927370149409e-05, "batch_individual_items": 0.4857083331138085, "add_observations_from_episodes_to_batch": 0.0011683070370650966, "add_columns_from_episodes_to_train_batch": 0.48550555258018874, "general_advantage_estimation": 0.12261157653804548, "numpy_to_tensor": 0.0008612579051536158, "add_states_from_episodes_to_batch": 1.2569144133885856e-05, "add_one_ts_to_episodes_and_truncate": 0.041241781956590416, "agent_to_module_mapping": 0.019628621687767734}}, "connector_pipeline_timer": 1.1578830664997979}, "num_trainable_parameters": 294916, "num_env_steps_trained_lifetime_throughput": 82647.1703042661, "num_module_steps_trained_lifetime_throughput": 5289.397481717206}, "shared_policy": {"default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 294916, "vf_loss": 9.891744613647461, "curr_kl_coeff": 0.02500000037252903, "entropy": 1.0779350996017456, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 362496, "policy_loss": 0.08662868291139603, "num_module_steps_trained": 120832, "vf_explained_var": 0.0005016922950744629, "curr_entropy_coeff": 0.01, "total_loss": 9.9678373336792, "mean_kl_loss": 0.004861506633460522, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 3.0, "vf_loss_unclipped": 14830.61328125, "num_module_steps_trained_lifetime_throughput": 5289.399264594031}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 3, "trial_id": "fa233_00000", "date": "2026-01-15_17-06-56", "timestamp": 1768493216, "time_this_iter_s": 22.80387568473816, "time_total_s": 71.82211756706238, "pid": 39548, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000002ABA0510700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 71.82211756706238, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.296875, "ram_util_percent": 39.890625}}
{"timers": {"training_iteration": 24.701299676592168, "restore_env_runners": 3.45988400419301e-05, "training_step": 24.700829871949946, "env_runner_sampling_timer": 13.902833698256444, "learner_update_timer": 10.785034629526715, "synch_weights": 0.004024802743413457, "synch_env_connectors": 0.0038452190262600193}, "env_runners": {"num_episodes": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.949050202217833e-05, "remove_single_ts_time_rank_from_batch": 3.726162022839307e-06, "module_to_agent_unmapping": 8.638348293177103e-06, "normalize_and_clip_actions": 0.00010579998714999397, "get_actions": 0.00035344273708822003, "tensor_to_numpy": 0.00011201248006783776, "listify_data_for_vector_env": 3.146133182620863e-05}}, "connector_pipeline_timer": 0.0008825712048246444}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0499999411404133e-05, "add_states_from_episodes_to_batch": 1.2899996363557875e-05, "batch_individual_items": 7.745000038994476e-05, "add_observations_from_episodes_to_batch": 8.550000347895548e-05, "agent_to_module_mapping": 1.6500001947861165e-05, "numpy_to_tensor": 0.00011284999345662072}}, "connector_pipeline_timer": 0.0009456499974476171, "num_agent_steps_sampled": {"human_1": 4000.0, "human_2": 4000.0, "human_0": 4000.0}, "time_between_sampling": 0.29751200803694394, "env_to_module_sum_episodes_length_out": 131.6904176324108, "rlmodule_inference_timer": 0.00034074772399698646, "num_agent_steps_sampled_lifetime": {"human_1": 34000.0, "human_2": 34000.0, "human_0": 34000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1366948699440368e-05, "add_states_from_episodes_to_batch": 1.1323907797404129e-05, "batch_individual_items": 5.473690425469693e-05, "add_observations_from_episodes_to_batch": 6.793504306060172e-05, "agent_to_module_mapping": 1.1714800040445164e-05, "numpy_to_tensor": 8.172056550265685e-05}}, "connector_pipeline_timer": 0.0003964601340706553}, "num_episodes_lifetime": 8.000000000000004, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 12000.0}, "agent_episode_returns_mean": {"human_1": -4230.81784, "human_2": -4226.11791, "human_0": -4248.078844999999}, "agent_steps": {"human_1": 2000.0, "human_2": 2000.0, "human_0": 2000.0}, "episode_return_min": -14496.313999999998, "episode_return_mean": -12705.014594999999, "env_reset_timer": 3.29158379999717, "episode_len_max": 2000, "episode_duration_sec_mean": 9.758457787998776, "num_module_steps_sampled_lifetime": {"shared_policy": 102000.0}, "sample": 3.490385451227186, "num_env_steps_sampled_lifetime": 34000.0, "episode_len_mean": 2000.0, "module_episode_returns_mean": {"shared_policy": -11771.518364999998}, "weights_seq_no": 3.0, "episode_return_max": -11466.101499999997, "env_to_module_sum_episodes_length_in": 131.6904176324108, "num_env_steps_sampled": 4000.0, "env_step_timer": 0.002668402052887257, "num_env_steps_sampled_lifetime_throughput": 162.87499872714233}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 4000.0, "learner_connector_sum_episodes_length_out": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 7552000, "num_module_steps_trained_lifetime": 483328, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.924298100006126e-05, "batch_individual_items": 0.48738580278276267, "add_observations_from_episodes_to_batch": 0.0011672069666610187, "add_columns_from_episodes_to_train_batch": 0.4853098700542727, "general_advantage_estimation": 0.12245575177273414, "numpy_to_tensor": 0.00085632132615328, "add_states_from_episodes_to_batch": 1.2555452672255341e-05, "add_one_ts_to_episodes_and_truncate": 0.04118614213701117, "agent_to_module_mapping": 0.019629964470921215}}, "connector_pipeline_timer": 1.1591425648347327}, "num_trainable_parameters": 294916, "num_env_steps_trained_lifetime_throughput": 82550.95778525923, "num_module_steps_trained_lifetime_throughput": 5283.2391103020755}, "shared_policy": {"default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 294916, "vf_loss": 9.90916919708252, "curr_kl_coeff": 0.012500000186264515, "entropy": 1.0747239589691162, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 483328, "policy_loss": 0.09778619557619095, "num_module_steps_trained": 120832, "vf_explained_var": 0.0009999871253967285, "curr_entropy_coeff": 0.01, "total_loss": 9.99632740020752, "mean_kl_loss": 0.00473953690379858, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 4.0, "vf_loss_unclipped": 19544.20703125, "num_module_steps_trained_lifetime_throughput": 5283.236817128839}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 34000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 4, "trial_id": "fa233_00000", "date": "2026-01-15_17-07-19", "timestamp": 1768493239, "time_this_iter_s": 23.35165500640869, "time_total_s": 95.17377257347107, "pid": 39548, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000002ABA0513010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 95.17377257347107, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.945454545454545, "ram_util_percent": 39.80909090909091}}
{"timers": {"training_iteration": 24.68783116782629, "restore_env_runners": 3.453485160601064e-05, "training_step": 24.687358003230393, "env_runner_sampling_timer": 13.890060742273818, "learner_update_timer": 10.78432799723157, "synch_weights": 0.004027104715904863, "synch_env_connectors": 0.0038486218360150952}, "env_runners": {"num_episodes": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.647737745969628e-05, "remove_single_ts_time_rank_from_batch": 3.525315080886783e-06, "module_to_agent_unmapping": 8.155493452917276e-06, "normalize_and_clip_actions": 9.986947448028117e-05, "get_actions": 0.00034449461808010943, "tensor_to_numpy": 0.00010932507464238797, "listify_data_for_vector_env": 2.8673822899690702e-05}}, "connector_pipeline_timer": 0.0008507902271691787}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0499999411404133e-05, "add_states_from_episodes_to_batch": 1.2899996363557875e-05, "batch_individual_items": 7.745000038994476e-05, "add_observations_from_episodes_to_batch": 8.550000347895548e-05, "agent_to_module_mapping": 1.6500001947861165e-05, "numpy_to_tensor": 0.00011284999345662072}}, "connector_pipeline_timer": 0.0009456499974476171, "num_agent_steps_sampled": {"human_1": 4000.0, "human_2": 4000.0, "human_0": 4000.0}, "time_between_sampling": 0.37271372848856643, "env_to_module_sum_episodes_length_out": 131.6904176324108, "rlmodule_inference_timer": 0.0003264086860188521, "num_agent_steps_sampled_lifetime": {"human_1": 38000.0, "human_2": 38000.0, "human_0": 38000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.078973819670209e-05, "add_states_from_episodes_to_batch": 1.0704747627393517e-05, "batch_individual_items": 5.183205302280064e-05, "add_observations_from_episodes_to_batch": 6.51583834388746e-05, "agent_to_module_mapping": 1.1076327264762053e-05, "numpy_to_tensor": 7.950809909306443e-05}}, "connector_pipeline_timer": 0.0003785412832044132}, "num_episodes_lifetime": 9.999999999999991, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 12000.0}, "agent_episode_returns_mean": {"human_1": -4233.952181666666, "human_2": -4231.034891666666, "human_0": -4263.191976666666}, "agent_steps": {"human_1": 2000.0, "human_2": 2000.0, "human_0": 2000.0}, "episode_return_min": -15300.670000000004, "episode_return_mean": -12728.179049999999, "env_reset_timer": 3.29158379999717, "episode_len_max": 2000, "episode_duration_sec_mean": 9.520672847998938, "num_module_steps_sampled_lifetime": {"shared_policy": 114000.0}, "sample": 3.2805617846689885, "num_env_steps_sampled_lifetime": 38000.0, "episode_len_mean": 2000.0, "module_episode_returns_mean": {"shared_policy": -11813.40551833333}, "weights_seq_no": 4.0, "episode_return_max": -11466.101499999997, "env_to_module_sum_episodes_length_in": 131.6904176324108, "num_env_steps_sampled": 4000.0, "env_step_timer": 0.0025932907860260535, "num_env_steps_sampled_lifetime_throughput": 163.35096055452482}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 4000.0, "learner_connector_sum_episodes_length_out": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 9440000, "num_module_steps_trained_lifetime": 604160, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.9220551242559304e-05, "batch_individual_items": 0.48717790575492653, "add_observations_from_episodes_to_batch": 0.0011667168968654501, "add_columns_from_episodes_to_train_batch": 0.4849260453537327, "general_advantage_estimation": 0.12236764225504064, "numpy_to_tensor": 0.0008502421128886589, "add_states_from_episodes_to_batch": 1.2551898055866914e-05, "add_one_ts_to_episodes_and_truncate": 0.04106234571569991, "agent_to_module_mapping": 0.01963337482622733}}, "connector_pipeline_timer": 1.1583293861863655}, "num_trainable_parameters": 294916, "num_env_steps_trained_lifetime_throughput": 82455.56939209824, "num_module_steps_trained_lifetime_throughput": 5277.137794142171}, "shared_policy": {"default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 294916, "vf_loss": 9.729591369628906, "curr_kl_coeff": 0.0062500000931322575, "entropy": 1.0728660821914673, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 604160, "policy_loss": -0.031480953097343445, "num_module_steps_trained": 120832, "vf_explained_var": 0.0009898543357849121, "curr_entropy_coeff": 0.01, "total_loss": 9.68741512298584, "mean_kl_loss": 0.00268554431386292, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 5.0, "vf_loss_unclipped": 24653.38671875, "num_module_steps_trained_lifetime_throughput": 5277.139984033641}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 38000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 5, "trial_id": "fa233_00000", "date": "2026-01-15_17-07-43", "timestamp": 1768493263, "time_this_iter_s": 23.362834692001343, "time_total_s": 118.53660726547241, "pid": 39548, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000002ABA0598940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 118.53660726547241, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.96363636363636, "ram_util_percent": 39.81818181818182}}
{"timers": {"training_iteration": 24.690941493148088, "restore_env_runners": 3.4405503133970434e-05, "training_step": 24.690467530198095, "env_runner_sampling_timer": 13.888700713851131, "learner_update_timer": 10.788790398259252, "synch_weights": 0.004026285668801277, "synch_env_connectors": 0.0038504986176622906}, "env_runners": {"num_episodes": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.607108220182324e-05, "remove_single_ts_time_rank_from_batch": 4.279599418243068e-06, "module_to_agent_unmapping": 9.19537756342963e-06, "normalize_and_clip_actions": 0.00011550250672450355, "get_actions": 0.0004119574335552466, "tensor_to_numpy": 0.00012727497112390173, "listify_data_for_vector_env": 3.371383444825718e-05}}, "connector_pipeline_timer": 0.0009912310709408146}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0499999411404133e-05, "add_states_from_episodes_to_batch": 1.2899996363557875e-05, "batch_individual_items": 7.745000038994476e-05, "add_observations_from_episodes_to_batch": 8.550000347895548e-05, "agent_to_module_mapping": 1.6500001947861165e-05, "numpy_to_tensor": 0.00011284999345662072}}, "connector_pipeline_timer": 0.0009456499974476171, "num_agent_steps_sampled": {"human_1": 4000.0, "human_2": 4000.0, "human_0": 4000.0}, "time_between_sampling": 0.44289087689240436, "env_to_module_sum_episodes_length_out": 131.6904176324108, "rlmodule_inference_timer": 0.0004041854448890308, "num_agent_steps_sampled_lifetime": {"human_1": 42000.0, "human_2": 42000.0, "human_0": 42000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5763037692955698e-05, "add_states_from_episodes_to_batch": 1.2044118552648601e-05, "batch_individual_items": 6.175124466748512e-05, "add_observations_from_episodes_to_batch": 7.700016862254629e-05, "agent_to_module_mapping": 1.3228585271779398e-05, "numpy_to_tensor": 9.763164448271825e-05}}, "connector_pipeline_timer": 0.00045014762969413497}, "num_episodes_lifetime": 11.999999999999991, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 12000.0}, "agent_episode_returns_mean": {"human_1": -4552.869915, "human_2": -4548.570295, "human_0": -4585.795349999999}, "agent_steps": {"human_1": 2000.0, "human_2": 2000.0, "human_0": 2000.0}, "episode_return_min": -15300.670000000004, "episode_return_mean": -13687.23556, "env_reset_timer": 3.29158379999717, "episode_len_max": 2000, "episode_duration_sec_mean": 9.307279260998476, "num_module_steps_sampled_lifetime": {"shared_policy": 126000.0}, "sample": 3.0899136696888334, "num_env_steps_sampled_lifetime": 42000.0, "episode_len_mean": 2000.0, "module_episode_returns_mean": {"shared_policy": -12663.452826666668}, "weights_seq_no": 5.0, "episode_return_max": -11466.101499999997, "env_to_module_sum_episodes_length_in": 131.6904176324108, "num_env_steps_sampled": 4000.0, "env_step_timer": 0.0028645392786944526, "num_env_steps_sampled_lifetime_throughput": 163.33587100051872}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 4000.0, "learner_connector_sum_episodes_length_out": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 11328000, "num_module_steps_trained_lifetime": 724992, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.924834572679958e-05, "batch_individual_items": 0.4892100796973782, "add_observations_from_episodes_to_batch": 0.0011718217279867817, "add_columns_from_episodes_to_train_batch": 0.4848730749002811, "general_advantage_estimation": 0.12229561383257666, "numpy_to_tensor": 0.0008444176917787042, "add_states_from_episodes_to_batch": 1.2543379093089057e-05, "add_one_ts_to_episodes_and_truncate": 0.04103200425851207, "agent_to_module_mapping": 0.019637562077898418}}, "connector_pipeline_timer": 1.1602039153244188}, "num_trainable_parameters": 294916, "num_env_steps_trained_lifetime_throughput": 82101.56050789324, "num_module_steps_trained_lifetime_throughput": 5254.482279233454}, "shared_policy": {"default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 294916, "vf_loss": 9.876825332641602, "curr_kl_coeff": 0.0031250000465661287, "entropy": 1.0711227655410767, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 724992, "policy_loss": -0.0300475861877203, "num_module_steps_trained": 120832, "vf_explained_var": 0.0005939006805419922, "curr_entropy_coeff": 0.01, "total_loss": 9.83609676361084, "mean_kl_loss": 0.004765112418681383, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 6.0, "vf_loss_unclipped": 23044.08984375, "num_module_steps_trained_lifetime_throughput": 5254.484529111063}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 42000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 6, "trial_id": "fa233_00000", "date": "2026-01-15_17-08-08", "timestamp": 1768493288, "time_this_iter_s": 25.00575017929077, "time_total_s": 143.54235744476318, "pid": 39548, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000002ABA0599EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 143.54235744476318, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.431428571428572, "ram_util_percent": 39.925714285714285}}
{"timers": {"training_iteration": 24.708040039216634, "restore_env_runners": 3.450744800623512e-05, "training_step": 24.707562156896127, "env_runner_sampling_timer": 13.903744349712678, "learner_update_timer": 10.790809072276597, "synch_weights": 0.0040278458120327956, "synch_env_connectors": 0.0038460826314499646}, "env_runners": {"num_episodes": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.435218082324302e-05, "remove_single_ts_time_rank_from_batch": 4.431530482729593e-06, "module_to_agent_unmapping": 9.853911230235006e-06, "normalize_and_clip_actions": 0.00012171117860042748, "get_actions": 0.00041322475068013254, "tensor_to_numpy": 0.00012896377594110036, "listify_data_for_vector_env": 3.724120589117839e-05}}, "connector_pipeline_timer": 0.001029983128746294}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0499999411404133e-05, "add_states_from_episodes_to_batch": 1.2899996363557875e-05, "batch_individual_items": 7.745000038994476e-05, "add_observations_from_episodes_to_batch": 8.550000347895548e-05, "agent_to_module_mapping": 1.6500001947861165e-05, "numpy_to_tensor": 0.00011284999345662072}}, "connector_pipeline_timer": 0.0009456499974476171, "num_agent_steps_sampled": {"human_1": 4000.0, "human_2": 4000.0, "human_0": 4000.0}, "time_between_sampling": 0.5111938163854094, "env_to_module_sum_episodes_length_out": 131.6904176324108, "rlmodule_inference_timer": 0.0004049529316470851, "num_agent_steps_sampled_lifetime": {"human_1": 46000.0, "human_2": 46000.0, "human_0": 46000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5062439779797938e-05, "add_states_from_episodes_to_batch": 1.3129792430587443e-05, "batch_individual_items": 6.263821924848214e-05, "add_observations_from_episodes_to_batch": 7.985176882329673e-05, "agent_to_module_mapping": 1.3655956106874286e-05, "numpy_to_tensor": 9.411761040955153e-05}}, "connector_pipeline_timer": 0.000460585773498131}, "num_episodes_lifetime": 13.999999999999984, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 12000.0}, "agent_episode_returns_mean": {"human_1": -4790.669115000001, "human_2": -4794.760625, "human_0": -4820.601659999999}, "agent_steps": {"human_1": 2000.0, "human_2": 2000.0, "human_0": 2000.0}, "episode_return_min": -15300.670000000004, "episode_return_mean": -14406.031400000002, "env_reset_timer": 3.29158379999717, "episode_len_max": 2000, "episode_duration_sec_mean": 9.7762636739992, "num_module_steps_sampled_lifetime": {"shared_policy": 138000.0}, "sample": 2.93436517545633, "num_env_steps_sampled_lifetime": 46000.0, "episode_len_mean": 2000.0, "module_episode_returns_mean": {"shared_policy": -13269.567374999999}, "weights_seq_no": 6.0, "episode_return_max": -10714.135499999999, "env_to_module_sum_episodes_length_in": 131.6904176324108, "num_env_steps_sampled": 4000.0, "env_step_timer": 0.003255117759469992, "num_env_steps_sampled_lifetime_throughput": 162.66467315089048}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 4000.0, "learner_connector_sum_episodes_length_out": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 13216000, "num_module_steps_trained_lifetime": 845824, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.9226862184125574e-05, "batch_individual_items": 0.4895566849003499, "add_observations_from_episodes_to_batch": 0.0011775275106683794, "add_columns_from_episodes_to_train_batch": 0.485838982151289, "general_advantage_estimation": 0.12229433169422214, "numpy_to_tensor": 0.00084463251472912, "add_states_from_episodes_to_batch": 1.2527945266637522e-05, "add_one_ts_to_episodes_and_truncate": 0.04102706821582295, "agent_to_module_mapping": 0.01971602845719109}}, "connector_pipeline_timer": 1.1615893261711026}, "num_trainable_parameters": 294916, "num_env_steps_trained_lifetime_throughput": 81565.51475769539, "num_module_steps_trained_lifetime_throughput": 5220.175278345709}, "shared_policy": {"default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 294916, "vf_loss": 9.775324821472168, "curr_kl_coeff": 0.0031250000465661287, "entropy": 1.066055178642273, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 845824, "policy_loss": -0.06414727866649628, "num_module_steps_trained": 120832, "vf_explained_var": 0.0009622573852539062, "curr_entropy_coeff": 0.01, "total_loss": 9.70053768157959, "mean_kl_loss": 0.006399700418114662, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 7.0, "vf_loss_unclipped": 14896.6591796875, "num_module_steps_trained_lifetime_throughput": 5220.177093612585}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 46000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 7, "trial_id": "fa233_00000", "date": "2026-01-15_17-08-34", "timestamp": 1768493314, "time_this_iter_s": 26.409501314163208, "time_total_s": 169.9518587589264, "pid": 39548, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000002ABA0513400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 169.9518587589264, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.65135135135135, "ram_util_percent": 39.943243243243245}}
{"timers": {"training_iteration": 24.71967720282443, "restore_env_runners": 3.438837350081844e-05, "training_step": 24.719198583327184, "env_runner_sampling_timer": 13.916899694215653, "learner_update_timer": 10.789263532553887, "synch_weights": 0.004028418353852189, "synch_env_connectors": 0.0038433168051050294}, "env_runners": {"num_episodes": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.428333028762809e-05, "remove_single_ts_time_rank_from_batch": 4.44415315615857e-06, "module_to_agent_unmapping": 1.0124574304241116e-05, "normalize_and_clip_actions": 0.00012206371782375043, "get_actions": 0.0004134335384039253, "tensor_to_numpy": 0.00012904977450170455, "listify_data_for_vector_env": 3.726074359283764e-05}}, "connector_pipeline_timer": 0.0010310661478313966}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0499999411404133e-05, "add_states_from_episodes_to_batch": 1.2899996363557875e-05, "batch_individual_items": 7.745000038994476e-05, "add_observations_from_episodes_to_batch": 8.550000347895548e-05, "agent_to_module_mapping": 1.6500001947861165e-05, "numpy_to_tensor": 0.00011284999345662072}}, "connector_pipeline_timer": 0.0009456499974476171, "num_agent_steps_sampled": {"human_1": 4000.0, "human_2": 4000.0, "human_0": 4000.0}, "time_between_sampling": 0.5707938572647941, "env_to_module_sum_episodes_length_out": 131.6904176324108, "rlmodule_inference_timer": 0.0004164222940145658, "num_agent_steps_sampled_lifetime": {"human_1": 50000.0, "human_2": 50000.0, "human_0": 50000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5991970326153847e-05, "add_states_from_episodes_to_batch": 1.3149341118248139e-05, "batch_individual_items": 6.29950848914451e-05, "add_observations_from_episodes_to_batch": 7.899537300410164e-05, "agent_to_module_mapping": 1.3760807304413634e-05, "numpy_to_tensor": 9.409714168525365e-05}}, "connector_pipeline_timer": 0.00046113311539543135}, "num_episodes_lifetime": 15.999999999999984, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 12000.0}, "agent_episode_returns_mean": {"human_1": -4473.547131666667, "human_2": -4490.2836616666655, "human_0": -4496.713836666666}, "agent_steps": {"human_1": 2000.0, "human_2": 2000.0, "human_0": 2000.0}, "episode_return_min": -15300.670000000004, "episode_return_mean": -13460.544629999997, "env_reset_timer": 3.29158379999717, "episode_len_max": 2000, "episode_duration_sec_mean": 10.553804009995075, "num_module_steps_sampled_lifetime": {"shared_policy": 150000.0}, "sample": 2.796416947244384, "num_env_steps_sampled_lifetime": 50000.0, "episode_len_mean": 2000.0, "module_episode_returns_mean": {"shared_policy": -12366.807181666665}, "weights_seq_no": 7.0, "episode_return_max": -10270.514, "env_to_module_sum_episodes_length_in": 131.6904176324108, "num_env_steps_sampled": 4000.0, "env_step_timer": 0.0032297337716527914, "num_env_steps_sampled_lifetime_throughput": 162.14003982299295}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 4000.0, "learner_connector_sum_episodes_length_out": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 15104000, "num_module_steps_trained_lifetime": 966656, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.9193593531023546e-05, "batch_individual_items": 0.49160802305142354, "add_observations_from_episodes_to_batch": 0.0011842212356222724, "add_columns_from_episodes_to_train_batch": 0.4856033923298463, "general_advantage_estimation": 0.12224918037722393, "numpy_to_tensor": 0.0008387461895753654, "add_states_from_episodes_to_batch": 1.2521665701461792e-05, "add_one_ts_to_episodes_and_truncate": 0.04094376853369606, "agent_to_module_mapping": 0.019715911172699337}}, "connector_pipeline_timer": 1.1632727659094233}, "num_trainable_parameters": 294916, "num_env_steps_trained_lifetime_throughput": 81128.8051299399, "num_module_steps_trained_lifetime_throughput": 5192.2279457160785}, "shared_policy": {"default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 294916, "vf_loss": 9.860767364501953, "curr_kl_coeff": 0.0031250000465661287, "entropy": 1.0793945789337158, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 966656, "policy_loss": 0.030593600124120712, "num_module_steps_trained": 120832, "vf_explained_var": 0.0008993744850158691, "curr_entropy_coeff": 0.01, "total_loss": 9.880593299865723, "mean_kl_loss": 0.008537720888853073, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 8.0, "vf_loss_unclipped": 12418.15234375, "num_module_steps_trained_lifetime_throughput": 5192.229682806422}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 50000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 8, "trial_id": "fa233_00000", "date": "2026-01-15_17-09-00", "timestamp": 1768493340, "time_this_iter_s": 25.880271196365356, "time_total_s": 195.83212995529175, "pid": 39548, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000002ABA05131C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 195.83212995529175, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.1972972972973, "ram_util_percent": 40.03783783783784}}
{"timers": {"training_iteration": 24.720873021796052, "restore_env_runners": 3.427148974807042e-05, "training_step": 24.720391649493997, "env_runner_sampling_timer": 13.925491163273533, "learner_update_timer": 10.78186892922838, "synch_weights": 0.004027134170274318, "synch_env_connectors": 0.003840161637049721}, "env_runners": {"num_episodes": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.129876589666378e-05, "remove_single_ts_time_rank_from_batch": 4.319695754733649e-06, "module_to_agent_unmapping": 9.107681405625646e-06, "normalize_and_clip_actions": 0.00011812203608395984, "get_actions": 0.0003809838787580229, "tensor_to_numpy": 0.00012370757574035296, "listify_data_for_vector_env": 3.66529378936589e-05}}, "connector_pipeline_timer": 0.0009773996210742787}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0499999411404133e-05, "add_states_from_episodes_to_batch": 1.2899996363557875e-05, "batch_individual_items": 7.745000038994476e-05, "add_observations_from_episodes_to_batch": 8.550000347895548e-05, "agent_to_module_mapping": 1.6500001947861165e-05, "numpy_to_tensor": 0.00011284999345662072}}, "connector_pipeline_timer": 0.0009456499974476171, "num_agent_steps_sampled": {"human_1": 4000.0, "human_2": 4000.0, "human_0": 4000.0}, "time_between_sampling": 0.6211120568875147, "env_to_module_sum_episodes_length_out": 131.6904176324108, "rlmodule_inference_timer": 0.00036455909608326827, "num_agent_steps_sampled_lifetime": {"human_1": 54000.0, "human_2": 54000.0, "human_0": 54000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2829420407920757e-05, "add_states_from_episodes_to_batch": 1.3160397769476292e-05, "batch_individual_items": 6.0175008626648406e-05, "add_observations_from_episodes_to_batch": 7.377311247209552e-05, "agent_to_module_mapping": 1.3161617077260258e-05, "numpy_to_tensor": 8.42522272113208e-05}}, "connector_pipeline_timer": 0.0004352533092504638}, "num_episodes_lifetime": 17.999999999999986, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 12000.0}, "agent_episode_returns_mean": {"human_1": -3960.533395, "human_2": -3980.495435, "human_0": -3979.013559999999}, "agent_steps": {"human_1": 2000.0, "human_2": 2000.0, "human_0": 2000.0}, "episode_return_min": -14633.28499999999, "episode_return_mean": -11920.042389999995, "env_reset_timer": 3.29158379999717, "episode_len_max": 2000, "episode_duration_sec_mean": 11.12962041200444, "num_module_steps_sampled_lifetime": {"shared_policy": 162000.0}, "sample": 2.670086343640017, "num_env_steps_sampled_lifetime": 54000.0, "episode_len_mean": 2000.0, "module_episode_returns_mean": {"shared_policy": -10971.855588333332}, "weights_seq_no": 8.0, "episode_return_max": -10270.514, "env_to_module_sum_episodes_length_in": 131.6904176324108, "num_env_steps_sampled": 4000.0, "env_step_timer": 0.0032303869120825696, "num_env_steps_sampled_lifetime_throughput": 161.8827754231592}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 4000.0, "learner_connector_sum_episodes_length_out": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 16992000, "num_module_steps_trained_lifetime": 1087488, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.918465760168123e-05, "batch_individual_items": 0.49108159882103963, "add_observations_from_episodes_to_batch": 0.0011849060233377635, "add_columns_from_episodes_to_train_batch": 0.485320049406469, "general_advantage_estimation": 0.12210406057345144, "numpy_to_tensor": 0.0008329697276249301, "add_states_from_episodes_to_batch": 1.2513448916708833e-05, "add_one_ts_to_episodes_and_truncate": 0.04080908484834276, "agent_to_module_mapping": 0.019720942060954125}}, "connector_pipeline_timer": 1.1621765842502594}, "num_trainable_parameters": 294916, "num_env_steps_trained_lifetime_throughput": 80864.68905423385, "num_module_steps_trained_lifetime_throughput": 5175.325218973369}, "shared_policy": {"default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 294916, "vf_loss": 9.831664085388184, "curr_kl_coeff": 0.0015625000232830644, "entropy": 1.0750244855880737, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 1087488, "policy_loss": 0.02795104682445526, "num_module_steps_trained": 120832, "vf_explained_var": 0.00027686357498168945, "curr_entropy_coeff": 0.01, "total_loss": 9.84887981414795, "mean_kl_loss": 0.004751722794026136, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 9.0, "vf_loss_unclipped": 18503.162109375, "num_module_steps_trained_lifetime_throughput": 5175.327365501155}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 54000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 9, "trial_id": "fa233_00000", "date": "2026-01-15_17-09-25", "timestamp": 1768493365, "time_this_iter_s": 24.846858739852905, "time_total_s": 220.67898869514465, "pid": 39548, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000002ABA0599360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 220.67898869514465, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.082857142857144, "ram_util_percent": 39.94571428571429}}
{"timers": {"training_iteration": 24.726461076578047, "restore_env_runners": 3.41977748616203e-05, "training_step": 24.72597773999906, "env_runner_sampling_timer": 13.936134843640897, "learner_update_timer": 10.77678472493606, "synch_weights": 0.004038071828510838, "synch_env_connectors": 0.0038349520206527204}, "env_runners": {"num_episodes": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.434325267808241e-05, "remove_single_ts_time_rank_from_batch": 4.1676928921061866e-06, "module_to_agent_unmapping": 9.476172147064856e-06, "normalize_and_clip_actions": 0.00011992521936513064, "get_actions": 0.00038880050797337307, "tensor_to_numpy": 0.00012975888916921357, "listify_data_for_vector_env": 3.703125169519826e-05}}, "connector_pipeline_timer": 0.0010021590377460887}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0499999411404133e-05, "add_states_from_episodes_to_batch": 1.2899996363557875e-05, "batch_individual_items": 7.745000038994476e-05, "add_observations_from_episodes_to_batch": 8.550000347895548e-05, "agent_to_module_mapping": 1.6500001947861165e-05, "numpy_to_tensor": 0.00011284999345662072}}, "connector_pipeline_timer": 0.0009456499974476171, "num_agent_steps_sampled": {"human_1": 4000.0, "human_2": 4000.0, "human_0": 4000.0}, "time_between_sampling": 0.6610343633852948, "env_to_module_sum_episodes_length_out": 131.6904176324108, "rlmodule_inference_timer": 0.00037473178307968774, "num_agent_steps_sampled_lifetime": {"human_1": 58000.0, "human_2": 58000.0, "human_0": 58000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.258029147364242e-05, "add_states_from_episodes_to_batch": 1.3248832803104921e-05, "batch_individual_items": 5.854289117470005e-05, "add_observations_from_episodes_to_batch": 7.56280138132599e-05, "agent_to_module_mapping": 1.3096180952468136e-05, "numpy_to_tensor": 8.40741032404695e-05}}, "connector_pipeline_timer": 0.0004376282117495789}, "num_episodes_lifetime": 19.999999999999986, "episode_len_min": 2000, "num_module_steps_sampled": {"shared_policy": 12000.0}, "agent_episode_returns_mean": {"human_1": -3888.3799033333325, "human_2": -3910.428213333333, "human_0": -3915.280483333333}, "agent_steps": {"human_1": 2000.0, "human_2": 2000.0, "human_0": 2000.0}, "episode_return_min": -13790.5245, "episode_return_mean": -11714.0886, "env_reset_timer": 3.29158379999717, "episode_len_max": 2000, "episode_duration_sec_mean": 11.111710603009126, "num_module_steps_sampled_lifetime": {"shared_policy": 174000.0}, "sample": 2.5546131126887404, "num_env_steps_sampled_lifetime": 58000.0, "episode_len_mean": 2000.0, "module_episode_returns_mean": {"shared_policy": -10763.740421666664}, "weights_seq_no": 9.0, "episode_return_max": -9412.094500000003, "env_to_module_sum_episodes_length_in": 131.6904176324108, "num_env_steps_sampled": 4000.0, "env_step_timer": 0.003252917623287535, "num_env_steps_sampled_lifetime_throughput": 161.7568833800286}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 4000.0, "learner_connector_sum_episodes_length_out": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 18880000, "num_module_steps_trained_lifetime": 1208320, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.914881111707932e-05, "batch_individual_items": 0.49268133383278495, "add_observations_from_episodes_to_batch": 0.001191178962996559, "add_columns_from_episodes_to_train_batch": 0.4847879889125062, "general_advantage_estimation": 0.12194613096782919, "numpy_to_tensor": 0.0008547470302600487, "add_states_from_episodes_to_batch": 1.2505314445322556e-05, "add_one_ts_to_episodes_and_truncate": 0.040733813999753454, "agent_to_module_mapping": 0.01972455864027206}}, "connector_pipeline_timer": 1.1630374564078307}, "num_trainable_parameters": 294916, "num_env_steps_trained_lifetime_throughput": 80548.98617937173, "num_module_steps_trained_lifetime_throughput": 5155.121019512953}, "shared_policy": {"default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 294916, "vf_loss": 9.84094524383545, "curr_kl_coeff": 0.0007812500116415322, "entropy": 1.081974983215332, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 1208320, "policy_loss": -0.023728834465146065, "num_module_steps_trained": 120832, "vf_explained_var": -2.6941299438476562e-05, "curr_entropy_coeff": 0.01, "total_loss": 9.806403160095215, "mean_kl_loss": 0.003929993603378534, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 10.0, "vf_loss_unclipped": 10796.5087890625, "num_module_steps_trained_lifetime_throughput": 5155.122954152586}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 58000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": true, "training_iteration": 10, "trial_id": "fa233_00000", "date": "2026-01-15_17-09-50", "timestamp": 1768493390, "time_this_iter_s": 25.287384033203125, "time_total_s": 245.96637272834778, "pid": 39548, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000002ABA0599CF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 245.96637272834778, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.297142857142855, "ram_util_percent": 39.97714285714286}}
