{"timers": {"training_iteration": 22.261278200006927, "restore_env_runners": 2.4599998141638935e-05, "training_step": 22.260864700001548, "env_runner_sampling_timer": 11.971257700002752, "learner_update_timer": 10.279779599994072, "synch_weights": 0.004508099998929538}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.8369250311368667e-05, "un_batch_to_individual_items": 7.738003988675055e-05, "normalize_and_clip_actions": 0.00010425535994360866, "tensor_to_numpy": 0.0001123445882073196, "get_actions": 0.0004638113932806631, "remove_single_ts_time_rank_from_batch": 3.4565781950652256e-06, "module_to_agent_unmapping": 7.878251846835524e-06}}, "connector_pipeline_timer": 0.00097559798590928}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 22000.0, "human_1": 22000.0, "human_2": 22000.0}, "env_to_module_sum_episodes_length_in": 129.70023112683015, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 129.70023112683015, "episode_duration_sec_mean": 8.908766700027627, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.836981295010316e-05, "add_observations_from_episodes_to_batch": 6.421474614318372e-05, "batch_individual_items": 5.2382231449537664e-05, "add_states_from_episodes_to_batch": 1.117731418562111e-05, "add_time_dim_to_batch_and_zero_pad": 2.022217630109532e-05, "agent_to_module_mapping": 1.1367904822079219e-05}}, "connector_pipeline_timer": 0.0003733193140428875}, "module_episode_returns_mean": {"shared_policy": -13207.175333333329}, "rlmodule_inference_timer": 0.0004039249771946079, "time_between_sampling": 0.021903224493969274, "agent_episode_returns_mean": {"human_0": -4830.407166666667, "human_1": -4805.5124166666665, "human_2": -4777.286416666666}, "episode_return_min": -14740.306499999999, "episode_len_min": 2000, "episode_return_mean": -14413.205999999998, "num_episodes_lifetime": 2.0, "sample": 3.5108250607519196, "num_env_steps_sampled_lifetime": 22000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 66000.0}, "num_episodes": 2.0, "env_step_timer": 0.002068204547763218, "episode_return_max": -14086.1055, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"shared_policy": {"mean_kl_loss": 0.002373912138864398, "curr_kl_coeff": 0.10000000149011612, "policy_loss": 0.14675740897655487, "vf_loss": 9.960869789123535, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 24496.24609375, "total_loss": 10.097124099731445, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.0002040863037109375, "num_module_steps_trained": 120832, "entropy": 1.0977091789245605, "num_module_steps_trained_lifetime": 120832, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.125584199995501, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001097999993362464, "agent_to_module_mapping": 0.020665899995947257, "general_advantage_estimation": 0.11686280000139959, "add_columns_from_episodes_to_train_batch": 0.451376099998015, "batch_individual_items": 0.48958009999478236, "add_states_from_episodes_to_batch": 1.6300007700920105e-05, "add_one_ts_to_episodes_and_truncate": 0.03621569999086205, "add_time_dim_to_batch_and_zero_pad": 4.329999501351267e-05, "numpy_to_tensor": 0.008633999997982755}}}, "num_env_steps_trained_lifetime": 1888000, "learner_connector_sum_episodes_length_out": 4000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 120832, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 22000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 1, "trial_id": "76942_00000", "date": "2026-01-15_15-15-01", "timestamp": 1768486501, "time_this_iter_s": 22.268529415130615, "time_total_s": 22.268529415130615, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA01D82CB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.268529415130615, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 20.53125, "ram_util_percent": 46.021875}}
{"timers": {"training_iteration": 22.260346767006848, "restore_env_runners": 2.4566998035879806e-05, "training_step": 22.2599318950015, "env_runner_sampling_timer": 11.969144168002677, "learner_update_timer": 10.28094180799424, "synch_weights": 0.0045016349990328304, "synch_env_connectors": 0.003159200001391582}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.7282006761135055e-05, "un_batch_to_individual_items": 7.277093119671716e-05, "normalize_and_clip_actions": 9.542913916329114e-05, "tensor_to_numpy": 0.00010510993116718817, "get_actions": 0.0003257956236361611, "remove_single_ts_time_rank_from_batch": 3.2673320618417604e-06, "module_to_agent_unmapping": 7.214403655921622e-06}}, "connector_pipeline_timer": 0.0008111779019193582}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 26000.0, "human_1": 26000.0, "human_2": 26000.0}, "env_to_module_sum_episodes_length_in": 131.69041762873871, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.69041762873871, "episode_duration_sec_mean": 8.881764386387657, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.448459532414442e-05, "add_observations_from_episodes_to_batch": 6.139075476573354e-05, "batch_individual_items": 4.9335122572465125e-05, "add_states_from_episodes_to_batch": 9.708046994935466e-06, "add_time_dim_to_batch_and_zero_pad": 1.9955924386062678e-05, "agent_to_module_mapping": 1.0589027749531912e-05}}, "connector_pipeline_timer": 0.00035353144923929764}, "module_episode_returns_mean": {"shared_policy": -13107.063727272722}, "rlmodule_inference_timer": 0.0003180204676579612, "time_between_sampling": 0.12094455287752177, "agent_episode_returns_mean": {"human_0": -4788.713606060608, "human_1": -4763.989196969695, "human_2": -4736.271765151513}, "episode_return_min": -14800.686499999998, "episode_len_min": 2000, "episode_return_mean": -14288.974568181822, "num_episodes_lifetime": 4.000000000000002, "sample": 3.2858054913530723, "num_env_steps_sampled_lifetime": 26000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 78000.0}, "num_episodes": 2.0, "env_step_timer": 0.0024330747257501196, "episode_return_max": -11292.634, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime_throughput": 181.01744948482195}, "learners": {"shared_policy": {"mean_kl_loss": 0.006709791719913483, "curr_kl_coeff": 0.10000000149011612, "policy_loss": 0.08614717423915863, "vf_loss": 9.915226936340332, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 19571.89453125, "total_loss": 9.99112319946289, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.0004366636276245117, "num_module_steps_trained": 120832, "entropy": 1.0922234058380127, "num_module_steps_trained_lifetime": 241664, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1273775049955292, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010981509933480993, "agent_to_module_mapping": 0.020669861995993417, "general_advantage_estimation": 0.11686133600131143, "add_columns_from_episodes_to_train_batch": 0.45163326799796777, "batch_individual_items": 0.4912151109948172, "add_states_from_episodes_to_batch": 1.629300764761865e-05, "add_one_ts_to_episodes_and_truncate": 0.036203482990822516, "add_time_dim_to_batch_and_zero_pad": 4.3306995066814125e-05, "numpy_to_tensor": 0.008550109998031985}}}, "num_env_steps_trained_lifetime": 3776000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 241664, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 26000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 2, "trial_id": "76942_00000", "date": "2026-01-15_15-15-23", "timestamp": 1768486523, "time_this_iter_s": 22.17522168159485, "time_total_s": 44.443751096725464, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0173E950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.443751096725464, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.283870967741933, "ram_util_percent": 46.14516129032259}}
{"timers": {"training_iteration": 22.257199187336717, "restore_env_runners": 2.45893280589371e-05, "training_step": 22.256780526051518, "env_runner_sampling_timer": 11.967066999322576, "learner_update_timer": 10.27985041791433, "synch_weights": 0.004492032649055181, "synch_env_connectors": 0.003162263001286192}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.72433142136864e-05, "un_batch_to_individual_items": 7.316464086947128e-05, "normalize_and_clip_actions": 9.542817139764377e-05, "tensor_to_numpy": 0.00010546706756307219, "get_actions": 0.0003238937419744456, "remove_single_ts_time_rank_from_batch": 3.5180936076817425e-06, "module_to_agent_unmapping": 7.346802606428873e-06}}, "connector_pipeline_timer": 0.000806500327816682}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 30000.0, "human_1": 30000.0, "human_2": 30000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 8.755348295245009, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.449108701846416e-05, "add_observations_from_episodes_to_batch": 6.163018627217124e-05, "batch_individual_items": 4.862393527463904e-05, "add_states_from_episodes_to_batch": 9.863168169904773e-06, "add_time_dim_to_batch_and_zero_pad": 1.928974982009829e-05, "agent_to_module_mapping": 1.0847354904178768e-05}}, "connector_pipeline_timer": 0.0003547591344405579}, "module_episode_returns_mean": {"shared_policy": -12669.372686507933}, "rlmodule_inference_timer": 0.0003177567949101621, "time_between_sampling": 0.21177610167348634, "agent_episode_returns_mean": {"human_0": -4606.1594642857135, "human_1": -4582.307404761904, "human_2": -4557.436571428571}, "episode_return_min": -14830.715000000002, "episode_len_min": 2000, "episode_return_mean": -13745.90344047619, "num_episodes_lifetime": 6.0000000000000036, "sample": 3.081141001721609, "num_env_steps_sampled_lifetime": 30000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 90000.0}, "num_episodes": 2.0, "env_step_timer": 0.0024427239272929906, "episode_return_max": -11292.634, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime_throughput": 180.971739882075}, "learners": {"shared_policy": {"mean_kl_loss": 0.0024162183981388807, "curr_kl_coeff": 0.05000000074505806, "policy_loss": -0.005301111377775669, "vf_loss": 9.889467239379883, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 21148.7734375, "total_loss": 9.873540878295898, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.00021642446517944336, "num_module_steps_trained": 120832, "entropy": 1.0866323709487915, "num_module_steps_trained_lifetime": 362496, "num_module_steps_trained_lifetime_throughput": 5496.078660771131}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.12712234094561, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001098553483368596, "agent_to_module_mapping": 0.020665148376055004, "general_advantage_estimation": 0.11681658264123253, "add_columns_from_episodes_to_train_batch": 0.4516424113179688, "batch_individual_items": 0.49114537888492044, "add_states_from_episodes_to_batch": 1.6241077543236317e-05, "add_one_ts_to_episodes_and_truncate": 0.0361467521608356, "add_time_dim_to_batch_and_zero_pad": 4.319492508657277e-05, "numpy_to_tensor": 0.008467045898127254}}}, "num_env_steps_trained_lifetime": 5664000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 362496, "num_env_steps_trained_lifetime_throughput": 85876.30563423787, "num_module_steps_trained_lifetime_throughput": 5496.08136067114}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 3, "trial_id": "76942_00000", "date": "2026-01-15_15-15-45", "timestamp": 1768486545, "time_this_iter_s": 21.952953338623047, "time_total_s": 66.39670443534851, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0173F520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.39670443534851, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.045161290322582, "ram_util_percent": 46.17419354838711}}
{"timers": {"training_iteration": 22.25977475146336, "restore_env_runners": 2.4607434751305845e-05, "training_step": 22.259352713791053, "env_runner_sampling_timer": 11.966134600329388, "learner_update_timer": 10.283276635735085, "synch_weights": 0.004496814322524864, "synch_env_connectors": 0.0031660783713232375}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.7483631611729174e-05, "un_batch_to_individual_items": 7.407952635670786e-05, "normalize_and_clip_actions": 9.734845871183531e-05, "tensor_to_numpy": 0.00010728851458639175, "get_actions": 0.0003267364154238433, "remove_single_ts_time_rank_from_batch": 3.358490549092786e-06, "module_to_agent_unmapping": 7.755831888832266e-06}}, "connector_pipeline_timer": 0.0008172233842936225}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 34000.0, "human_1": 34000.0, "human_2": 34000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 8.688899612996902, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.552247738637271e-05, "add_observations_from_episodes_to_batch": 6.310431348091268e-05, "batch_individual_items": 5.0363815146883145e-05, "add_states_from_episodes_to_batch": 9.903377858518397e-06, "add_time_dim_to_batch_and_zero_pad": 1.955782060826075e-05, "agent_to_module_mapping": 1.0665982779081496e-05}}, "connector_pipeline_timer": 0.0003630521603760237}, "module_episode_returns_mean": {"shared_policy": -12641.209853333332}, "rlmodule_inference_timer": 0.00031938986883491417, "time_between_sampling": 0.29175390929931627, "agent_episode_returns_mean": {"human_0": -4592.833519999999, "human_1": -4571.3702650000005, "human_2": -4551.94825}, "episode_return_min": -14830.715000000002, "episode_len_min": 2000, "episode_return_mean": -13716.152034999994, "num_episodes_lifetime": 8.000000000000004, "sample": 2.8971678081386205, "num_env_steps_sampled_lifetime": 34000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 102000.0}, "num_episodes": 2.0, "env_step_timer": 0.0024555174878887285, "episode_return_max": -11292.634, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime_throughput": 180.97410941115726}, "learners": {"shared_policy": {"mean_kl_loss": 0.002263330854475498, "curr_kl_coeff": 0.02500000037252903, "policy_loss": 0.02694096975028515, "vf_loss": 9.92434310913086, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 19702.62890625, "total_loss": 9.940539360046387, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.000728607177734375, "num_module_steps_trained": 120832, "entropy": 1.0859348773956299, "num_module_steps_trained_lifetime": 483328, "num_module_steps_trained_lifetime_throughput": 5489.219664178723}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1286723485361336, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001098554948521836, "agent_to_module_mapping": 0.020692814892296983, "general_advantage_estimation": 0.1167212198148084, "add_columns_from_episodes_to_train_batch": 0.4517484892047729, "batch_individual_items": 0.492815407096109, "add_states_from_episodes_to_batch": 1.618466670182534e-05, "add_one_ts_to_episodes_and_truncate": 0.036076719639335564, "add_time_dim_to_batch_and_zero_pad": 4.311897592712194e-05, "numpy_to_tensor": 0.008384857439273183}}}, "num_env_steps_trained_lifetime": 7552000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 483328, "num_env_steps_trained_lifetime_throughput": 85769.13523918041, "num_module_steps_trained_lifetime_throughput": 5489.222180362125}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 34000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 4, "trial_id": "76942_00000", "date": "2026-01-15_15-16-08", "timestamp": 1768486568, "time_this_iter_s": 22.523898601531982, "time_total_s": 88.9206030368805, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0173F1C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 88.9206030368805, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.170967741935485, "ram_util_percent": 46.087096774193526}}
{"timers": {"training_iteration": 22.25949327394874, "restore_env_runners": 2.4587360378438463e-05, "training_step": 22.259069881653193, "env_runner_sampling_timer": 11.966354335326152, "learner_update_timer": 10.282733986377819, "synch_weights": 0.004497056179252546, "synch_env_connectors": 0.003178749587716811}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.7912835186507182e-05, "un_batch_to_individual_items": 7.422364606587923e-05, "normalize_and_clip_actions": 9.786712936608425e-05, "tensor_to_numpy": 0.00010681373521313359, "get_actions": 0.00033431921617635733, "remove_single_ts_time_rank_from_batch": 3.3624432964157442e-06, "module_to_agent_unmapping": 7.696883454734575e-06}}, "connector_pipeline_timer": 0.0008289142764572943}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 38000.0, "human_1": 38000.0, "human_2": 38000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 8.693298313001867, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.82278663246471e-05, "add_observations_from_episodes_to_batch": 6.270110414744107e-05, "batch_individual_items": 5.141426207793419e-05, "add_states_from_episodes_to_batch": 1.0424785276434616e-05, "add_time_dim_to_batch_and_zero_pad": 2.002005669239143e-05, "agent_to_module_mapping": 1.11621827570908e-05}}, "connector_pipeline_timer": 0.0003694062211651877}, "module_episode_returns_mean": {"shared_policy": -12528.394314999994}, "rlmodule_inference_timer": 0.000333306629219109, "time_between_sampling": 0.3683700521816885, "agent_episode_returns_mean": {"human_0": -4551.478208333332, "human_1": -4542.713343333334, "human_2": -4529.310528333333}, "episode_return_min": -14830.715000000002, "episode_len_min": 2000, "episode_return_mean": -13623.502079999997, "num_episodes_lifetime": 9.999999999999991, "sample": 2.7319321079038534, "num_env_steps_sampled_lifetime": 38000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 114000.0}, "num_episodes": 2.0, "env_step_timer": 0.002488810890871491, "episode_return_max": -11292.634, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime_throughput": 180.74739597754535}, "learners": {"shared_policy": {"mean_kl_loss": 0.002222376875579357, "curr_kl_coeff": 0.012500000186264515, "policy_loss": -0.04596541449427605, "vf_loss": 9.936277389526367, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 19318.26953125, "total_loss": 9.879502296447754, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.00021308660507202148, "num_module_steps_trained": 120832, "entropy": 1.0864607095718384, "num_module_steps_trained_lifetime": 604160, "num_module_steps_trained_lifetime_throughput": 5485.960979843967}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1280271640508344, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011011143990018513, "agent_to_module_mapping": 0.020673097743385316, "general_advantage_estimation": 0.11661770361671596, "add_columns_from_episodes_to_train_batch": 0.4515715273127168, "batch_individual_items": 0.4926279770251509, "add_states_from_episodes_to_batch": 1.615982005935861e-05, "add_one_ts_to_episodes_and_truncate": 0.03600311344295695, "add_time_dim_to_batch_and_zero_pad": 4.308978617297486e-05, "numpy_to_tensor": 0.008303748864934924}}}, "num_env_steps_trained_lifetime": 9440000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 604160, "num_env_steps_trained_lifetime_throughput": 85718.2106878522, "num_module_steps_trained_lifetime_throughput": 5485.963502915082}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 38000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 5, "trial_id": "76942_00000", "date": "2026-01-15_15-16-30", "timestamp": 1768486590, "time_this_iter_s": 22.239968061447144, "time_total_s": 111.16057109832764, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA01789EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.16057109832764, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.44193548387096, "ram_util_percent": 46.10645161290321}}
{"timers": {"training_iteration": 22.258927246209296, "restore_env_runners": 2.455948683390296e-05, "training_step": 22.258502589836603, "env_runner_sampling_timer": 11.963488360972935, "learner_update_timer": 10.285023609514077, "synch_weights": 0.0044901726174535585, "synch_env_connectors": 0.00318061709184619}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.7435984415445136e-05, "un_batch_to_individual_items": 7.544988719260682e-05, "normalize_and_clip_actions": 9.762597794391892e-05, "tensor_to_numpy": 0.00011048738337467185, "get_actions": 0.00033286026422114397, "remove_single_ts_time_rank_from_batch": 3.4209611058809793e-06, "module_to_agent_unmapping": 7.5499668384501175e-06}}, "connector_pipeline_timer": 0.0008292141400222169}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 42000.0, "human_1": 42000.0, "human_2": 42000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 8.772851458005753, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.725979000134136e-05, "add_observations_from_episodes_to_batch": 6.695177590062349e-05, "batch_individual_items": 5.0740796084640394e-05, "add_states_from_episodes_to_batch": 1.0258594237699907e-05, "add_time_dim_to_batch_and_zero_pad": 2.0651728505026848e-05, "agent_to_module_mapping": 1.1097753137903239e-05}}, "connector_pipeline_timer": 0.00037104383384198487}, "module_episode_returns_mean": {"shared_policy": -12481.454235000001}, "rlmodule_inference_timer": 0.00033072208772732024, "time_between_sampling": 0.4340106005069478, "agent_episode_returns_mean": {"human_0": -4553.739733333333, "human_1": -4544.421858333333, "human_2": -4523.942913333332}, "episode_return_min": -14830.715000000002, "episode_len_min": 2000, "episode_return_mean": -13622.104504999998, "num_episodes_lifetime": 11.999999999999991, "sample": 2.581274202779522, "num_env_steps_sampled_lifetime": 42000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 126000.0}, "num_episodes": 2.0, "env_step_timer": 0.002436820423388514, "episode_return_max": -10516.032, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime_throughput": 180.81538414825658}, "learners": {"shared_policy": {"mean_kl_loss": 0.007101996801793575, "curr_kl_coeff": 0.012500000186264515, "policy_loss": 0.10881666839122772, "vf_loss": 9.932106018066406, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 17100.947265625, "total_loss": 10.030298233032227, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.0002149343490600586, "num_module_steps_trained": 120832, "entropy": 1.0712943077087402, "num_module_steps_trained_lifetime": 724992, "num_module_steps_trained_lifetime_throughput": 5483.2172541127475}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1295089014103243, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001104881254906992, "agent_to_module_mapping": 0.020677093766036634, "general_advantage_estimation": 0.1167502615805673, "add_columns_from_episodes_to_train_batch": 0.45140712403966127, "batch_individual_items": 0.49428169825486507, "add_states_from_episodes_to_batch": 1.6122221784328135e-05, "add_one_ts_to_episodes_and_truncate": 0.03594118430846983, "add_time_dim_to_batch_and_zero_pad": 4.313488829776515e-05, "numpy_to_tensor": 0.00822340737615053}}}, "num_env_steps_trained_lifetime": 11328000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 724992, "num_env_steps_trained_lifetime_throughput": 85675.33271643259, "num_module_steps_trained_lifetime_throughput": 5483.2195607086105}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 42000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 6, "trial_id": "76942_00000", "date": "2026-01-15_15-16-52", "timestamp": 1768486612, "time_this_iter_s": 22.21066188812256, "time_total_s": 133.3712329864502, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0178A8C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 133.3712329864502, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.125, "ram_util_percent": 46.103125000000006}}
{"timers": {"training_iteration": 22.263619421747197, "restore_env_runners": 2.454789200112555e-05, "training_step": 22.26319079293822, "env_runner_sampling_timer": 11.962791573363262, "learner_update_timer": 10.290332793418948, "synch_weights": 0.004488491891220719, "synch_env_connectors": 0.0031802579208561766}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.7496897429058793e-05, "un_batch_to_individual_items": 7.497527281947522e-05, "normalize_and_clip_actions": 9.608025447484651e-05, "tensor_to_numpy": 0.00010749989478623254, "get_actions": 0.0003313832508708715, "remove_single_ts_time_rank_from_batch": 3.3873058929896063e-06, "module_to_agent_unmapping": 7.6284945977795215e-06}}, "connector_pipeline_timer": 0.0008239144064905101}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 46000.0, "human_1": 46000.0, "human_2": 46000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 8.805858775007366, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.532520864819987e-05, "add_observations_from_episodes_to_batch": 6.364604435381142e-05, "batch_individual_items": 5.0830537186191105e-05, "add_states_from_episodes_to_batch": 1.0387791137219452e-05, "add_time_dim_to_batch_and_zero_pad": 2.0207335684451093e-05, "agent_to_module_mapping": 1.1196885097918908e-05}}, "connector_pipeline_timer": 0.0003673648119949967}, "module_episode_returns_mean": {"shared_policy": -11715.776324999999}, "rlmodule_inference_timer": 0.0003241129976909898, "time_between_sampling": 0.4960468334518787, "agent_episode_returns_mean": {"human_0": -4265.623456666665, "human_1": -4257.106806666667, "human_2": -4238.959931666666}, "episode_return_min": -14033.2065, "episode_len_min": 2000, "episode_return_mean": -12761.690195, "num_episodes_lifetime": 13.999999999999984, "sample": 2.444919979443658, "num_env_steps_sampled_lifetime": 46000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 138000.0}, "num_episodes": 2.0, "env_step_timer": 0.002477155958280147, "episode_return_max": -9835.734499999995, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime_throughput": 180.6808733690883}, "learners": {"shared_policy": {"mean_kl_loss": 0.005188764538615942, "curr_kl_coeff": 0.012500000186264515, "policy_loss": 0.03123234212398529, "vf_loss": 9.866578102111816, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 12049.1904296875, "total_loss": 9.887027740478516, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 5.1140785217285156e-05, "num_module_steps_trained": 120832, "entropy": 1.0847091674804688, "num_module_steps_trained_lifetime": 845824, "num_module_steps_trained_lifetime_throughput": 5474.505900136828}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1292788203960806, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011046754424125145, "agent_to_module_mapping": 0.02067616682838725, "general_advantage_estimation": 0.1166859939648076, "add_columns_from_episodes_to_train_batch": 0.45150344079926563, "batch_individual_items": 0.49414696527242213, "add_states_from_episodes_to_batch": 1.6071999538578705e-05, "add_one_ts_to_episodes_and_truncate": 0.03590079046539437, "add_time_dim_to_batch_and_zero_pad": 4.305453946812993e-05, "numpy_to_tensor": 0.008143646302447695}}}, "num_env_steps_trained_lifetime": 13216000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 845824, "num_env_steps_trained_lifetime_throughput": 85539.21788007638, "num_module_steps_trained_lifetime_throughput": 5474.507935118209}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 46000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 7, "trial_id": "76942_00000", "date": "2026-01-15_15-17-15", "timestamp": 1768486635, "time_this_iter_s": 22.737568140029907, "time_total_s": 156.1088011264801, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0178B640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 156.1088011264801, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.89375, "ram_util_percent": 46.121875}}
{"timers": {"training_iteration": 22.269375122529674, "restore_env_runners": 2.4602413037155872e-05, "training_step": 22.268943628008753, "env_runner_sampling_timer": 11.966848387629724, "learner_update_timer": 10.292007960484781, "synch_weights": 0.004485426972350719, "synch_env_connectors": 0.0031889923416702107}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.8219707312568045e-05, "un_batch_to_individual_items": 7.739221823697411e-05, "normalize_and_clip_actions": 0.0001026028365654185, "tensor_to_numpy": 0.00011405729157476689, "get_actions": 0.00035246492684769254, "remove_single_ts_time_rank_from_batch": 3.6725784190139675e-06, "module_to_agent_unmapping": 7.765378159009523e-06}}, "connector_pipeline_timer": 0.0008669421545768675}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 50000.0, "human_1": 50000.0, "human_2": 50000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 8.789332432007798, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.290170143202477e-05, "add_observations_from_episodes_to_batch": 6.620131333738167e-05, "batch_individual_items": 5.389463688264811e-05, "add_states_from_episodes_to_batch": 1.0446546758511008e-05, "add_time_dim_to_batch_and_zero_pad": 2.1554129491628853e-05, "agent_to_module_mapping": 1.1840680829850002e-05}}, "connector_pipeline_timer": 0.0003840408199664549}, "module_episode_returns_mean": {"shared_policy": -10608.078044999998}, "rlmodule_inference_timer": 0.00035374681336406116, "time_between_sampling": 0.5554938830794208, "agent_episode_returns_mean": {"human_0": -3855.5003433333327, "human_1": -3849.6694033333333, "human_2": -3828.6134033333324}, "episode_return_min": -13851.739499999996, "episode_len_min": 2000, "episode_return_mean": -11533.783149999997, "num_episodes_lifetime": 15.999999999999984, "sample": 2.325118771177741, "num_env_steps_sampled_lifetime": 50000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 150000.0}, "num_episodes": 2.0, "env_step_timer": 0.002540523961892854, "episode_return_max": -9835.734499999995, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime_throughput": 180.24942598225914}, "learners": {"shared_policy": {"mean_kl_loss": 0.004201557952910662, "curr_kl_coeff": 0.0062500000931322575, "policy_loss": 0.02251577004790306, "vf_loss": 9.923306465148926, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 15065.3369140625, "total_loss": 9.934986114501953, "weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 2.855062484741211e-05, "num_module_steps_trained": 120832, "entropy": 1.088787317276001, "num_module_steps_trained_lifetime": 966656, "num_module_steps_trained_lifetime_throughput": 5464.709446915702}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1309510561921243, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011046116879448575, "agent_to_module_mapping": 0.02067587716009413, "general_advantage_estimation": 0.11668179202511697, "add_columns_from_episodes_to_train_batch": 0.45164168339130695, "batch_individual_items": 0.4958335206196524, "add_states_from_episodes_to_batch": 1.6020279645576934e-05, "add_one_ts_to_episodes_and_truncate": 0.03583689556076966, "add_time_dim_to_batch_and_zero_pad": 4.297099409633309e-05, "numpy_to_tensor": 0.008065477839423607}}}, "num_env_steps_trained_lifetime": 15104000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 966656, "num_env_steps_trained_lifetime_throughput": 85386.14205835601, "num_module_steps_trained_lifetime_throughput": 5464.7115450241545}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 50000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 8, "trial_id": "76942_00000", "date": "2026-01-15_15-17-38", "timestamp": 1768486658, "time_this_iter_s": 22.847118854522705, "time_total_s": 178.9559199810028, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0178B9A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 178.9559199810028, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.303125, "ram_util_percent": 46.140625}}
{"timers": {"training_iteration": 22.323214714304424, "restore_env_runners": 2.4570388790056065e-05, "training_step": 22.322781602728654, "env_runner_sampling_timer": 12.004486306753392, "learner_update_timer": 10.308159564880016, "synch_weights": 0.004485231702604613, "synch_env_connectors": 0.0031902464182980666}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.932232830327591e-05, "un_batch_to_individual_items": 0.00010110791259771562, "normalize_and_clip_actions": 0.0001345716752015069, "tensor_to_numpy": 0.00014428114322370518, "get_actions": 0.0004650523911259313, "remove_single_ts_time_rank_from_batch": 4.968062394621688e-06, "module_to_agent_unmapping": 1.040927496579108e-05}}, "connector_pipeline_timer": 0.0011436717969562974}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 54000.0, "human_1": 54000.0, "human_2": 54000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 9.016443479019507, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011090412143924834, "add_observations_from_episodes_to_batch": 8.86136725901257e-05, "batch_individual_items": 7.23685917991297e-05, "add_states_from_episodes_to_batch": 1.3765708688981239e-05, "add_time_dim_to_batch_and_zero_pad": 2.885477188149161e-05, "agent_to_module_mapping": 1.5080262388329476e-05}}, "connector_pipeline_timer": 0.0005119463493721088}, "module_episode_returns_mean": {"shared_policy": -10331.148193333333}, "rlmodule_inference_timer": 0.00047208349804324704, "time_between_sampling": 0.6060687264821154, "agent_episode_returns_mean": {"human_0": -3746.209685, "human_1": -3737.042514999999, "human_2": -3722.0051249999997}, "episode_return_min": -13744.388499999995, "episode_len_min": 2000, "episode_return_mean": -11205.257324999999, "num_episodes_lifetime": 17.999999999999986, "sample": 2.2351534522908367, "num_env_steps_sampled_lifetime": 54000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 162000.0}, "num_episodes": 2.0, "env_step_timer": 0.003299009334602749, "episode_return_max": -9835.734499999995, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime_throughput": 178.85726512552225}, "learners": {"shared_policy": {"mean_kl_loss": 0.0037585310637950897, "curr_kl_coeff": 0.0031250000465661287, "policy_loss": -0.02802683226764202, "vf_loss": 9.81473445892334, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 18241.052734375, "total_loss": 9.77590560913086, "weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.0003401637077331543, "num_module_steps_trained": 120832, "entropy": 1.082511067390442, "num_module_steps_trained_lifetime": 1087488, "num_module_steps_trained_lifetime_throughput": 5409.618637100336}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1326756356302041, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011093775711214391, "agent_to_module_mapping": 0.020761256388424774, "general_advantage_estimation": 0.11674843610481138, "add_columns_from_episodes_to_train_batch": 0.45280913655746013, "batch_individual_items": 0.49627838741347174, "add_states_from_episodes_to_batch": 1.5975076851672987e-05, "add_one_ts_to_episodes_and_truncate": 0.0358757576052592, "add_time_dim_to_batch_and_zero_pad": 4.287928410972378e-05, "numpy_to_tensor": 0.007987533061000928}}}, "num_env_steps_trained_lifetime": 16992000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 1087488, "num_env_steps_trained_lifetime_throughput": 84525.45328146032, "num_module_steps_trained_lifetime_throughput": 5409.6241567014185}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 54000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 9, "trial_id": "76942_00000", "date": "2026-01-15_15-18-05", "timestamp": 1768486685, "time_this_iter_s": 27.662971019744873, "time_total_s": 206.61889100074768, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA01D83910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 206.61889100074768, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.6921052631579, "ram_util_percent": 46.06315789473685}}
{"timers": {"training_iteration": 22.385579605161357, "restore_env_runners": 2.4681684855665745e-05, "training_step": 22.38514273670146, "env_runner_sampling_timer": 12.04658381468594, "learner_update_timer": 10.32834811323134, "synch_weights": 0.0044832513854821485, "synch_env_connectors": 0.0031986779540471313}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.7892760898629676e-05, "un_batch_to_individual_items": 9.895750887063128e-05, "normalize_and_clip_actions": 0.00012741016129607706, "tensor_to_numpy": 0.00013583214013115818, "get_actions": 0.00042999887633482536, "remove_single_ts_time_rank_from_batch": 4.602667181308284e-06, "module_to_agent_unmapping": 9.599561667500355e-06}}, "connector_pipeline_timer": 0.0010746130989528395}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 58000.0, "human_1": 58000.0, "human_2": 58000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 10.39094342101991, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.93399799895209e-05, "add_observations_from_episodes_to_batch": 8.303531752970543e-05, "batch_individual_items": 6.724244462014636e-05, "add_states_from_episodes_to_batch": 1.4312355483213766e-05, "add_time_dim_to_batch_and_zero_pad": 2.6055343140772097e-05, "agent_to_module_mapping": 1.4936483552892203e-05}}, "connector_pipeline_timer": 0.0004855122541107024}, "module_episode_returns_mean": {"shared_policy": -11005.085248333335}, "rlmodule_inference_timer": 0.00042881161418553053, "time_between_sampling": 0.665977446583083, "agent_episode_returns_mean": {"human_0": -4002.887121666667, "human_1": -3993.1470066666657, "human_2": -3987.954826666666}, "episode_return_min": -13744.388499999995, "episode_len_min": 2000, "episode_return_mean": -11983.988954999999, "num_episodes_lifetime": 19.999999999999986, "sample": 2.175418249875229, "num_env_steps_sampled_lifetime": 58000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 174000.0}, "num_episodes": 2.0, "env_step_timer": 0.003455306317023185, "episode_return_max": -9835.734499999995, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime_throughput": 177.00814985617416}, "learners": {"shared_policy": {"mean_kl_loss": 0.0025791299995034933, "curr_kl_coeff": 0.0015625000232830644, "policy_loss": -0.11749038845300674, "vf_loss": 9.919431686401367, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 16664.638671875, "total_loss": 9.791070938110352, "weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.0017580986022949219, "num_module_steps_trained": 120832, "entropy": 1.0878134965896606, "num_module_steps_trained_lifetime": 1208320, "num_module_steps_trained_lifetime_throughput": 5350.280463034598}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1352838122738844, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011103167953583574, "agent_to_module_mapping": 0.02078121682455156, "general_advantage_estimation": 0.11684780374373481, "add_columns_from_episodes_to_train_batch": 0.45327764219187583, "batch_individual_items": 0.498420616539301, "add_states_from_episodes_to_batch": 1.5928326070479093e-05, "add_one_ts_to_episodes_and_truncate": 0.03583465802919199, "add_time_dim_to_batch_and_zero_pad": 4.2792491253438535e-05, "numpy_to_tensor": 0.007910493730448788}}}, "num_env_steps_trained_lifetime": 18880000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 1208320, "num_env_steps_trained_lifetime_throughput": 83598.24768735163, "num_module_steps_trained_lifetime_throughput": 5350.282588315439}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 58000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 10, "trial_id": "76942_00000", "date": "2026-01-15_15-18-34", "timestamp": 1768486714, "time_this_iter_s": 28.57138705253601, "time_total_s": 235.1902780532837, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0173EE60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 235.1902780532837, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 26.085, "ram_util_percent": 46.095}}
{"timers": {"training_iteration": 22.446970615109812, "restore_env_runners": 2.471586796399444e-05, "training_step": 22.446531380334452, "env_runner_sampling_timer": 12.093309432539082, "learner_update_timer": 10.342952952099083, "synch_weights": 0.0044864258716322, "synch_env_connectors": 0.0032111971744831964}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 4.041481248811262e-05, "un_batch_to_individual_items": 0.00010243410011118687, "normalize_and_clip_actions": 0.00013256787910557468, "tensor_to_numpy": 0.00014656778245793008, "get_actions": 0.0004728149359029513, "remove_single_ts_time_rank_from_batch": 4.91100396223306e-06, "module_to_agent_unmapping": 1.0216766937854406e-05}}, "connector_pipeline_timer": 0.0011507016305613296}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 62000.0, "human_1": 62000.0, "human_2": 62000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.56028798701227, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001142914385326032, "add_observations_from_episodes_to_batch": 8.960780939861542e-05, "batch_individual_items": 7.318692236411717e-05, "add_states_from_episodes_to_batch": 1.4627109083427293e-05, "add_time_dim_to_batch_and_zero_pad": 3.152955875486238e-05, "agent_to_module_mapping": 1.5537484312018414e-05}}, "connector_pipeline_timer": 0.0005253907024507895}, "module_episode_returns_mean": {"shared_policy": -11729.532323333333}, "rlmodule_inference_timer": 0.0004863681558455157, "time_between_sampling": 0.72483438064209, "agent_episode_returns_mean": {"human_0": -4270.490304999999, "human_1": -4266.712174999999, "human_2": -4259.490604999999}, "episode_return_min": -13744.388499999995, "episode_len_min": 2000, "episode_return_mean": -12796.693084999995, "num_episodes_lifetime": 21.999999999999986, "sample": 2.1226770619453506, "num_env_steps_sampled_lifetime": 62000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 186000.0}, "num_episodes": 2.0, "env_step_timer": 0.003479314957860309, "episode_return_max": -10233.268, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime_throughput": 175.00154095519173}, "learners": {"shared_policy": {"mean_kl_loss": 0.005249361973255873, "curr_kl_coeff": 0.0015625000232830644, "policy_loss": 0.004633178934454918, "vf_loss": 9.963065147399902, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 17492.56640625, "total_loss": 9.956865310668945, "weights_seq_no": 11.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.0002357959747314453, "num_module_steps_trained": 120832, "entropy": 1.0841296911239624, "num_module_steps_trained_lifetime": 1329152, "num_module_steps_trained_lifetime_throughput": 5293.387356592527}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.135781539151059, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011109286274053234, "agent_to_module_mapping": 0.02082497465627002, "general_advantage_estimation": 0.11672747370627004, "add_columns_from_episodes_to_train_batch": 0.4540212907700044, "batch_individual_items": 0.49834514637383276, "add_states_from_episodes_to_batch": 1.5958042793722025e-05, "add_one_ts_to_episodes_and_truncate": 0.035821607448914126, "add_time_dim_to_batch_and_zero_pad": 4.3033566341829884e-05, "numpy_to_tensor": 0.0078338197931742}}}, "num_env_steps_trained_lifetime": 20768000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 1329152, "num_env_steps_trained_lifetime_throughput": 82709.34234629266, "num_module_steps_trained_lifetime_throughput": 5293.391350792601}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 62000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 11, "trial_id": "76942_00000", "date": "2026-01-15_15-19-03", "timestamp": 1768486743, "time_this_iter_s": 28.53476595878601, "time_total_s": 263.7250440120697, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0173D510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 263.7250440120697, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.21951219512195, "ram_util_percent": 46.178048780487806}}
{"timers": {"training_iteration": 22.5069579939586, "restore_env_runners": 2.469070937406135e-05, "training_step": 22.50651749953103, "env_runner_sampling_timer": 12.139916299213693, "learner_update_timer": 10.356291235578134, "synch_weights": 0.004485452612866114, "synch_env_connectors": 0.0032164362028028826}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.967244179277059e-05, "un_batch_to_individual_items": 0.00010102968635663958, "normalize_and_clip_actions": 0.0001362869901424884, "tensor_to_numpy": 0.00014665943229267458, "get_actions": 0.0004861305107103682, "remove_single_ts_time_rank_from_batch": 5.022030744115592e-06, "module_to_agent_unmapping": 1.0253404743009643e-05}}, "connector_pipeline_timer": 0.0011681474079611503}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 66000.0, "human_1": 66000.0, "human_2": 66000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.200721795999124, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011738410571034723, "add_observations_from_episodes_to_batch": 8.982868582375532e-05, "batch_individual_items": 7.468370989956265e-05, "add_states_from_episodes_to_batch": 1.4350512113331538e-05, "add_time_dim_to_batch_and_zero_pad": 2.9856422177478757e-05, "agent_to_module_mapping": 1.5049432339833338e-05}}, "connector_pipeline_timer": 0.0005301130186521529}, "module_episode_returns_mean": {"shared_policy": -11998.037569999997}, "rlmodule_inference_timer": 0.0004687416598220534, "time_between_sampling": 0.7716868849010095, "agent_episode_returns_mean": {"human_0": -4370.908581666667, "human_1": -4367.947131666666, "human_2": -4360.978596666665}, "episode_return_min": -14140.731, "episode_len_min": 2000, "episode_return_mean": -13099.834309999998, "num_episodes_lifetime": 23.999999999999986, "sample": 2.0757938506904408, "num_env_steps_sampled_lifetime": 66000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 198000.0}, "num_episodes": 2.0, "env_step_timer": 0.003463292147408193, "episode_return_max": -12157.7295, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime_throughput": 173.24119574672082}, "learners": {"shared_policy": {"mean_kl_loss": 0.0023467775899916887, "curr_kl_coeff": 0.0007812500116415322, "policy_loss": -0.09404943883419037, "vf_loss": 9.817755699157715, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 17773.876953125, "total_loss": 9.712837219238281, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 3.6597251892089844e-05, "num_module_steps_trained": 120832, "entropy": 1.087201476097107, "num_module_steps_trained_lifetime": 1449984, "num_module_steps_trained_lifetime_throughput": 5240.688979598189}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1367888087594589, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011159023410680408, "agent_to_module_mapping": 0.020890148909750043, "general_advantage_estimation": 0.11676829596911521, "add_columns_from_episodes_to_train_batch": 0.4546699828622634, "batch_individual_items": 0.49859536091022544, "add_states_from_episodes_to_batch": 1.5999462441106452e-05, "add_one_ts_to_episodes_and_truncate": 0.03589311137438142, "add_time_dim_to_batch_and_zero_pad": 4.323223066579589e-05, "numpy_to_tensor": 0.007761765595216134}}}, "num_env_steps_trained_lifetime": 22656000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 1449984, "num_env_steps_trained_lifetime_throughput": 81885.81212844045, "num_module_steps_trained_lifetime_throughput": 5240.690516966542}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 66000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 12, "trial_id": "76942_00000", "date": "2026-01-15_15-19-31", "timestamp": 1768486771, "time_this_iter_s": 28.45512104034424, "time_total_s": 292.18016505241394, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0178A950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 292.18016505241394, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 31.475, "ram_util_percent": 46.467499999999994}}
{"timers": {"training_iteration": 22.56630838601905, "restore_env_runners": 2.4674802293038876e-05, "training_step": 22.565865282535746, "env_runner_sampling_timer": 12.183499117221574, "learner_update_timer": 10.37202273022233, "synch_weights": 0.0044809470866381965, "synch_env_connectors": 0.0032283488406861936}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.820403603589536e-05, "un_batch_to_individual_items": 0.00010008185739268164, "normalize_and_clip_actions": 0.00013399514243592631, "tensor_to_numpy": 0.00014511026733304567, "get_actions": 0.0004711556420560328, "remove_single_ts_time_rank_from_batch": 4.919321869248025e-06, "module_to_agent_unmapping": 1.009838194494879e-05}}, "connector_pipeline_timer": 0.001139146986887237}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 70000.0, "human_1": 70000.0, "human_2": 70000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.342837575992307, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011572779539706631, "add_observations_from_episodes_to_batch": 8.958751081652814e-05, "batch_individual_items": 7.540620682214588e-05, "add_states_from_episodes_to_batch": 1.4290788212047339e-05, "add_time_dim_to_batch_and_zero_pad": 3.159063630478119e-05, "agent_to_module_mapping": 1.6529235731640714e-05}}, "connector_pipeline_timer": 0.0005296549352028412}, "module_episode_returns_mean": {"shared_policy": -12262.448156666662}, "rlmodule_inference_timer": 0.0004762473464482232, "time_between_sampling": 0.814747663996393, "agent_episode_returns_mean": {"human_0": -4464.306943333333, "human_1": -4444.500438333333, "human_2": -4439.599408333333}, "episode_return_min": -14140.731, "episode_len_min": 2000, "episode_return_mean": -13348.406789999995, "num_episodes_lifetime": 25.999999999999986, "sample": 2.032142084960662, "num_env_steps_sampled_lifetime": 70000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 210000.0}, "num_episodes": 2.0, "env_step_timer": 0.0033987221517844633, "episode_return_max": -12780.1475, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime_throughput": 171.6603326463571}, "learners": {"shared_policy": {"mean_kl_loss": 0.0042469920590519905, "curr_kl_coeff": 0.0003906250058207661, "policy_loss": 0.0933898538351059, "vf_loss": 9.943452835083008, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 20190.404296875, "total_loss": 10.025972366333008, "weights_seq_no": 13.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.0001652836799621582, "num_module_steps_trained": 120832, "entropy": 1.087334394454956, "num_module_steps_trained_lifetime": 1570816, "num_module_steps_trained_lifetime_throughput": 5190.670943319139}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1381534236718707, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011278813177633337, "agent_to_module_mapping": 0.02095566342068185, "general_advantage_estimation": 0.11703596900942584, "add_columns_from_episodes_to_train_batch": 0.455238629033734, "batch_individual_items": 0.49913014830119623, "add_states_from_episodes_to_batch": 1.5989467794716174e-05, "add_one_ts_to_episodes_and_truncate": 0.035888154260664544, "add_time_dim_to_batch_and_zero_pad": 4.3883908318657065e-05, "numpy_to_tensor": 0.007686669939259196}}}, "num_env_steps_trained_lifetime": 24544000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 1570816, "num_env_steps_trained_lifetime_throughput": 81104.2971059513, "num_module_steps_trained_lifetime_throughput": 5190.672735654374}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 70000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 13, "trial_id": "76942_00000", "date": "2026-01-15_15-20-00", "timestamp": 1768486800, "time_this_iter_s": 28.453641414642334, "time_total_s": 320.6338064670563, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0173EB00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 320.6338064670563, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.432500000000005, "ram_util_percent": 46.752500000000005}}
{"timers": {"training_iteration": 22.628784660158903, "restore_env_runners": 2.4735054279451515e-05, "training_step": 22.62833754571047, "env_runner_sampling_timer": 12.230139995049461, "learner_update_timer": 10.387792534920136, "synch_weights": 0.004475382615851787, "synch_env_connectors": 0.003249047352331329}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.913159652319812e-05, "un_batch_to_individual_items": 0.00010140876186662804, "normalize_and_clip_actions": 0.0001342830365192895, "tensor_to_numpy": 0.00014964608366897035, "get_actions": 0.0004711999549123388, "remove_single_ts_time_rank_from_batch": 5.088156699664781e-06, "module_to_agent_unmapping": 1.0772046027709328e-05}}, "connector_pipeline_timer": 0.0011576598581225562}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 74000.0, "human_1": 74000.0, "human_2": 74000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.362039839997596, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011568392114336549, "add_observations_from_episodes_to_batch": 8.85013867011404e-05, "batch_individual_items": 7.372320918980342e-05, "add_states_from_episodes_to_batch": 1.4234428612782942e-05, "add_time_dim_to_batch_and_zero_pad": 2.989321507676438e-05, "agent_to_module_mapping": 1.5367953078489824e-05}}, "connector_pipeline_timer": 0.0005254282975162251}, "module_episode_returns_mean": {"shared_policy": -12352.939873333331}, "rlmodule_inference_timer": 0.00047585446784871095, "time_between_sampling": 0.8553370155319279, "agent_episode_returns_mean": {"human_0": -4492.028159999999, "human_1": -4466.868824999999, "human_2": -4462.083245}, "episode_return_min": -14140.731, "episode_len_min": 2000, "episode_return_mean": -13420.980229999996, "num_episodes_lifetime": 27.999999999999986, "sample": 1.993836112659046, "num_env_steps_sampled_lifetime": 74000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 222000.0}, "num_episodes": 2.0, "env_step_timer": 0.0034805450969201436, "episode_return_max": -12474.575499999997, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime_throughput": 170.00903665946026}, "learners": {"shared_policy": {"mean_kl_loss": 0.003023287979885936, "curr_kl_coeff": 0.00019531250291038305, "policy_loss": -0.04864073544740677, "vf_loss": 9.834979057312012, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 16470.9609375, "total_loss": 9.775469779968262, "weights_seq_no": 14.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 5.990266799926758e-05, "num_module_steps_trained": 120832, "entropy": 1.0870450735092163, "num_module_steps_trained_lifetime": 1691648, "num_module_steps_trained_lifetime_throughput": 5140.390661729922}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1416041004351818, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011292415046371225, "agent_to_module_mapping": 0.021005474786590532, "general_advantage_estimation": 0.11724976931934757, "add_columns_from_episodes_to_train_batch": 0.45623298274338736, "batch_individual_items": 0.5014351958181371, "add_states_from_episodes_to_batch": 1.5941573096477357e-05, "add_one_ts_to_episodes_and_truncate": 0.03585276671795261, "add_time_dim_to_batch_and_zero_pad": 4.380106918136624e-05, "numpy_to_tensor": 0.007613330239801879}}}, "num_env_steps_trained_lifetime": 26432000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 1691648, "num_env_steps_trained_lifetime_throughput": 80318.67415099892, "num_module_steps_trained_lifetime_throughput": 5140.392832642554}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 74000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 14, "trial_id": "76942_00000", "date": "2026-01-15_15-20-29", "timestamp": 1768486829, "time_this_iter_s": 28.82215428352356, "time_total_s": 349.45596075057983, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F55A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 349.45596075057983, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 32.6075, "ram_util_percent": 47.39}}
{"timers": {"training_iteration": 22.676586246557356, "restore_env_runners": 2.476370380098904e-05, "training_step": 22.676136392253362, "env_runner_sampling_timer": 12.270411885098968, "learner_update_timer": 10.395278619571043, "synch_weights": 0.004469491789629369, "synch_env_connectors": 0.003254406878888668}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.891596607691523e-05, "un_batch_to_individual_items": 9.908370412280563e-05, "normalize_and_clip_actions": 0.00013088054729098181, "tensor_to_numpy": 0.00013989295773340503, "get_actions": 0.000441113616088292, "remove_single_ts_time_rank_from_batch": 4.69454710903161e-06, "module_to_agent_unmapping": 1.0114407747231055e-05}}, "connector_pipeline_timer": 0.0010956844612499982}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 78000.0, "human_1": 78000.0, "human_2": 78000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.341726853000871, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010448808058112105, "add_observations_from_episodes_to_batch": 8.385090113537072e-05, "batch_individual_items": 6.968897164827355e-05, "add_states_from_episodes_to_batch": 1.3837935715242541e-05, "add_time_dim_to_batch_and_zero_pad": 2.7196607351188295e-05, "agent_to_module_mapping": 1.4427763852887715e-05}}, "connector_pipeline_timer": 0.0004920820072838244}, "module_episode_returns_mean": {"shared_policy": -12021.302815000003}, "rlmodule_inference_timer": 0.00044736335235780005, "time_between_sampling": 0.8914763106311353, "agent_episode_returns_mean": {"human_0": -4376.032171666667, "human_1": -4352.188096666666, "human_2": -4342.741961666667}, "episode_return_min": -14140.731, "episode_len_min": 2000, "episode_return_mean": -13070.962229999997, "num_episodes_lifetime": 29.999999999999986, "sample": 1.9589454673050999, "num_env_steps_sampled_lifetime": 78000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 234000.0}, "num_episodes": 2.0, "env_step_timer": 0.0034235141907965243, "episode_return_max": -10678.431499999999, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime_throughput": 168.58192850748605}, "learners": {"shared_policy": {"mean_kl_loss": 0.006882231216877699, "curr_kl_coeff": 0.00019531250291038305, "policy_loss": 0.1279490739107132, "vf_loss": 9.653326034545898, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 12181.041015625, "total_loss": 9.770605087280273, "weights_seq_no": 15.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": -6.318092346191406e-06, "num_module_steps_trained": 120832, "entropy": 1.0671112537384033, "num_module_steps_trained_lifetime": 1812480, "num_module_steps_trained_lifetime_throughput": 5103.362278966334}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1426622184308057, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011337110895570952, "agent_to_module_mapping": 0.021031846038771403, "general_advantage_estimation": 0.11726179962616659, "add_columns_from_episodes_to_train_batch": 0.45746294291590744, "batch_individual_items": 0.5012644118600251, "add_states_from_episodes_to_batch": 1.593215734353337e-05, "add_one_ts_to_episodes_and_truncate": 0.0358877860507582, "add_time_dim_to_batch_and_zero_pad": 4.380905853867612e-05, "numpy_to_tensor": 0.0075395879372747}}}, "num_env_steps_trained_lifetime": 28320000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 1812480, "num_env_steps_trained_lifetime_throughput": 79740.0844441522, "num_module_steps_trained_lifetime_throughput": 5103.364596066801}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 78000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 15, "trial_id": "76942_00000", "date": "2026-01-15_15-20-56", "timestamp": 1768486856, "time_this_iter_s": 27.419146060943604, "time_total_s": 376.87510681152344, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA01789000>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 376.87510681152344, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.510256410256407, "ram_util_percent": 47.43076923076923}}
{"timers": {"training_iteration": 22.718378301091782, "restore_env_runners": 2.474406675285381e-05, "training_step": 22.717926754330833, "env_runner_sampling_timer": 12.307765953247936, "learner_update_timer": 10.399678962375356, "synch_weights": 0.00446614887170416, "synch_env_connectors": 0.0032666628101321914}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.7721245165160715e-05, "un_batch_to_individual_items": 9.869996450959143e-05, "normalize_and_clip_actions": 0.00012744412181573704, "tensor_to_numpy": 0.00013812861912284704, "get_actions": 0.0004197750577205935, "remove_single_ts_time_rank_from_batch": 4.640064498460079e-06, "module_to_agent_unmapping": 9.692969198199129e-06}}, "connector_pipeline_timer": 0.0010615410722523084}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 82000.0, "human_1": 82000.0, "human_2": 82000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.191178474000917, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.462060494925292e-05, "add_observations_from_episodes_to_batch": 8.11657119394779e-05, "batch_individual_items": 6.485616445689326e-05, "add_states_from_episodes_to_batch": 1.4059502330878024e-05, "add_time_dim_to_batch_and_zero_pad": 2.646629775351898e-05, "agent_to_module_mapping": 1.400561276086652e-05}}, "connector_pipeline_timer": 0.0004714466904352327}, "module_episode_returns_mean": {"shared_policy": -11066.042178333337}, "rlmodule_inference_timer": 0.00041755119778971977, "time_between_sampling": 0.9160946564580229, "agent_episode_returns_mean": {"human_0": -4013.8394649999996, "human_1": -3993.209334999999, "human_2": -3988.1865849999995}, "episode_return_min": -13513.481499999994, "episode_len_min": 2000, "episode_return_mean": -11995.235385000002, "num_episodes_lifetime": 31.999999999999986, "sample": 1.9223481259976367, "num_env_steps_sampled_lifetime": 82000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 246000.0}, "num_episodes": 2.0, "env_step_timer": 0.0034359905405630664, "episode_return_max": -10678.431499999999, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime_throughput": 167.5029523526802}, "learners": {"shared_policy": {"mean_kl_loss": 0.011685666628181934, "curr_kl_coeff": 0.00019531250291038305, "policy_loss": 0.014569143764674664, "vf_loss": 9.767765045166016, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 11787.310546875, "total_loss": 9.771685600280762, "weights_seq_no": 16.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 7.265806198120117e-05, "num_module_steps_trained": 120832, "entropy": 1.0649642944335938, "num_module_steps_trained_lifetime": 1933312, "num_module_steps_trained_lifetime_throughput": 5072.713642201517}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1425987762465417, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011335739786696268, "agent_to_module_mapping": 0.021101869578425542, "general_advantage_estimation": 0.117171345629868, "add_columns_from_episodes_to_train_batch": 0.4576053034867637, "batch_individual_items": 0.5011535667414969, "add_states_from_episodes_to_batch": 1.5932835678744607e-05, "add_one_ts_to_episodes_and_truncate": 0.03589099919038428, "add_time_dim_to_batch_and_zero_pad": 4.3817968010027385e-05, "numpy_to_tensor": 0.007467011057830375}}}, "num_env_steps_trained_lifetime": 30208000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 1933312, "num_env_steps_trained_lifetime_throughput": 79261.23694646706, "num_module_steps_trained_lifetime_throughput": 5072.714848888367}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 82000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 16, "trial_id": "76942_00000", "date": "2026-01-15_15-21-23", "timestamp": 1768486883, "time_this_iter_s": 26.866267442703247, "time_total_s": 403.7413742542267, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0178AC20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 403.7413742542267, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 21.17837837837838, "ram_util_percent": 47.12432432432431}}
{"timers": {"training_iteration": 22.76169136208087, "restore_env_runners": 2.4769626126813828e-05, "training_step": 22.76123753478759, "env_runner_sampling_timer": 12.345079175715522, "learner_update_timer": 10.405642535751594, "synch_weights": 0.004464288382932148, "synch_env_connectors": 0.0032742951819874455}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.7711365687362273e-05, "un_batch_to_individual_items": 9.813340284861363e-05, "normalize_and_clip_actions": 0.00012419930634082268, "tensor_to_numpy": 0.00013401734153203627, "get_actions": 0.0004157015420762883, "remove_single_ts_time_rank_from_batch": 4.58748678331766e-06, "module_to_agent_unmapping": 9.586168005216104e-06}}, "connector_pipeline_timer": 0.0010495490854763076}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 86000.0, "human_1": 86000.0, "human_2": 86000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.970354419000069, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.26823738113213e-05, "add_observations_from_episodes_to_batch": 8.014030507759942e-05, "batch_individual_items": 6.465938927054113e-05, "add_states_from_episodes_to_batch": 1.3636115325262707e-05, "add_time_dim_to_batch_and_zero_pad": 2.5342446589875197e-05, "agent_to_module_mapping": 1.42093519745051e-05}}, "connector_pipeline_timer": 0.0004650501171244158}, "module_episode_returns_mean": {"shared_policy": -10457.677773333335}, "rlmodule_inference_timer": 0.000420141361518486, "time_between_sampling": 0.935934248951231, "agent_episode_returns_mean": {"human_0": -3782.638599999999, "human_1": -3761.073549999999, "human_2": -3757.984299999999}, "episode_return_min": -12970.211999999998, "episode_len_min": 2000, "episode_return_mean": -11301.69645, "num_episodes_lifetime": 34.000000000000036, "sample": 1.8877598191955312, "num_env_steps_sampled_lifetime": 86000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 258000.0}, "num_episodes": 2.0, "env_step_timer": 0.0033870028348682293, "episode_return_max": -9939.493499999999, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime_throughput": 166.55129844089734}, "learners": {"shared_policy": {"mean_kl_loss": 0.0033813761547207832, "curr_kl_coeff": 9.765625145519152e-05, "policy_loss": -0.022803310304880142, "vf_loss": 9.795936584472656, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 8706.4287109375, "total_loss": 9.762408256530762, "weights_seq_no": 17.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 9.59634780883789e-06, "num_module_steps_trained": 120832, "entropy": 1.0727647542953491, "num_module_steps_trained_lifetime": 2054144, "num_module_steps_trained_lifetime_throughput": 5041.996585734753}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1425987314841437, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011387892388908245, "agent_to_module_mapping": 0.02108737088266808, "general_advantage_estimation": 0.11711834817362475, "add_columns_from_episodes_to_train_batch": 0.4578279934518882, "batch_individual_items": 0.5011117060741114, "add_states_from_episodes_to_batch": 1.5890507339737972e-05, "add_one_ts_to_episodes_and_truncate": 0.03585014019854794, "add_time_dim_to_batch_and_zero_pad": 4.372078830712461e-05, "numpy_to_tensor": 0.007394723947207514}}}, "num_env_steps_trained_lifetime": 32096000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 2054144, "num_env_steps_trained_lifetime_throughput": 78781.22876091805, "num_module_steps_trained_lifetime_throughput": 5041.997641611318}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 86000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 17, "trial_id": "76942_00000", "date": "2026-01-15_15-21-50", "timestamp": 1768486910, "time_this_iter_s": 27.05868697166443, "time_total_s": 430.8000612258911, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0173F1C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 430.8000612258911, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 21.773684210526316, "ram_util_percent": 47.09736842105262}}
{"timers": {"training_iteration": 22.804464717460114, "restore_env_runners": 2.476492996963775e-05, "training_step": 22.804008237439724, "env_runner_sampling_timer": 12.379806630958399, "learner_update_timer": 10.413632274394136, "synch_weights": 0.004462941499179052, "synch_env_connectors": 0.003287322230164563}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.747171176688585e-05, "un_batch_to_individual_items": 9.687896380565153e-05, "normalize_and_clip_actions": 0.00012421120798519525, "tensor_to_numpy": 0.00013325442857322153, "get_actions": 0.0004157055699739733, "remove_single_ts_time_rank_from_batch": 4.602227570001454e-06, "module_to_agent_unmapping": 9.77473672230683e-06}}, "connector_pipeline_timer": 0.0010531060447950093}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 90000.0, "human_1": 90000.0, "human_2": 90000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.760913587993127, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.39825022536533e-05, "add_observations_from_episodes_to_batch": 8.005947720085522e-05, "batch_individual_items": 6.44016390726365e-05, "add_states_from_episodes_to_batch": 1.356272788284938e-05, "add_time_dim_to_batch_and_zero_pad": 2.5221376480744598e-05, "agent_to_module_mapping": 1.4314093038364631e-05}}, "connector_pipeline_timer": 0.0004725492530886535}, "module_episode_returns_mean": {"shared_policy": -10062.977673333335}, "rlmodule_inference_timer": 0.0004180772928448548, "time_between_sampling": 0.9564066121890237, "agent_episode_returns_mean": {"human_0": -3614.812406666666, "human_1": -3598.4669716666644, "human_2": -3594.3213366666664}, "episode_return_min": -12951.761999999999, "episode_len_min": 2000, "episode_return_mean": -10807.600714999999, "num_episodes_lifetime": 36.000000000000036, "sample": 1.8555223208395575, "num_env_steps_sampled_lifetime": 90000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 270000.0}, "num_episodes": 2.0, "env_step_timer": 0.003386234575274346, "episode_return_max": -9939.493499999999, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime_throughput": 165.66381320954645}, "learners": {"shared_policy": {"mean_kl_loss": 0.0019856528379023075, "curr_kl_coeff": 4.882812572759576e-05, "policy_loss": 0.013837629929184914, "vf_loss": 9.85862922668457, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 13184.5205078125, "total_loss": 9.861701965332031, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 2.6226043701171875e-06, "num_module_steps_trained": 120832, "entropy": 1.0765525102615356, "num_module_steps_trained_lifetime": 2174976, "num_module_steps_trained_lifetime_throughput": 5012.916976998455}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1426950961693314, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011387773465404971, "agent_to_module_mapping": 0.021087898173820046, "general_advantage_estimation": 0.11705311369179096, "add_columns_from_episodes_to_train_batch": 0.4579604065174575, "batch_individual_items": 0.5012511290134017, "add_states_from_episodes_to_batch": 1.5871602313735597e-05, "add_one_ts_to_episodes_and_truncate": 0.035814960796602666, "add_time_dim_to_batch_and_zero_pad": 4.38935805578006e-05, "numpy_to_tensor": 0.007323598707686705}}}, "num_env_steps_trained_lifetime": 33984000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 2174976, "num_env_steps_trained_lifetime_throughput": 78327.01118318776, "num_module_steps_trained_lifetime_throughput": 5012.921980368697}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 90000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 18, "trial_id": "76942_00000", "date": "2026-01-15_15-22-17", "timestamp": 1768486937, "time_this_iter_s": 27.047746419906616, "time_total_s": 457.84780764579773, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F44C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 457.84780764579773, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 21.90526315789474, "ram_util_percent": 47.00789473684211}}
{"timers": {"training_iteration": 22.870674819285615, "restore_env_runners": 2.4800280642055713e-05, "training_step": 22.870215381065332, "env_runner_sampling_timer": 12.433160285648787, "learner_update_timer": 10.426428348650102, "synch_weights": 0.004469443084260189, "synch_env_connectors": 0.0032962810078509797}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 4.0413222096539355e-05, "un_batch_to_individual_items": 0.0001077100472124179, "normalize_and_clip_actions": 0.00014357500601916358, "tensor_to_numpy": 0.00015980439044131902, "get_actions": 0.0005173059381139053, "remove_single_ts_time_rank_from_batch": 5.554443271589681e-06, "module_to_agent_unmapping": 1.1271092496016532e-05}}, "connector_pipeline_timer": 0.0012415666905840996}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 94000.0, "human_1": 94000.0, "human_2": 94000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.735322284992872, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00013271201709069464, "add_observations_from_episodes_to_batch": 9.714374540319989e-05, "batch_individual_items": 8.104624030017824e-05, "add_states_from_episodes_to_batch": 1.5042658860976593e-05, "add_time_dim_to_batch_and_zero_pad": 3.5222962711182335e-05, "agent_to_module_mapping": 1.633242582856281e-05}}, "connector_pipeline_timer": 0.0005767499955831417}, "module_episode_returns_mean": {"shared_policy": -10582.437871666665}, "rlmodule_inference_timer": 0.0004884997982814099, "time_between_sampling": 0.9761629073944302, "agent_episode_returns_mean": {"human_0": -3804.7476499999993, "human_1": -3786.8365449999983, "human_2": -3782.4487299999996}, "episode_return_min": -13438.218999999997, "episode_len_min": 2000, "episode_return_mean": -11374.032924999998, "num_episodes_lifetime": 38.000000000000036, "sample": 1.8355413780412426, "num_env_steps_sampled_lifetime": 94000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 282000.0}, "num_episodes": 2.0, "env_step_timer": 0.0035641190793851, "episode_return_max": -9939.493499999999, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime_throughput": 164.2787675068246}, "learners": {"shared_policy": {"mean_kl_loss": 0.005570078268647194, "curr_kl_coeff": 4.882812572759576e-05, "policy_loss": 0.006647920235991478, "vf_loss": 9.914461135864258, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 12513.525390625, "total_loss": 9.910521507263184, "weights_seq_no": 19.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 1.9073486328125e-06, "num_module_steps_trained": 120832, "entropy": 1.0586868524551392, "num_module_steps_trained_lifetime": 2295808, "num_module_steps_trained_lifetime_throughput": 4967.195351128559}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.145213719207592, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001145471573099243, "agent_to_module_mapping": 0.021197781192128513, "general_advantage_estimation": 0.11730689055485997, "add_columns_from_episodes_to_train_batch": 0.4594489624522782, "batch_individual_items": 0.5019269767233184, "add_states_from_episodes_to_batch": 1.5891886343920186e-05, "add_one_ts_to_episodes_and_truncate": 0.03587272018863965, "add_time_dim_to_batch_and_zero_pad": 4.3969644744669565e-05, "numpy_to_tensor": 0.007253237720673634}}}, "num_env_steps_trained_lifetime": 35872000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 2295808, "num_env_steps_trained_lifetime_throughput": 77612.47816017266, "num_module_steps_trained_lifetime_throughput": 4967.196934120604}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 94000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 19, "trial_id": "76942_00000", "date": "2026-01-15_15-22-47", "timestamp": 1768486967, "time_this_iter_s": 29.434974670410156, "time_total_s": 487.2827823162079, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F48B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 487.2827823162079, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 40.18048780487805, "ram_util_percent": 46.31463414634147}}
{"timers": {"training_iteration": 22.910199488092672, "restore_env_runners": 2.4792277771364584e-05, "training_step": 22.909738508254726, "env_runner_sampling_timer": 12.465212842792315, "learner_update_timer": 10.433790128163604, "synch_weights": 0.004483993653428875, "synch_env_connectors": 0.0033016371977863408}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.7573645903237736e-05, "un_batch_to_individual_items": 9.693202477053522e-05, "normalize_and_clip_actions": 0.0001238332689102389, "tensor_to_numpy": 0.00013312085171267887, "get_actions": 0.00041478102489149346, "remove_single_ts_time_rank_from_batch": 4.496089250536647e-06, "module_to_agent_unmapping": 9.659575458813961e-06}}, "connector_pipeline_timer": 0.0010448862013470073}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 98000.0, "human_1": 98000.0, "human_2": 98000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.249483741994045, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.618450713202192e-05, "add_observations_from_episodes_to_batch": 8.021022755549324e-05, "batch_individual_items": 6.380761301443966e-05, "add_states_from_episodes_to_batch": 1.3652646625261596e-05, "add_time_dim_to_batch_and_zero_pad": 2.5442069163400265e-05, "agent_to_module_mapping": 1.3884254045743426e-05}}, "connector_pipeline_timer": 0.00047003349259817494}, "module_episode_returns_mean": {"shared_policy": -10988.996309999995}, "rlmodule_inference_timer": 0.00041936212324834507, "time_between_sampling": 1.0001761371042848, "agent_episode_returns_mean": {"human_0": -3970.033864999999, "human_1": -3948.314589999999, "human_2": -3939.0725899999998}, "episode_return_min": -13438.218999999997, "episode_len_min": 2000, "episode_return_mean": -11857.421044999994, "num_episodes_lifetime": 40.000000000000036, "sample": 1.813694245563711, "num_env_steps_sampled_lifetime": 98000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 294000.0}, "num_episodes": 2.0, "env_step_timer": 0.0033466282884850743, "episode_return_max": -9939.493499999999, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime_throughput": 163.36398201844207}, "learners": {"shared_policy": {"mean_kl_loss": 0.002258406952023506, "curr_kl_coeff": 2.441406286379788e-05, "policy_loss": -0.020931828767061234, "vf_loss": 9.722431182861328, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 7652.86474609375, "total_loss": 9.690844535827637, "weights_seq_no": 20.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 1.9669532775878906e-06, "num_module_steps_trained": 120832, "entropy": 1.0654873847961426, "num_module_steps_trained_lifetime": 2416640, "num_module_steps_trained_lifetime_throughput": 4943.683626548601}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1455575210155193, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011458588573172068, "agent_to_module_mapping": 0.02118883038030502, "general_advantage_estimation": 0.11750851464927292, "add_columns_from_episodes_to_train_batch": 0.45980409682775614, "batch_individual_items": 0.5018150609561097, "add_states_from_episodes_to_batch": 1.588196759640643e-05, "add_one_ts_to_episodes_and_truncate": 0.03585561798675418, "add_time_dim_to_batch_and_zero_pad": 4.386294835902357e-05, "numpy_to_tensor": 0.007183127343428268}}}, "num_env_steps_trained_lifetime": 37760000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 2416640, "num_env_steps_trained_lifetime_throughput": 77245.13494444502, "num_module_steps_trained_lifetime_throughput": 4943.6851253701525}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 98000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 20, "trial_id": "76942_00000", "date": "2026-01-15_15-23-14", "timestamp": 1768486994, "time_this_iter_s": 26.831645011901855, "time_total_s": 514.1144273281097, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0178A7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 514.1144273281097, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 21.626315789473683, "ram_util_percent": 45.80263157894737}}
{"timers": {"training_iteration": 22.958044808211742, "restore_env_runners": 2.4816355027525002e-05, "training_step": 22.95758164617212, "env_runner_sampling_timer": 12.498745195364307, "learner_update_timer": 10.44803065288199, "synch_weights": 0.004479247716890901, "synch_env_connectors": 0.003306479825812141}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.737849967558821e-05, "un_batch_to_individual_items": 9.846243405452356e-05, "normalize_and_clip_actions": 0.00012588826018854017, "tensor_to_numpy": 0.0001326635522053002, "get_actions": 0.00041763373816536276, "remove_single_ts_time_rank_from_batch": 4.400814680060416e-06, "module_to_agent_unmapping": 9.600169107925244e-06}}, "connector_pipeline_timer": 0.0010549763411313066}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 102000.0, "human_1": 102000.0, "human_2": 102000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.169726027997967, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.540167039252665e-05, "add_observations_from_episodes_to_batch": 7.976295910973566e-05, "batch_individual_items": 6.423103045462842e-05, "add_states_from_episodes_to_batch": 1.3469513950077681e-05, "add_time_dim_to_batch_and_zero_pad": 2.5528786507360084e-05, "agent_to_module_mapping": 1.4322774190524974e-05}}, "connector_pipeline_timer": 0.00046868345612432783}, "module_episode_returns_mean": {"shared_policy": -10505.533841666664}, "rlmodule_inference_timer": 0.00042620693406706544, "time_between_sampling": 1.0158371862760147, "agent_episode_returns_mean": {"human_0": -3804.2656349999993, "human_1": -3786.1836049999984, "human_2": -3782.058589999999}, "episode_return_min": -13438.218999999997, "episode_len_min": 2000, "episode_return_mean": -11372.507829999999, "num_episodes_lifetime": 42.000000000000036, "sample": 1.787178276870798, "num_env_steps_sampled_lifetime": 102000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 306000.0}, "num_episodes": 2.0, "env_step_timer": 0.0033472058461715944, "episode_return_max": -10032.691999999995, "weights_seq_no": 20.0, "num_env_steps_sampled_lifetime_throughput": 162.56436059508695}, "learners": {"shared_policy": {"mean_kl_loss": 0.003997029270976782, "curr_kl_coeff": 1.220703143189894e-05, "policy_loss": -0.07319720834493637, "vf_loss": 9.756034851074219, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 9218.8427734375, "total_loss": 9.672210693359375, "weights_seq_no": 21.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 1.7881393432617188e-06, "num_module_steps_trained": 120832, "entropy": 1.0626734495162964, "num_module_steps_trained_lifetime": 2537472, "num_module_steps_trained_lifetime_throughput": 4913.530509688977}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1479590788053473, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011453992686768155, "agent_to_module_mapping": 0.02118305407651637, "general_advantage_estimation": 0.11752232350285921, "add_columns_from_episodes_to_train_batch": 0.4603205418594262, "batch_individual_items": 0.5037580863465894, "add_states_from_episodes_to_batch": 1.583314788492172e-05, "add_one_ts_to_episodes_and_truncate": 0.03586489680695668, "add_time_dim_to_batch_and_zero_pad": 4.3780318821329076e-05, "numpy_to_tensor": 0.007113908070092437}}}, "num_env_steps_trained_lifetime": 39648000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 2537472, "num_env_steps_trained_lifetime_throughput": 76773.96500789127, "num_module_steps_trained_lifetime_throughput": 4913.532169799485}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 102000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 21, "trial_id": "76942_00000", "date": "2026-01-15_15-23-41", "timestamp": 1768487021, "time_this_iter_s": 27.70525312423706, "time_total_s": 541.8196804523468, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0173EDD0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 541.8196804523468, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 26.189743589743586, "ram_util_percent": 45.78974358974358}}
{"timers": {"training_iteration": 22.988786482129548, "restore_env_runners": 2.4796191467124413e-05, "training_step": 22.988321426710407, "env_runner_sampling_timer": 12.52229510541058, "learner_update_timer": 10.455191329353276, "synch_weights": 0.004472348239693511, "synch_env_connectors": 0.003334000027582388}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.4175827655776777e-05, "un_batch_to_individual_items": 9.304284601268369e-05, "normalize_and_clip_actions": 0.00011618655876632852, "tensor_to_numpy": 0.00012783197824880083, "get_actions": 0.0004004150113990851, "remove_single_ts_time_rank_from_batch": 4.149628791263193e-06, "module_to_agent_unmapping": 8.884723445854655e-06}}, "connector_pipeline_timer": 0.000994046324981426}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 106000.0, "human_1": 106000.0, "human_2": 106000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.864594256997076, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.344446797419743e-05, "add_observations_from_episodes_to_batch": 7.642294184786739e-05, "batch_individual_items": 6.252396129225417e-05, "add_states_from_episodes_to_batch": 1.2477176225404662e-05, "add_time_dim_to_batch_and_zero_pad": 2.505260041565481e-05, "agent_to_module_mapping": 1.3087407393539693e-05}}, "connector_pipeline_timer": 0.0004476546938731667}, "module_episode_returns_mean": {"shared_policy": -10147.527829999995}, "rlmodule_inference_timer": 0.0003957370429081246, "time_between_sampling": 1.0358000413683455, "agent_episode_returns_mean": {"human_0": -3670.030013333333, "human_1": -3654.657218333332, "human_2": -3660.2568433333327}, "episode_return_min": -13438.218999999997, "episode_len_min": 2000, "episode_return_mean": -10984.944075, "num_episodes_lifetime": 44.000000000000036, "sample": 1.7611347822318173, "num_env_steps_sampled_lifetime": 106000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 318000.0}, "num_episodes": 2.0, "env_step_timer": 0.003083344010037853, "episode_return_max": -9195.626999999999, "weights_seq_no": 21.0, "num_env_steps_sampled_lifetime_throughput": 161.9022142995669}, "learners": {"shared_policy": {"mean_kl_loss": 0.0037803873419761658, "curr_kl_coeff": 6.10351571594947e-06, "policy_loss": -0.024174537509679794, "vf_loss": 9.66382122039795, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 5543.87548828125, "total_loss": 9.629149436950684, "weights_seq_no": 22.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 1.9073486328125e-06, "num_module_steps_trained": 120832, "entropy": 1.049675464630127, "num_module_steps_trained_lifetime": 2658304, "num_module_steps_trained_lifetime_throughput": 4899.3855773047435}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1486234930173032, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011459482760007836, "agent_to_module_mapping": 0.021179039535789496, "general_advantage_estimation": 0.1176055862678367, "add_columns_from_episodes_to_train_batch": 0.46123752544077634, "batch_individual_items": 0.5035014134830804, "add_states_from_episodes_to_batch": 1.5786816385780847e-05, "add_one_ts_to_episodes_and_truncate": 0.035860842838986044, "add_time_dim_to_batch_and_zero_pad": 4.3673515534168354e-05, "numpy_to_tensor": 0.007046221989345391}}}, "num_env_steps_trained_lifetime": 41536000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 2658304, "num_env_steps_trained_lifetime_throughput": 76553.015335446, "num_module_steps_trained_lifetime_throughput": 4899.387680577359}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 106000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 22, "trial_id": "76942_00000", "date": "2026-01-15_15-24-07", "timestamp": 1768487047, "time_this_iter_s": 26.041418313980103, "time_total_s": 567.8610987663269, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F7250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 567.8610987663269, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.81081081081081, "ram_util_percent": 46.01081081081081}}
{"timers": {"training_iteration": 23.03044624630823, "restore_env_runners": 2.4895229429818474e-05, "training_step": 23.029978615443266, "env_runner_sampling_timer": 12.55439638635643, "learner_update_timer": 10.464721295059748, "synch_weights": 0.004469405757332856, "synch_env_connectors": 0.003338680027226489}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.764415348010408e-05, "un_batch_to_individual_items": 9.529036184314864e-05, "normalize_and_clip_actions": 0.00012546692698036605, "tensor_to_numpy": 0.0001349828352329702, "get_actions": 0.00042860143270823895, "remove_single_ts_time_rank_from_batch": 4.45588382856939e-06, "module_to_agent_unmapping": 9.813489908176334e-06}}, "connector_pipeline_timer": 0.001060115487161124}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 110000.0, "human_1": 110000.0, "human_2": 110000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.327948807994254, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010153636440292268, "add_observations_from_episodes_to_batch": 8.197536043134032e-05, "batch_individual_items": 6.612295438485474e-05, "add_states_from_episodes_to_batch": 1.3258551243059324e-05, "add_time_dim_to_batch_and_zero_pad": 2.6592907849692058e-05, "agent_to_module_mapping": 1.4441177438214185e-05}}, "connector_pipeline_timer": 0.00047656704823514494}, "module_episode_returns_mean": {"shared_policy": -9619.678074999996}, "rlmodule_inference_timer": 0.0004262255983008514, "time_between_sampling": 1.0471177042014834, "agent_episode_returns_mean": {"human_0": -3462.5184133333332, "human_1": -3450.0921483333327, "human_2": -3449.791238333333}, "episode_return_min": -11764.189999999999, "episode_len_min": 2000, "episode_return_mean": -10362.4018, "num_episodes_lifetime": 46.000000000000036, "sample": 1.7372218868570108, "num_env_steps_sampled_lifetime": 110000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 330000.0}, "num_episodes": 2.0, "env_step_timer": 0.003279886370665159, "episode_return_max": -9195.626999999999, "weights_seq_no": 22.0, "num_env_steps_sampled_lifetime_throughput": 161.22226227708785}, "learners": {"shared_policy": {"mean_kl_loss": 0.006061178632080555, "curr_kl_coeff": 6.10351571594947e-06, "policy_loss": -0.05538611114025116, "vf_loss": 9.803975105285645, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 5558.94580078125, "total_loss": 9.73840045928955, "weights_seq_no": 23.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 1.3709068298339844e-06, "num_module_steps_trained": 120832, "entropy": 1.01889169216156, "num_module_steps_trained_lifetime": 2779136, "num_module_steps_trained_lifetime_throughput": 4876.404422772957}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1504939590871417, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001145059793261494, "agent_to_module_mapping": 0.0211982661404735, "general_advantage_estimation": 0.11773449140514541, "add_columns_from_episodes_to_train_batch": 0.4614450551864089, "batch_individual_items": 0.5051628043483611, "add_states_from_episodes_to_batch": 1.574294821686037e-05, "add_one_ts_to_episodes_and_truncate": 0.03578682341052602, "add_time_dim_to_batch_and_zero_pad": 4.360078038563836e-05, "numpy_to_tensor": 0.006978210769488609}}}, "num_env_steps_trained_lifetime": 43424000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 2779136, "num_env_steps_trained_lifetime_throughput": 76193.99002104331, "num_module_steps_trained_lifetime_throughput": 4876.408891534253}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 110000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 23, "trial_id": "76942_00000", "date": "2026-01-15_15-24-35", "timestamp": 1768487075, "time_this_iter_s": 27.162212371826172, "time_total_s": 595.0233111381531, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA01D83910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 595.0233111381531, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.892105263157895, "ram_util_percent": 45.952631578947376}}
{"timers": {"training_iteration": 23.04214104984506, "restore_env_runners": 2.4963277221008252e-05, "training_step": 23.04167225228893, "env_runner_sampling_timer": 12.564506151492763, "learner_update_timer": 10.46628348210923, "synch_weights": 0.004465539699669635, "synch_env_connectors": 0.003338694226918439}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.016850485348208e-05, "un_batch_to_individual_items": 8.108400493494649e-05, "normalize_and_clip_actions": 0.00010569913661259718, "tensor_to_numpy": 0.00011697652607925758, "get_actions": 0.0003640013751400456, "remove_single_ts_time_rank_from_batch": 3.7643045220636547e-06, "module_to_agent_unmapping": 8.286921839410231e-06}}, "connector_pipeline_timer": 0.0009099768657628547}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 114000.0, "human_1": 114000.0, "human_2": 114000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.235846375995024, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.635377686937629e-05, "add_observations_from_episodes_to_batch": 6.899100567208784e-05, "batch_individual_items": 5.57978542056219e-05, "add_states_from_episodes_to_batch": 1.1114934785693646e-05, "add_time_dim_to_batch_and_zero_pad": 2.218563589405022e-05, "agent_to_module_mapping": 1.225369249372572e-05}}, "connector_pipeline_timer": 0.00040530671199038627}, "module_episode_returns_mean": {"shared_policy": -9188.793483333333}, "rlmodule_inference_timer": 0.0003594079893376583, "time_between_sampling": 1.059299156538561, "agent_episode_returns_mean": {"human_0": -3284.375401666667, "human_1": -3279.8547816666664, "human_2": -3275.035746666665}, "episode_return_min": -11764.189999999999, "episode_len_min": 2000, "episode_return_mean": -9839.26593, "num_episodes_lifetime": 48.000000000000036, "sample": 1.7077337866748188, "num_env_steps_sampled_lifetime": 114000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 342000.0}, "num_episodes": 2.0, "env_step_timer": 0.0027978442752685444, "episode_return_max": -7048.171500000001, "weights_seq_no": 23.0, "num_env_steps_sampled_lifetime_throughput": 161.14896253978006}, "learners": {"shared_policy": {"mean_kl_loss": 0.011269703507423401, "curr_kl_coeff": 6.10351571594947e-06, "policy_loss": 0.10242123156785965, "vf_loss": 9.49167251586914, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 4123.94189453125, "total_loss": 9.584311485290527, "weights_seq_no": 24.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 2.980232238769531e-07, "num_module_steps_trained": 120832, "entropy": 0.9782487154006958, "num_module_steps_trained_lifetime": 2899968, "num_module_steps_trained_lifetime_throughput": 4881.712906811485}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1513095784963427, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011456521953531567, "agent_to_module_mapping": 0.02121592147908766, "general_advantage_estimation": 0.11781687149107566, "add_columns_from_episodes_to_train_batch": 0.4618572716346013, "batch_individual_items": 0.5055835723048459, "add_states_from_episodes_to_batch": 1.5698518722014602e-05, "add_one_ts_to_episodes_and_truncate": 0.03573804017646519, "add_time_dim_to_batch_and_zero_pad": 4.3537772657124114e-05, "numpy_to_tensor": 0.006913332661882296}}}, "num_env_steps_trained_lifetime": 45312000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 2899968, "num_env_steps_trained_lifetime_throughput": 76276.74927370118, "num_module_steps_trained_lifetime_throughput": 4881.713471387658}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 114000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 24, "trial_id": "76942_00000", "date": "2026-01-15_15-24-59", "timestamp": 1768487099, "time_this_iter_s": 24.20922327041626, "time_total_s": 619.2325344085693, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0178AB00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 619.2325344085693, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 25.076470588235292, "ram_util_percent": 45.99411764705882}}
{"timers": {"training_iteration": 23.043414814346523, "restore_env_runners": 2.494364445390182e-05, "training_step": 23.04294077576602, "env_runner_sampling_timer": 12.563504747977822, "learner_update_timer": 10.468520538288205, "synch_weights": 0.0044645163026882885, "synch_env_connectors": 0.0033491922846993227}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.927347581878266e-05, "un_batch_to_individual_items": 7.72155800687699e-05, "normalize_and_clip_actions": 0.00010575054324181955, "tensor_to_numpy": 0.0001166241122861, "get_actions": 0.00036742605012124647, "remove_single_ts_time_rank_from_batch": 3.7601345951698814e-06, "module_to_agent_unmapping": 8.050215856636658e-06}}, "connector_pipeline_timer": 0.000890285043764112}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 118000.0, "human_1": 118000.0, "human_2": 118000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 10.550825475002494, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.645447071002813e-05, "add_observations_from_episodes_to_batch": 6.773090735055225e-05, "batch_individual_items": 5.615122601987836e-05, "add_states_from_episodes_to_batch": 1.0598211390793697e-05, "add_time_dim_to_batch_and_zero_pad": 2.242712932774365e-05, "agent_to_module_mapping": 1.1981019341763592e-05}}, "connector_pipeline_timer": 0.00039533194040258736}, "module_episode_returns_mean": {"shared_policy": -8007.9866950000005}, "rlmodule_inference_timer": 0.00035969957540963595, "time_between_sampling": 1.0623423596583206, "agent_episode_returns_mean": {"human_0": -2869.4414466666676, "human_1": -2875.0992816666653, "human_2": -2872.5023766666664}, "episode_return_min": -9906.1265, "episode_len_min": 2000, "episode_return_mean": -8617.043105, "num_episodes_lifetime": 50.000000000000064, "sample": 1.661576293620079, "num_env_steps_sampled_lifetime": 118000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 354000.0}, "num_episodes": 2.0, "env_step_timer": 0.0025512741114720626, "episode_return_max": -5926.661000000001, "weights_seq_no": 24.0, "num_env_steps_sampled_lifetime_throughput": 161.73380932096646}, "learners": {"shared_policy": {"mean_kl_loss": 0.010746045038104057, "curr_kl_coeff": 6.10351571594947e-06, "policy_loss": -0.019354265183210373, "vf_loss": 9.631414413452148, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 2757.264404296875, "total_loss": 9.602916717529297, "weights_seq_no": 25.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 1.0132789611816406e-06, "num_module_steps_trained": 120832, "entropy": 0.9142977595329285, "num_module_steps_trained_lifetime": 3020800, "num_module_steps_trained_lifetime_throughput": 4897.91855498434}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.153133188711352, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011450986733290104, "agent_to_module_mapping": 0.02122313326428146, "general_advantage_estimation": 0.1177592557762383, "add_columns_from_episodes_to_train_batch": 0.4620536569181706, "batch_individual_items": 0.5073796545816812, "add_states_from_episodes_to_batch": 1.596353354668931e-05, "add_one_ts_to_episodes_and_truncate": 0.03568648077462952, "add_time_dim_to_batch_and_zero_pad": 4.360039493907261e-05, "numpy_to_tensor": 0.0068471103353103515}}}, "num_env_steps_trained_lifetime": 47200000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 3020800, "num_env_steps_trained_lifetime_throughput": 76530.10350574745, "num_module_steps_trained_lifetime_throughput": 4897.927677187104}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 118000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 25, "trial_id": "76942_00000", "date": "2026-01-15_15-25-22", "timestamp": 1768487122, "time_this_iter_s": 23.178411722183228, "time_total_s": 642.4109461307526, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F77F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 642.4109461307526, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 24.5875, "ram_util_percent": 46.04062499999999}}
{"timers": {"training_iteration": 23.084053884203005, "restore_env_runners": 2.4956208112611084e-05, "training_step": 23.083574734008376, "env_runner_sampling_timer": 12.59281524349811, "learner_update_timer": 10.479803651905272, "synch_weights": 0.00446052913973224, "synch_env_connectors": 0.0033644453619469704}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.766530920516634e-05, "un_batch_to_individual_items": 9.806910835515772e-05, "normalize_and_clip_actions": 0.0001291986713543893, "tensor_to_numpy": 0.00013953515442029853, "get_actions": 0.0004406706076566957, "remove_single_ts_time_rank_from_batch": 4.868502205465852e-06, "module_to_agent_unmapping": 9.96190051073049e-06}}, "connector_pipeline_timer": 0.0010874590502000074}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 122000.0, "human_1": 122000.0, "human_2": 122000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 9.893170736997417, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010245302023648884, "add_observations_from_episodes_to_batch": 8.47253252017745e-05, "batch_individual_items": 6.769467242068145e-05, "add_states_from_episodes_to_batch": 1.3874917110735427e-05, "add_time_dim_to_batch_and_zero_pad": 2.7260868450706585e-05, "agent_to_module_mapping": 1.4895901540881122e-05}}, "connector_pipeline_timer": 0.0004899243369423014}, "module_episode_returns_mean": {"shared_policy": -6721.506103333335}, "rlmodule_inference_timer": 0.00045704535156328694, "time_between_sampling": 1.0664797872137783, "agent_episode_returns_mean": {"human_0": -2428.98421, "human_1": -2420.780165, "human_2": -2434.14784}, "episode_return_min": -9906.1265, "episode_len_min": 2000, "episode_return_mean": -7283.912215, "num_episodes_lifetime": 52.000000000000064, "sample": 1.6349304044731277, "num_env_steps_sampled_lifetime": 122000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 366000.0}, "num_episodes": 2.0, "env_step_timer": 0.003272351128286912, "episode_return_max": -2863.162000000001, "weights_seq_no": 25.0, "num_env_steps_sampled_lifetime_throughput": 161.26727440103878}, "learners": {"shared_policy": {"mean_kl_loss": 0.003155613085255027, "curr_kl_coeff": 3.051757857974735e-06, "policy_loss": 0.03503630682826042, "vf_loss": 9.389653205871582, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 907.5247802734375, "total_loss": 9.415865898132324, "weights_seq_no": 26.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 1.1920928955078125e-06, "num_module_steps_trained": 120832, "entropy": 0.8823538422584534, "num_module_steps_trained_lifetime": 3141632, "num_module_steps_trained_lifetime_throughput": 4875.523469825978}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1530425108241276, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011470786865660167, "agent_to_module_mapping": 0.021230503931636037, "general_advantage_estimation": 0.11772456821849109, "add_columns_from_episodes_to_train_batch": 0.46224224734903296, "batch_individual_items": 0.5072531040358023, "add_states_from_episodes_to_batch": 1.5920898229003224e-05, "add_one_ts_to_episodes_and_truncate": 0.03562392896678714, "add_time_dim_to_batch_and_zero_pad": 4.351339102779533e-05, "numpy_to_tensor": 0.006787197231929502}}}, "num_env_steps_trained_lifetime": 49088000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 3141632, "num_env_steps_trained_lifetime_throughput": 76180.08287525967, "num_module_steps_trained_lifetime_throughput": 4875.525464327397}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 122000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 26, "trial_id": "76942_00000", "date": "2026-01-15_15-25-49", "timestamp": 1768487149, "time_this_iter_s": 27.117319583892822, "time_total_s": 669.5282657146454, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F53F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 669.5282657146454, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 26.736842105263158, "ram_util_percent": 46.06052631578948}}
{"timers": {"training_iteration": 23.132415065360956, "restore_env_runners": 2.5098645960464178e-05, "training_step": 23.131932647668318, "env_runner_sampling_timer": 12.623323797063078, "learner_update_timer": 10.497621516386317, "synch_weights": 0.004461705848423283, "synch_env_connectors": 0.0033664369084298864}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.7049335017607274e-05, "un_batch_to_individual_items": 9.545138320633664e-05, "normalize_and_clip_actions": 0.0001251934510609107, "tensor_to_numpy": 0.00013558653360352623, "get_actions": 0.0004293765669034895, "remove_single_ts_time_rank_from_batch": 4.621197938366092e-06, "module_to_agent_unmapping": 9.603163013893623e-06}}, "connector_pipeline_timer": 0.0010595706359031814}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 126000.0, "human_1": 126000.0, "human_2": 126000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 10.486682789998738, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010304390187239086, "add_observations_from_episodes_to_batch": 8.360736122279925e-05, "batch_individual_items": 6.683205006729227e-05, "add_states_from_episodes_to_batch": 1.3780897393820417e-05, "add_time_dim_to_batch_and_zero_pad": 2.6961364258863576e-05, "agent_to_module_mapping": 1.4261409310830898e-05}}, "connector_pipeline_timer": 0.0004844005916088669}, "module_episode_returns_mean": {"shared_policy": -4884.702055000001}, "rlmodule_inference_timer": 0.00043611139138126614, "time_between_sampling": 1.0791026766081935, "agent_episode_returns_mean": {"human_0": -1785.3009066666664, "human_1": -1770.763311666667, "human_2": -1789.156656666667}, "episode_return_min": -7843.247, "episode_len_min": 2000, "episode_return_mean": -5345.220874999999, "num_episodes_lifetime": 54.000000000000064, "sample": 1.6255069435792482, "num_env_steps_sampled_lifetime": 126000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 378000.0}, "num_episodes": 2.0, "env_step_timer": 0.0032764922778417754, "episode_return_max": -2538.185000000001, "weights_seq_no": 26.0, "num_env_steps_sampled_lifetime_throughput": 160.5274338303823}, "learners": {"shared_policy": {"mean_kl_loss": 0.006130115129053593, "curr_kl_coeff": 3.051757857974735e-06, "policy_loss": -0.008656937628984451, "vf_loss": 9.161823272705078, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 573.7776489257812, "total_loss": 9.144876480102539, "weights_seq_no": 27.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 3.5762786865234375e-07, "num_module_steps_trained": 120832, "entropy": 0.8291487693786621, "num_module_steps_trained_lifetime": 3262464, "num_module_steps_trained_lifetime_throughput": 4847.718857267012}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1564703197159643, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011473018996865207, "agent_to_module_mapping": 0.021311069892302952, "general_advantage_estimation": 0.11790648953620665, "add_columns_from_episodes_to_train_batch": 0.46285500087567555, "batch_individual_items": 0.5099151129953909, "add_states_from_episodes_to_batch": 1.5935689261962666e-05, "add_one_ts_to_episodes_and_truncate": 0.035583781677258446, "add_time_dim_to_batch_and_zero_pad": 4.3700257051600225e-05, "numpy_to_tensor": 0.006721822259560587}}}, "num_env_steps_trained_lifetime": 50976000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 3262464, "num_env_steps_trained_lifetime_throughput": 75745.64109025976, "num_module_steps_trained_lifetime_throughput": 4847.7206493617705}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 126000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 27, "trial_id": "76942_00000", "date": "2026-01-15_15-26-17", "timestamp": 1768487177, "time_this_iter_s": 27.930554628372192, "time_total_s": 697.4588203430176, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F7EB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 697.4588203430176, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.58, "ram_util_percent": 46.065}}
{"timers": {"training_iteration": 23.18391639670739, "restore_env_runners": 2.508465955926464e-05, "training_step": 23.183431807191667, "env_runner_sampling_timer": 12.660448672092441, "learner_update_timer": 10.511943209222462, "synch_weights": 0.004472623789931283, "synch_env_connectors": 0.0033846895394372225}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.808668757033423e-05, "un_batch_to_individual_items": 9.833558863720716e-05, "normalize_and_clip_actions": 0.00012855517538115714, "tensor_to_numpy": 0.00014040076378085952, "get_actions": 0.00044837320550836863, "remove_single_ts_time_rank_from_batch": 4.71930336963034e-06, "module_to_agent_unmapping": 1.0256844806668748e-05}}, "connector_pipeline_timer": 0.0011000269236191781}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 130000.0, "human_1": 130000.0, "human_2": 130000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.321846078003288, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010152868656811338, "add_observations_from_episodes_to_batch": 8.610351874688811e-05, "batch_individual_items": 6.776856446005597e-05, "add_states_from_episodes_to_batch": 1.3810568009571529e-05, "add_time_dim_to_batch_and_zero_pad": 2.6627967929668305e-05, "agent_to_module_mapping": 1.4549607298016995e-05}}, "connector_pipeline_timer": 0.0004924105480003259}, "module_episode_returns_mean": {"shared_policy": -3565.023316666667}, "rlmodule_inference_timer": 0.00043189031301134296, "time_between_sampling": 1.0968484710130946, "agent_episode_returns_mean": {"human_0": -1294.130466666667, "human_1": -1283.0263566666667, "human_2": -1294.9004816666672}, "episode_return_min": -6955.143999999999, "episode_len_min": 2000, "episode_return_mean": -3872.0573050000007, "num_episodes_lifetime": 56.000000000000064, "sample": 1.6220572618288578, "num_env_steps_sampled_lifetime": 130000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 390000.0}, "num_episodes": 2.0, "env_step_timer": 0.003451012793039012, "episode_return_max": -2538.185000000001, "weights_seq_no": 27.0, "num_env_steps_sampled_lifetime_throughput": 159.47750230625135}, "learners": {"shared_policy": {"mean_kl_loss": 0.0029098333325237036, "curr_kl_coeff": 1.5258789289873675e-06, "policy_loss": 0.039876800030469894, "vf_loss": 9.277421951293945, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 789.6713256835938, "total_loss": 9.308979034423828, "weights_seq_no": 28.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.03341972827911377, "num_module_steps_trained": 120832, "entropy": 0.8321071267127991, "num_module_steps_trained_lifetime": 3383296, "num_module_steps_trained_lifetime_throughput": 4818.544701960729}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1571911795188459, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011479378807799324, "agent_to_module_mapping": 0.02135590019325244, "general_advantage_estimation": 0.11783184264087632, "add_columns_from_episodes_to_train_batch": 0.4631423168670018, "batch_individual_items": 0.5104449608654739, "add_states_from_episodes_to_batch": 1.5908332355822098e-05, "add_one_ts_to_episodes_and_truncate": 0.03558433386042848, "add_time_dim_to_batch_and_zero_pad": 4.364125444897967e-05, "numpy_to_tensor": 0.00665835903703565}}}, "num_env_steps_trained_lifetime": 52864000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 3383296, "num_env_steps_trained_lifetime_throughput": 75289.90275837471, "num_module_steps_trained_lifetime_throughput": 4818.54917496173}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 130000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 28, "trial_id": "76942_00000", "date": "2026-01-15_15-26-46", "timestamp": 1768487206, "time_this_iter_s": 28.297183513641357, "time_total_s": 725.7560038566589, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F63B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 725.7560038566589, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 25.98717948717949, "ram_util_percent": 46.12564102564101}}
{"timers": {"training_iteration": 23.23707001074033, "restore_env_runners": 2.511581307369099e-05, "training_step": 23.236584198119825, "env_runner_sampling_timer": 12.697051565371465, "learner_update_timer": 10.528452794130178, "synch_weights": 0.004463855551966878, "synch_env_connectors": 0.0034210936440402205}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.753880364423864e-05, "un_batch_to_individual_items": 9.774249098128739e-05, "normalize_and_clip_actions": 0.00013182999215081783, "tensor_to_numpy": 0.00014385985509937372, "get_actions": 0.00046587432745310496, "remove_single_ts_time_rank_from_batch": 5.07148882827805e-06, "module_to_agent_unmapping": 1.0294433567780487e-05}}, "connector_pipeline_timer": 0.00112366291887947}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 134000.0, "human_1": 134000.0, "human_2": 134000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.848231151004729, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011330254903684056, "add_observations_from_episodes_to_batch": 8.700900484765986e-05, "batch_individual_items": 7.260650103141628e-05, "add_states_from_episodes_to_batch": 1.498654185034764e-05, "add_time_dim_to_batch_and_zero_pad": 2.94073994266714e-05, "agent_to_module_mapping": 1.5131725377340006e-05}}, "connector_pipeline_timer": 0.0005162007386195095}, "module_episode_returns_mean": {"shared_policy": -2729.2558533333336}, "rlmodule_inference_timer": 0.00047099176632733354, "time_between_sampling": 1.1096924830211854, "agent_episode_returns_mean": {"human_0": -989.6895216666668, "human_1": -989.0689616666668, "human_2": -992.5522416666671}, "episode_return_min": -4299.4005, "episode_len_min": 2000, "episode_return_mean": -2971.310725000001, "num_episodes_lifetime": 58.000000000000064, "sample": 1.6208053488719962, "num_env_steps_sampled_lifetime": 134000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 402000.0}, "num_episodes": 2.0, "env_step_timer": 0.003399596980979291, "episode_return_max": -2538.185000000001, "weights_seq_no": 28.0, "num_env_steps_sampled_lifetime_throughput": 158.56440356496017}, "learners": {"shared_policy": {"mean_kl_loss": 0.0012498801806941628, "curr_kl_coeff": 7.629394644936838e-07, "policy_loss": -0.0016335531836375594, "vf_loss": 9.532339096069336, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 926.6231689453125, "total_loss": 9.52219009399414, "weights_seq_no": 29.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.006784319877624512, "num_module_steps_trained": 120832, "entropy": 0.8515505790710449, "num_module_steps_trained_lifetime": 3504128, "num_module_steps_trained_lifetime_throughput": 4789.1630050983285}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1609818337236244, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011486225020446495, "agent_to_module_mapping": 0.021397595191396005, "general_advantage_estimation": 0.11797516021453361, "add_columns_from_episodes_to_train_batch": 0.46437676969835706, "batch_individual_items": 0.5128201962568175, "add_states_from_episodes_to_batch": 1.590724907120061e-05, "add_one_ts_to_episodes_and_truncate": 0.03564684652183342, "add_time_dim_to_batch_and_zero_pad": 4.367584185293745e-05, "numpy_to_tensor": 0.006594143446652039}}}, "num_env_steps_trained_lifetime": 54752000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 3504128, "num_env_steps_trained_lifetime_throughput": 74830.701557094, "num_module_steps_trained_lifetime_throughput": 4789.164819721128}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 134000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 29, "trial_id": "76942_00000", "date": "2026-01-15_15-27-14", "timestamp": 1768487234, "time_this_iter_s": 28.50816297531128, "time_total_s": 754.2641668319702, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F7760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 754.2641668319702, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.020000000000003, "ram_util_percent": 46.129999999999995}}
{"timers": {"training_iteration": 23.292549982632984, "restore_env_runners": 2.5082654856683807e-05, "training_step": 23.29206342813868, "env_runner_sampling_timer": 12.736843720717783, "learner_update_timer": 10.544092871188912, "synch_weights": 0.0044735109964486, "synch_env_connectors": 0.0034215747076445607}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.89292672012027e-05, "un_batch_to_individual_items": 9.963115142636593e-05, "normalize_and_clip_actions": 0.00013386872394731178, "tensor_to_numpy": 0.0001443270757600053, "get_actions": 0.00046684307773772776, "remove_single_ts_time_rank_from_batch": 4.939712182809769e-06, "module_to_agent_unmapping": 1.0756973926995783e-05}}, "connector_pipeline_timer": 0.0011344072206000738}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 138000.0, "human_1": 138000.0, "human_2": 138000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.97969580499281, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011485805785898653, "add_observations_from_episodes_to_batch": 8.794879540411838e-05, "batch_individual_items": 7.391998782037764e-05, "add_states_from_episodes_to_batch": 1.4535906768377011e-05, "add_time_dim_to_batch_and_zero_pad": 2.9364316891148398e-05, "agent_to_module_mapping": 1.5036271937989847e-05}}, "connector_pipeline_timer": 0.0005201852886768994}, "module_episode_returns_mean": {"shared_policy": -2560.9905150000004}, "rlmodule_inference_timer": 0.0004721759366380131, "time_between_sampling": 1.123601498239228, "agent_episode_returns_mean": {"human_0": -927.5810216666666, "human_1": -932.7117616666667, "human_2": -931.354896666667}, "episode_return_min": -3708.7030000000013, "episode_len_min": 2000, "episode_return_mean": -2791.64768, "num_episodes_lifetime": 60.000000000000064, "sample": 1.6217821310460423, "num_env_steps_sampled_lifetime": 138000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 414000.0}, "num_episodes": 2.0, "env_step_timer": 0.0034548857280383913, "episode_return_max": -2473.8379999999993, "weights_seq_no": 29.0, "num_env_steps_sampled_lifetime_throughput": 157.5555250123253}, "learners": {"shared_policy": {"mean_kl_loss": 0.002398007083684206, "curr_kl_coeff": 3.814697322468419e-07, "policy_loss": -0.04558008536696434, "vf_loss": 9.046561241149902, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 344.794189453125, "total_loss": 8.992753028869629, "weights_seq_no": 30.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.10626286268234253, "num_module_steps_trained": 120832, "entropy": 0.8228985667228699, "num_module_steps_trained_lifetime": 3624960, "num_module_steps_trained_lifetime_throughput": 4759.239717690615}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1617092753863012, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011529442770497752, "agent_to_module_mapping": 0.021427329239404477, "general_advantage_estimation": 0.11796057261236463, "add_columns_from_episodes_to_train_batch": 0.46478373400146417, "batch_individual_items": 0.5131435762941999, "add_states_from_episodes_to_batch": 1.589517653566591e-05, "add_one_ts_to_episodes_and_truncate": 0.035691729056506374, "add_time_dim_to_batch_and_zero_pad": 4.370808351314581e-05, "numpy_to_tensor": 0.006530681012289877}}}, "num_env_steps_trained_lifetime": 56640000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 3624960, "num_env_steps_trained_lifetime_throughput": 74363.1363685732, "num_module_steps_trained_lifetime_throughput": 4759.241646514529}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 138000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 30, "trial_id": "76942_00000", "date": "2026-01-15_15-27-43", "timestamp": 1768487263, "time_this_iter_s": 28.795262336730957, "time_total_s": 783.0594291687012, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0173E5F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 783.0594291687012, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.54390243902439, "ram_util_percent": 46.048780487804876}}
{"timers": {"training_iteration": 23.348035950806633, "restore_env_runners": 2.512782837921972e-05, "training_step": 23.347546992857215, "env_runner_sampling_timer": 12.772914683510667, "learner_update_timer": 10.563456249477035, "synch_weights": 0.004473957886514877, "synch_env_connectors": 0.003428581960575564}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.8401365916762535e-05, "un_batch_to_individual_items": 9.943116439875334e-05, "normalize_and_clip_actions": 0.0001315968014492211, "tensor_to_numpy": 0.00014531085058611614, "get_actions": 0.0004634334318372174, "remove_single_ts_time_rank_from_batch": 4.932079763333544e-06, "module_to_agent_unmapping": 1.0270155052427574e-05}}, "connector_pipeline_timer": 0.0011321251590284504}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 142000.0, "human_1": 142000.0, "human_2": 142000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.147803664987295, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011078632710028458, "add_observations_from_episodes_to_batch": 8.571590233806779e-05, "batch_individual_items": 6.953994041289187e-05, "add_states_from_episodes_to_batch": 1.3885976814195948e-05, "add_time_dim_to_batch_and_zero_pad": 2.787292405695478e-05, "agent_to_module_mapping": 1.4814104216686612e-05}}, "connector_pipeline_timer": 0.0005046841034365468}, "module_episode_returns_mean": {"shared_policy": -2452.165875}, "rlmodule_inference_timer": 0.00044849427705449243, "time_between_sampling": 1.1362004119847833, "agent_episode_returns_mean": {"human_0": -881.8491, "human_1": -891.823395, "human_2": -893.2536650000002}, "episode_return_min": -3143.3035000000004, "episode_len_min": 2000, "episode_return_mean": -2666.926159999999, "num_episodes_lifetime": 62.000000000000064, "sample": 1.6197072338649563, "num_env_steps_sampled_lifetime": 142000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 426000.0}, "num_episodes": 2.0, "env_step_timer": 0.0034131450534506023, "episode_return_max": -2225.1455000000005, "weights_seq_no": 30.0, "num_env_steps_sampled_lifetime_throughput": 156.67285754031678}, "learners": {"shared_policy": {"mean_kl_loss": 0.0030409134924411774, "curr_kl_coeff": 1.9073486612342094e-07, "policy_loss": 0.025458961725234985, "vf_loss": 9.636353492736816, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 1067.25244140625, "total_loss": 9.653678894042969, "weights_seq_no": 31.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.013812720775604248, "num_module_steps_trained": 120832, "entropy": 0.8134520649909973, "num_module_steps_trained_lifetime": 3745792, "num_module_steps_trained_lifetime_throughput": 4729.754530390862}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1633154396325014, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001156180834374101, "agent_to_module_mapping": 0.021440466947097593, "general_advantage_estimation": 0.11821886788626759, "add_columns_from_episodes_to_train_batch": 0.46532469066143645, "batch_individual_items": 0.5139143365312098, "add_states_from_episodes_to_batch": 1.586822475678831e-05, "add_one_ts_to_episodes_and_truncate": 0.03577427376586337, "add_time_dim_to_batch_and_zero_pad": 4.382400266877377e-05, "numpy_to_tensor": 0.006470642202116843}}}, "num_env_steps_trained_lifetime": 58528000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 3745792, "num_env_steps_trained_lifetime_throughput": 73902.55770787415, "num_module_steps_trained_lifetime_throughput": 4729.759271301812}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 142000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 31, "trial_id": "76942_00000", "date": "2026-01-15_15-28-12", "timestamp": 1768487292, "time_this_iter_s": 28.853909254074097, "time_total_s": 811.9133384227753, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA01BE43A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 811.9133384227753, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 31.110000000000003, "ram_util_percent": 46.05499999999999}}
{"timers": {"training_iteration": 23.392381870298564, "restore_env_runners": 2.511855004638594e-05, "training_step": 23.39189006692868, "env_runner_sampling_timer": 12.810972379675658, "learner_update_timer": 10.569703405982203, "synch_weights": 0.004477446307591174, "synch_env_connectors": 0.0034462891409125485}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.8192810187407204e-05, "un_batch_to_individual_items": 9.918889347699966e-05, "normalize_and_clip_actions": 0.00013095924054381348, "tensor_to_numpy": 0.00015071373947736985, "get_actions": 0.0004442538418630112, "remove_single_ts_time_rank_from_batch": 4.792966867798116e-06, "module_to_agent_unmapping": 1.009974885618922e-05}}, "connector_pipeline_timer": 0.0011094951252900984}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 146000.0, "human_1": 146000.0, "human_2": 146000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.159514441995999, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010514222846603868, "add_observations_from_episodes_to_batch": 8.495855273777953e-05, "batch_individual_items": 6.930579110530342e-05, "add_states_from_episodes_to_batch": 1.398214655507191e-05, "add_time_dim_to_batch_and_zero_pad": 2.7409236858077325e-05, "agent_to_module_mapping": 1.462860365473192e-05}}, "connector_pipeline_timer": 0.0004944291046565244}, "module_episode_returns_mean": {"shared_policy": -2309.445268333334}, "rlmodule_inference_timer": 0.0004416156135652146, "time_between_sampling": 1.1509441856504865, "agent_episode_returns_mean": {"human_0": -818.0125583333335, "human_1": -835.8060133333336, "human_2": -833.0109933333332}, "episode_return_min": -3143.3035000000004, "episode_len_min": 2000, "episode_return_mean": -2486.829565, "num_episodes_lifetime": 64.00000000000006, "sample": 1.6197500966774725, "num_env_steps_sampled_lifetime": 146000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 438000.0}, "num_episodes": 2.0, "env_step_timer": 0.0034323199715519124, "episode_return_max": -1903.8755000000006, "weights_seq_no": 31.0, "num_env_steps_sampled_lifetime_throughput": 155.70279429524044}, "learners": {"shared_policy": {"mean_kl_loss": 0.002493400825187564, "curr_kl_coeff": 9.536743306171047e-08, "policy_loss": -0.02163165993988514, "vf_loss": 8.48929500579834, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 231.69309997558594, "total_loss": 8.459840774536133, "weights_seq_no": 32.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.007643282413482666, "num_module_steps_trained": 120832, "entropy": 0.7822859883308411, "num_module_steps_trained_lifetime": 3866624, "num_module_steps_trained_lifetime_throughput": 4710.225272664038}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.163089260236167, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011569290260504393, "agent_to_module_mapping": 0.021436130277641487, "general_advantage_estimation": 0.11816210120744591, "add_columns_from_episodes_to_train_batch": 0.4654632297548091, "batch_individual_items": 0.5137138431660105, "add_states_from_episodes_to_batch": 1.582054248131428e-05, "add_one_ts_to_episodes_and_truncate": 0.0357372050281634, "add_time_dim_to_batch_and_zero_pad": 4.3755762694584684e-05, "numpy_to_tensor": 0.006408395780055358}}}, "num_env_steps_trained_lifetime": 60416000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 3866624, "num_env_steps_trained_lifetime_throughput": 73597.28185227867, "num_module_steps_trained_lifetime_throughput": 4710.227542831262}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 146000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 32, "trial_id": "76942_00000", "date": "2026-01-15_15-28-40", "timestamp": 1768487320, "time_this_iter_s": 27.79049563407898, "time_total_s": 839.7038340568542, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0173FF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 839.7038340568542, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 28.487179487179493, "ram_util_percent": 46.07179487179488}}
{"timers": {"training_iteration": 23.42792057559555, "restore_env_runners": 2.5133364534109182e-05, "training_step": 23.427426698259385, "env_runner_sampling_timer": 12.84135716587892, "learner_update_timer": 10.574793946922375, "synch_weights": 0.00448370584457718, "synch_env_connectors": 0.0034463082495498325}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.819063980243691e-05, "un_batch_to_individual_items": 9.80249634905073e-05, "normalize_and_clip_actions": 0.00012786646819045965, "tensor_to_numpy": 0.00013803176583724295, "get_actions": 0.0004375398258839792, "remove_single_ts_time_rank_from_batch": 4.809196860692166e-06, "module_to_agent_unmapping": 9.95705357077339e-06}}, "connector_pipeline_timer": 0.0010823017906013185}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 150000.0, "human_1": 150000.0, "human_2": 150000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.094263747006188, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010153674625453438, "add_observations_from_episodes_to_batch": 8.312020206386079e-05, "batch_individual_items": 6.682131891345576e-05, "add_states_from_episodes_to_batch": 1.3928592086757486e-05, "add_time_dim_to_batch_and_zero_pad": 2.6907439540541762e-05, "agent_to_module_mapping": 1.4495087285425535e-05}}, "connector_pipeline_timer": 0.00048544643816924096}, "module_episode_returns_mean": {"shared_policy": -2032.7355450000002}, "rlmodule_inference_timer": 0.00044105581166653735, "time_between_sampling": 1.152300418550578, "agent_episode_returns_mean": {"human_0": -715.0973466666666, "human_1": -732.8236766666668, "human_2": -731.2486716666666}, "episode_return_min": -2609.3295000000007, "episode_len_min": 2000, "episode_return_mean": -2179.169695, "num_episodes_lifetime": 66.00000000000006, "sample": 1.6143330298066114, "num_env_steps_sampled_lifetime": 150000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 450000.0}, "num_episodes": 2.0, "env_step_timer": 0.003391311667035906, "episode_return_max": -1624.249, "weights_seq_no": 32.0, "num_env_steps_sampled_lifetime_throughput": 155.29658570880676}, "learners": {"shared_policy": {"mean_kl_loss": 0.001851918175816536, "curr_kl_coeff": 4.7683716530855236e-08, "policy_loss": -0.017537614330649376, "vf_loss": 8.605916976928711, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 192.2986297607422, "total_loss": 8.580669403076172, "weights_seq_no": 33.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.03185760974884033, "num_module_steps_trained": 120832, "entropy": 0.7709420323371887, "num_module_steps_trained_lifetime": 3987456, "num_module_steps_trained_lifetime_throughput": 4698.516674586587}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.163186373633854, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011566447357176737, "agent_to_module_mapping": 0.021418530974842826, "general_advantage_estimation": 0.11837204619531894, "add_columns_from_episodes_to_train_batch": 0.46549451645715506, "batch_individual_items": 0.5136829007343293, "add_states_from_episodes_to_batch": 1.5770337005751504e-05, "add_one_ts_to_episodes_and_truncate": 0.035707524977873425, "add_time_dim_to_batch_and_zero_pad": 4.374920500254497e-05, "numpy_to_tensor": 0.006346924822215352}}}, "num_env_steps_trained_lifetime": 62304000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 3987456, "num_env_steps_trained_lifetime_throughput": 73414.59675689242, "num_module_steps_trained_lifetime_throughput": 4698.521797610909}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 150000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 33, "trial_id": "76942_00000", "date": "2026-01-15_15-29-07", "timestamp": 1768487347, "time_this_iter_s": 26.959572792053223, "time_total_s": 866.6634068489075, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F63B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 866.6634068489075, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.092105263157897, "ram_util_percent": 45.892105263157895}}
{"timers": {"training_iteration": 23.467753291839603, "restore_env_runners": 2.5166030868496923e-05, "training_step": 23.467256165276883, "env_runner_sampling_timer": 12.875750173220156, "learner_update_timer": 10.580202214453173, "synch_weights": 0.0044783717861386525, "synch_env_connectors": 0.00346386816707999}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.9162623015265614e-05, "un_batch_to_individual_items": 9.653315555562148e-05, "normalize_and_clip_actions": 0.0001306035849798441, "tensor_to_numpy": 0.00013551801238367883, "get_actions": 0.00044884595377764726, "remove_single_ts_time_rank_from_batch": 4.638026527162502e-06, "module_to_agent_unmapping": 1.0000215545479191e-05}}, "connector_pipeline_timer": 0.0010897566437065292}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 154000.0, "human_1": 154000.0, "human_2": 154000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.967882650000975, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010006329612553793, "add_observations_from_episodes_to_batch": 8.206707996477635e-05, "batch_individual_items": 6.628307275948536e-05, "add_states_from_episodes_to_batch": 1.3542615349656682e-05, "add_time_dim_to_batch_and_zero_pad": 2.633617039388448e-05, "agent_to_module_mapping": 1.4525836014192878e-05}}, "connector_pipeline_timer": 0.0004783824393618679}, "module_episode_returns_mean": {"shared_policy": -1785.9508250000001}, "rlmodule_inference_timer": 0.00043101507467836894, "time_between_sampling": 1.1533431292915586, "agent_episode_returns_mean": {"human_0": -632.4627, "human_1": -647.349445, "human_2": -646.7719400000001}, "episode_return_min": -2395.5514999999996, "episode_len_min": 2000, "episode_return_mean": -1926.5840850000004, "num_episodes_lifetime": 68.00000000000006, "sample": 1.6101293065827256, "num_env_steps_sampled_lifetime": 154000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 462000.0}, "num_episodes": 2.0, "env_step_timer": 0.003380956377001477, "episode_return_max": -1620.7154999999993, "weights_seq_no": 33.0, "num_env_steps_sampled_lifetime_throughput": 154.82029619638163}, "learners": {"shared_policy": {"mean_kl_loss": 0.0025820033624768257, "curr_kl_coeff": 2.3841858265427618e-08, "policy_loss": -0.08004559576511383, "vf_loss": 8.51852035522461, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 203.29054260253906, "total_loss": 8.430547714233398, "weights_seq_no": 34.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.031720638275146484, "num_module_steps_trained": 120832, "entropy": 0.7927268743515015, "num_module_steps_trained_lifetime": 4108288, "num_module_steps_trained_lifetime_throughput": 4683.473403493508}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1636042398975142, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011622222883726917, "agent_to_module_mapping": 0.021401713665029923, "general_advantage_estimation": 0.11838852473337927, "add_columns_from_episodes_to_train_batch": 0.46609131029252465, "batch_individual_items": 0.5135735687269597, "add_states_from_episodes_to_batch": 1.573263367631828e-05, "add_one_ts_to_episodes_and_truncate": 0.035695771728015684, "add_time_dim_to_batch_and_zero_pad": 4.3802712907737806e-05, "numpy_to_tensor": 0.006287898574063948}}}, "num_env_steps_trained_lifetime": 64192000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 4108288, "num_env_steps_trained_lifetime_throughput": 73179.26226971204, "num_module_steps_trained_lifetime_throughput": 4683.473864238421}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 154000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 34, "trial_id": "76942_00000", "date": "2026-01-15_15-29-34", "timestamp": 1768487374, "time_this_iter_s": 27.419180870056152, "time_total_s": 894.0825877189636, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F6B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 894.0825877189636, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 23.45, "ram_util_percent": 45.67894736842104}}
{"timers": {"training_iteration": 23.505347980921236, "restore_env_runners": 2.5124370558144887e-05, "training_step": 23.504850333624088, "env_runner_sampling_timer": 12.90695248848801, "learner_update_timer": 10.58656316230856, "synch_weights": 0.004474636068261851, "synch_env_connectors": 0.0034675644853993737}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.838513841365613e-05, "un_batch_to_individual_items": 9.814044771430724e-05, "normalize_and_clip_actions": 0.00012666601152871388, "tensor_to_numpy": 0.00013568177873943613, "get_actions": 0.0004334372830369017, "remove_single_ts_time_rank_from_batch": 4.690405830017769e-06, "module_to_agent_unmapping": 9.791722827926498e-06}}, "connector_pipeline_timer": 0.0010733638812500887}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 158000.0, "human_1": 158000.0, "human_2": 158000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.863816720992473, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.940106348998159e-05, "add_observations_from_episodes_to_batch": 8.238256661863153e-05, "batch_individual_items": 6.717579923035753e-05, "add_states_from_episodes_to_batch": 1.3776554616879388e-05, "add_time_dim_to_batch_and_zero_pad": 2.6759703500400294e-05, "agent_to_module_mapping": 1.4416148000631392e-05}}, "connector_pipeline_timer": 0.0004829737298738488}, "module_episode_returns_mean": {"shared_policy": -1621.57298}, "rlmodule_inference_timer": 0.0004285342121915175, "time_between_sampling": 1.153389444865871, "agent_episode_returns_mean": {"human_0": -584.5158, "human_1": -591.0337549999998, "human_2": -590.9625549999998}, "episode_return_min": -1960.3359999999996, "episode_len_min": 2000, "episode_return_mean": -1766.5121100000001, "num_episodes_lifetime": 70.00000000000006, "sample": 1.6067414112838538, "num_env_steps_sampled_lifetime": 158000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 474000.0}, "num_episodes": 2.0, "env_step_timer": 0.003387917759444167, "episode_return_max": -1620.7154999999993, "weights_seq_no": 34.0, "num_env_steps_sampled_lifetime_throughput": 154.43788138053708}, "learners": {"shared_policy": {"mean_kl_loss": 0.003265869338065386, "curr_kl_coeff": 1.1920929132713809e-08, "policy_loss": -0.0058692991733551025, "vf_loss": 8.51653003692627, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 148.1932830810547, "total_loss": 8.503033638000488, "weights_seq_no": 35.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.07423484325408936, "num_module_steps_trained": 120832, "entropy": 0.7626594305038452, "num_module_steps_trained_lifetime": 4229120, "num_module_steps_trained_lifetime_throughput": 4670.763981866313}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1636834564984413, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011685550654191902, "agent_to_module_mapping": 0.021433377528467266, "general_advantage_estimation": 0.11845180548600284, "add_columns_from_episodes_to_train_batch": 0.4664211111896135, "batch_individual_items": 0.5133064930397557, "add_states_from_episodes_to_batch": 1.5718307409793582e-05, "add_one_ts_to_episodes_and_truncate": 0.03567534101077138, "add_time_dim_to_batch_and_zero_pad": 4.383168569665003e-05, "numpy_to_tensor": 0.006227427588323595}}}, "num_env_steps_trained_lifetime": 66080000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 4229120, "num_env_steps_trained_lifetime_throughput": 72980.79601018585, "num_module_steps_trained_lifetime_throughput": 4670.766952455483}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 158000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 35, "trial_id": "76942_00000", "date": "2026-01-15_15-30-02", "timestamp": 1768487402, "time_this_iter_s": 27.23641538619995, "time_total_s": 921.3190031051636, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA01BE5870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 921.3190031051636, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 22.77179487179487, "ram_util_percent": 45.51538461538461}}
{"timers": {"training_iteration": 23.555188674111943, "restore_env_runners": 2.515012692450997e-05, "training_step": 23.55468724128784, "env_runner_sampling_timer": 12.94279504660322, "learner_update_timer": 10.600517001685411, "synch_weights": 0.004476006707599109, "synch_env_connectors": 0.0034790808405542667}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.814303094554586e-05, "un_batch_to_individual_items": 9.961812999959027e-05, "normalize_and_clip_actions": 0.00013014911358261202, "tensor_to_numpy": 0.00014059711271776964, "get_actions": 0.0004542169469094662, "remove_single_ts_time_rank_from_batch": 4.757057987993116e-06, "module_to_agent_unmapping": 9.973075461723603e-06}}, "connector_pipeline_timer": 0.0011088756070416297}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 162000.0, "human_1": 162000.0, "human_2": 162000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.817592559997284, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010621991144672397, "add_observations_from_episodes_to_batch": 8.816207270511233e-05, "batch_individual_items": 6.981014627120424e-05, "add_states_from_episodes_to_batch": 1.3844279208337943e-05, "add_time_dim_to_batch_and_zero_pad": 2.7804921288953587e-05, "agent_to_module_mapping": 1.6204247204410943e-05}}, "connector_pipeline_timer": 0.0005045356843362031}, "module_episode_returns_mean": {"shared_policy": -1573.4864399999997}, "rlmodule_inference_timer": 0.00044889135671470523, "time_between_sampling": 1.1550123565189292, "agent_episode_returns_mean": {"human_0": -572.3872783333333, "human_1": -578.5912683333331, "human_2": -573.5858733333333}, "episode_return_min": -1921.2455000000004, "episode_len_min": 2000, "episode_return_mean": -1724.5644200000004, "num_episodes_lifetime": 72.00000000000006, "sample": 1.6040232285713825, "num_env_steps_sampled_lifetime": 162000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 486000.0}, "num_episodes": 2.0, "env_step_timer": 0.003436391002406823, "episode_return_max": -1347.4394999999995, "weights_seq_no": 35.0, "num_env_steps_sampled_lifetime_throughput": 153.9164401825537}, "learners": {"shared_policy": {"mean_kl_loss": 0.003520961618050933, "curr_kl_coeff": 5.9604645663569045e-09, "policy_loss": 0.15518778562545776, "vf_loss": 7.534968852996826, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 127.20600891113281, "total_loss": 7.682488441467285, "weights_seq_no": 36.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.0013346672058105469, "num_module_steps_trained": 120832, "entropy": 0.7668198943138123, "num_module_steps_trained_lifetime": 4349952, "num_module_steps_trained_lifetime_throughput": 4648.902026718812}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1654697729334813, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011778485147294255, "agent_to_module_mapping": 0.021444735753131643, "general_advantage_estimation": 0.11853617043115437, "add_columns_from_episodes_to_train_batch": 0.46761916807762716, "batch_individual_items": 0.5137959451093689, "add_states_from_episodes_to_batch": 1.5672124307789497e-05, "add_one_ts_to_episodes_and_truncate": 0.03573268260067831, "add_time_dim_to_batch_and_zero_pad": 4.3792368821964184e-05, "numpy_to_tensor": 0.0061676743124279695}}}, "num_env_steps_trained_lifetime": 67968000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 4349952, "num_env_steps_trained_lifetime_throughput": 72639.15405493109, "num_module_steps_trained_lifetime_throughput": 4648.903617665663}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 162000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 36, "trial_id": "76942_00000", "date": "2026-01-15_15-30-30", "timestamp": 1768487430, "time_this_iter_s": 28.49762201309204, "time_total_s": 949.8166251182556, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F5870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 949.8166251182556, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 28.95, "ram_util_percent": 45.41}}
{"timers": {"training_iteration": 23.59806664537084, "restore_env_runners": 2.5112625684055774e-05, "training_step": 23.597564678874935, "env_runner_sampling_timer": 12.976752594137176, "learner_update_timer": 10.609414972668661, "synch_weights": 0.004468198640605356, "synch_env_connectors": 0.0034845970321662157}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.840210648940138e-05, "un_batch_to_individual_items": 9.804166876313258e-05, "normalize_and_clip_actions": 0.00012805721035501078, "tensor_to_numpy": 0.0001395834392975554, "get_actions": 0.0004537866377909628, "remove_single_ts_time_rank_from_batch": 4.702035873682127e-06, "module_to_agent_unmapping": 1.0415769182397332e-05}}, "connector_pipeline_timer": 0.0011030710375136141}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 166000.0, "human_1": 166000.0, "human_2": 166000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.92901908600528, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.000105355484125912, "add_observations_from_episodes_to_batch": 8.536566944064469e-05, "batch_individual_items": 6.876828091578609e-05, "add_states_from_episodes_to_batch": 1.3724461107843993e-05, "add_time_dim_to_batch_and_zero_pad": 2.7774344670366997e-05, "agent_to_module_mapping": 1.5424835242607984e-05}}, "connector_pipeline_timer": 0.0004979069723944852}, "module_episode_returns_mean": {"shared_policy": -1465.210953333333}, "rlmodule_inference_timer": 0.00046881809220686256, "time_between_sampling": 1.1638622022790455, "agent_episode_returns_mean": {"human_0": -528.69159, "human_1": -537.1008149999999, "human_2": -531.5668299999998}, "episode_return_min": -1795.9175, "episode_len_min": 2000, "episode_return_mean": -1597.3592349999997, "num_episodes_lifetime": 74.00000000000006, "sample": 1.604834029638076, "num_env_steps_sampled_lifetime": 166000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 498000.0}, "num_episodes": 2.0, "env_step_timer": 0.0034464704839359305, "episode_return_max": -1347.4394999999995, "weights_seq_no": 36.0, "num_env_steps_sampled_lifetime_throughput": 153.26497510480584}, "learners": {"shared_policy": {"mean_kl_loss": 0.002042327541857958, "curr_kl_coeff": 2.9802322831784522e-09, "policy_loss": 0.10054605454206467, "vf_loss": 8.012158393859863, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 141.97511291503906, "total_loss": 8.10506534576416, "weights_seq_no": 37.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.11025834083557129, "num_module_steps_trained": 120832, "entropy": 0.7638808488845825, "num_module_steps_trained_lifetime": 4470784, "num_module_steps_trained_lifetime_throughput": 4633.006143836298}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.166663419204232, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001188760029623752, "agent_to_module_mapping": 0.021442907395540205, "general_advantage_estimation": 0.11870393272685849, "add_columns_from_episodes_to_train_batch": 0.4680062683969735, "batch_individual_items": 0.5143798746583992, "add_states_from_episodes_to_batch": 1.5832403004680412e-05, "add_one_ts_to_episodes_and_truncate": 0.0358361577746875, "add_time_dim_to_batch_and_zero_pad": 4.4072445071222994e-05, "numpy_to_tensor": 0.006110879569370262}}}, "num_env_steps_trained_lifetime": 69856000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 4470784, "num_env_steps_trained_lifetime_throughput": 72390.72512337341, "num_module_steps_trained_lifetime_throughput": 4633.006839475908}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 166000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 37, "trial_id": "76942_00000", "date": "2026-01-15_15-30-58", "timestamp": 1768487458, "time_this_iter_s": 27.85057759284973, "time_total_s": 977.6672027111053, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F4D30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 977.6672027111053, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 26.807894736842105, "ram_util_percent": 45.47894736842107}}
{"timers": {"training_iteration": 23.63865096091711, "restore_env_runners": 2.5174499482245203e-05, "training_step": 23.638145572086206, "env_runner_sampling_timer": 13.008329821195817, "learner_update_timer": 10.61838739194202, "synch_weights": 0.004464249654259147, "synch_env_connectors": 0.0034835590618519647}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.743551381583147e-05, "un_batch_to_individual_items": 9.746011230024688e-05, "normalize_and_clip_actions": 0.00012891798570255437, "tensor_to_numpy": 0.00014039755621822887, "get_actions": 0.00044761399357219395, "remove_single_ts_time_rank_from_batch": 4.700565433035623e-06, "module_to_agent_unmapping": 9.799249128959933e-06}}, "connector_pipeline_timer": 0.00109829877616095}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 170000.0, "human_1": 170000.0, "human_2": 170000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.010273342004803, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010452622977287196, "add_observations_from_episodes_to_batch": 9.080920926469354e-05, "batch_individual_items": 6.883339992380361e-05, "add_states_from_episodes_to_batch": 1.3635622160943655e-05, "add_time_dim_to_batch_and_zero_pad": 2.7956593806004345e-05, "agent_to_module_mapping": 1.489411473481001e-05}}, "connector_pipeline_timer": 0.0005000376783312029}, "module_episode_returns_mean": {"shared_policy": -1380.5860316666665}, "rlmodule_inference_timer": 0.00045234135336331526, "time_between_sampling": 1.1660624089775184, "agent_episode_returns_mean": {"human_0": -494.60607666666647, "human_1": -502.17174166666666, "human_2": -496.8251366666664}, "episode_return_min": -1795.9175, "episode_len_min": 2000, "episode_return_mean": -1493.6029549999992, "num_episodes_lifetime": 76.00000000000006, "sample": 1.6034920065876233, "num_env_steps_sampled_lifetime": 170000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 510000.0}, "num_episodes": 2.0, "env_step_timer": 0.0033725822275900174, "episode_return_max": -1347.4394999999995, "weights_seq_no": 37.0, "num_env_steps_sampled_lifetime_throughput": 152.8246287805985}, "learners": {"shared_policy": {"mean_kl_loss": 0.003631405998021364, "curr_kl_coeff": 1.4901161415892261e-09, "policy_loss": -0.05004999041557312, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 1627.1773681640625, "total_loss": 9.942975997924805, "weights_seq_no": 38.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.02076888084411621, "num_module_steps_trained": 120832, "entropy": 0.6973565220832825, "num_module_steps_trained_lifetime": 4591616, "num_module_steps_trained_lifetime_throughput": 4619.416375976063}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1689135330122364, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011878934294278142, "agent_to_module_mapping": 0.02144833432162453, "general_advantage_estimation": 0.11892752539963272, "add_columns_from_episodes_to_train_batch": 0.4683338997129455, "batch_individual_items": 0.5161229609118005, "add_states_from_episodes_to_batch": 1.5796079030486886e-05, "add_one_ts_to_episodes_and_truncate": 0.03584898819696116, "add_time_dim_to_batch_and_zero_pad": 4.3964720682311464e-05, "numpy_to_tensor": 0.006053541773723541}}}, "num_env_steps_trained_lifetime": 71744000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 4591616, "num_env_steps_trained_lifetime_throughput": 72178.37276719675, "num_module_steps_trained_lifetime_throughput": 4619.416640948341}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 170000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 38, "trial_id": "76942_00000", "date": "2026-01-15_15-31-26", "timestamp": 1768487486, "time_this_iter_s": 27.666882753372192, "time_total_s": 1005.3340854644775, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA01BE5870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1005.3340854644775, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 24.553846153846155, "ram_util_percent": 45.32051282051282}}
{"timers": {"training_iteration": 23.673023634307985, "restore_env_runners": 2.519075434531969e-05, "training_step": 23.672516527365335, "env_runner_sampling_timer": 13.038661452983828, "learner_update_timer": 10.622405315022645, "synch_weights": 0.004463838157781893, "synch_env_connectors": 0.0034915634713299205}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.794835517633343e-05, "un_batch_to_individual_items": 9.949337909315517e-05, "normalize_and_clip_actions": 0.00012927599288247005, "tensor_to_numpy": 0.0001386618400810129, "get_actions": 0.0004445066996903108, "remove_single_ts_time_rank_from_batch": 4.836670198887322e-06, "module_to_agent_unmapping": 1.0077599684372901e-05}}, "connector_pipeline_timer": 0.0010955828857208243}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 174000.0, "human_1": 174000.0, "human_2": 174000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 12.007699794997318, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010207414642274123, "add_observations_from_episodes_to_batch": 8.444341251316492e-05, "batch_individual_items": 6.799228560507812e-05, "add_states_from_episodes_to_batch": 1.3688130464956545e-05, "add_time_dim_to_batch_and_zero_pad": 2.727839067043447e-05, "agent_to_module_mapping": 1.4682052337204634e-05}}, "connector_pipeline_timer": 0.0004887745270028589}, "module_episode_returns_mean": {"shared_policy": -1366.138446666666}, "rlmodule_inference_timer": 0.00045589772353728356, "time_between_sampling": 1.1683983951962467, "agent_episode_returns_mean": {"human_0": -490.1406849999998, "human_1": -496.34376999999995, "human_2": -492.4005949999997}, "episode_return_min": -1666.0665, "episode_len_min": 2000, "episode_return_mean": -1478.8850499999999, "num_episodes_lifetime": 78.00000000000006, "sample": 1.599838159033224, "num_env_steps_sampled_lifetime": 174000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 522000.0}, "num_episodes": 2.0, "env_step_timer": 0.003362733184600988, "episode_return_max": -1347.4394999999995, "weights_seq_no": 38.0, "num_env_steps_sampled_lifetime_throughput": 152.42554132991734}, "learners": {"shared_policy": {"mean_kl_loss": 0.009398859925568104, "curr_kl_coeff": 1.4901161415892261e-09, "policy_loss": -0.010383444838225842, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 1470.94091796875, "total_loss": 9.982386589050293, "weights_seq_no": 39.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.02029430866241455, "num_module_steps_trained": 120832, "entropy": 0.7231066823005676, "num_module_steps_trained_lifetime": 4712448, "num_module_steps_trained_lifetime_throughput": 4611.133098495916}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1696593496821537, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011878314951831682, "agent_to_module_mapping": 0.02149885297849569, "general_advantage_estimation": 0.11893658214554902, "add_columns_from_episodes_to_train_batch": 0.4688047547158767, "batch_individual_items": 0.5163954493028137, "add_states_from_episodes_to_batch": 1.575311824273384e-05, "add_one_ts_to_episodes_and_truncate": 0.03585377531498829, "add_time_dim_to_batch_and_zero_pad": 4.3889073482300044e-05, "numpy_to_tensor": 0.0059961153560856625}}}, "num_env_steps_trained_lifetime": 73632000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 4712448, "num_env_steps_trained_lifetime_throughput": 72048.93599653908, "num_module_steps_trained_lifetime_throughput": 4611.133470057218}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 174000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 39, "trial_id": "76942_00000", "date": "2026-01-15_15-31-53", "timestamp": 1768487513, "time_this_iter_s": 27.08592677116394, "time_total_s": 1032.4200122356415, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA01BE4CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1032.4200122356415, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 23.610526315789475, "ram_util_percent": 45.29999999999999}}
{"timers": {"training_iteration": 23.710000101964827, "restore_env_runners": 2.521384685858404e-05, "training_step": 23.70949108009167, "env_runner_sampling_timer": 13.059978889453967, "learner_update_timer": 10.638033589872368, "synch_weights": 0.004466800776173364, "synch_env_connectors": 0.0035041848365351415}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.68530482657243e-05, "un_batch_to_individual_items": 9.473500741748864e-05, "normalize_and_clip_actions": 0.00012540005830817216, "tensor_to_numpy": 0.00013319484711552752, "get_actions": 0.0004230901785690555, "remove_single_ts_time_rank_from_batch": 4.546076549432849e-06, "module_to_agent_unmapping": 9.83582905830057e-06}}, "connector_pipeline_timer": 0.0010501315633799247}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 178000.0, "human_1": 178000.0, "human_2": 178000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.919338513001424, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.653070713896633e-05, "add_observations_from_episodes_to_batch": 8.048590092369693e-05, "batch_individual_items": 6.452246331273539e-05, "add_states_from_episodes_to_batch": 1.3607284032273359e-05, "add_time_dim_to_batch_and_zero_pad": 2.5683225293000308e-05, "agent_to_module_mapping": 1.3997853511604492e-05}}, "connector_pipeline_timer": 0.0004671753694573019}, "module_episode_returns_mean": {"shared_policy": -1339.7344816666662}, "rlmodule_inference_timer": 0.0004398438849720525, "time_between_sampling": 1.1658104099046978, "agent_episode_returns_mean": {"human_0": -487.5563366666665, "human_1": -491.96469666666644, "human_2": -486.71353166666654}, "episode_return_min": -1666.0665, "episode_len_min": 2000, "episode_return_mean": -1466.234564999999, "num_episodes_lifetime": 80.00000000000006, "sample": 1.5899838316533939, "num_env_steps_sampled_lifetime": 178000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 534000.0}, "num_episodes": 2.0, "env_step_timer": 0.0032450185812363313, "episode_return_max": -1338.314499999999, "weights_seq_no": 39.0, "num_env_steps_sampled_lifetime_throughput": 152.4205263615461}, "learners": {"shared_policy": {"mean_kl_loss": 0.0018639137269929051, "curr_kl_coeff": 7.450580707946131e-10, "policy_loss": -0.08018811047077179, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 1396.9945068359375, "total_loss": 9.912490844726562, "weights_seq_no": 40.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.015899598598480225, "num_module_steps_trained": 120832, "entropy": 0.7320106625556946, "num_module_steps_trained_lifetime": 4833280, "num_module_steps_trained_lifetime_throughput": 4600.875734612277}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1741094441853401, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001190989180199286, "agent_to_module_mapping": 0.021553352448614234, "general_advantage_estimation": 0.11899567432413903, "add_columns_from_episodes_to_train_batch": 0.4700994211687013, "batch_individual_items": 0.5194212798097806, "add_states_from_episodes_to_batch": 1.574558703832729e-05, "add_one_ts_to_episodes_and_truncate": 0.035926009561947254, "add_time_dim_to_batch_and_zero_pad": 4.381518276190323e-05, "numpy_to_tensor": 0.005940152202554048}}}, "num_env_steps_trained_lifetime": 75520000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 4833280, "num_env_steps_trained_lifetime_throughput": 71888.66994948772, "num_module_steps_trained_lifetime_throughput": 4600.876049037374}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 178000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 40, "trial_id": "76942_00000", "date": "2026-01-15_15-32-20", "timestamp": 1768487540, "time_this_iter_s": 27.379411697387695, "time_total_s": 1059.7994239330292, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA017F7B50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1059.7994239330292, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 24.207894736842103, "ram_util_percent": 45.28947368421052}}
{"timers": {"training_iteration": 23.746466316945067, "restore_env_runners": 2.5237708308811085e-05, "training_step": 23.745955131290707, "env_runner_sampling_timer": 13.089336286559384, "learner_update_timer": 10.645104756973604, "synch_weights": 0.004463588768447027, "synch_env_connectors": 0.0035094709880561484}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 4.517629419293905e-05, "un_batch_to_individual_items": 9.878582474297573e-05, "normalize_and_clip_actions": 0.00012875727027888826, "tensor_to_numpy": 0.00013743659714577256, "get_actions": 0.00044299297993530956, "remove_single_ts_time_rank_from_batch": 4.630307925180273e-06, "module_to_agent_unmapping": 9.96811060031084e-06}}, "connector_pipeline_timer": 0.0011042483288539503}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 182000.0, "human_1": 182000.0, "human_2": 182000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.706156491011061, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001061365168668575, "add_observations_from_episodes_to_batch": 8.518105173301111e-05, "batch_individual_items": 6.932672802826694e-05, "add_states_from_episodes_to_batch": 1.3859761691662416e-05, "add_time_dim_to_batch_and_zero_pad": 2.7554359395506185e-05, "agent_to_module_mapping": 1.4777443116604086e-05}}, "connector_pipeline_timer": 0.0005029714711704772}, "module_episode_returns_mean": {"shared_policy": -1295.5197149999995}, "rlmodule_inference_timer": 0.00045230355137348835, "time_between_sampling": 1.175485795542696, "agent_episode_returns_mean": {"human_0": -469.91205666666656, "human_1": -476.3675566666664, "human_2": -473.8831866666666}, "episode_return_min": -1666.0665, "episode_len_min": 2000, "episode_return_mean": -1420.1627999999996, "num_episodes_lifetime": 82.00000000000006, "sample": 1.586151512604826, "num_env_steps_sampled_lifetime": 182000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 546000.0}, "num_episodes": 2.0, "env_step_timer": 0.0033574656753443503, "episode_return_max": -1318.823499999999, "weights_seq_no": 40.0, "num_env_steps_sampled_lifetime_throughput": 151.8534332884318}, "learners": {"shared_policy": {"mean_kl_loss": 0.003320621093735099, "curr_kl_coeff": 3.7252903539730653e-10, "policy_loss": 0.02071434073150158, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 1448.28515625, "total_loss": 10.013653755187988, "weights_seq_no": 41.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.025022149085998535, "num_module_steps_trained": 120832, "entropy": 0.7060120105743408, "num_module_steps_trained_lifetime": 4954112, "num_module_steps_trained_lifetime_throughput": 4590.427544358969}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1740661157434842, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011943392883246593, "agent_to_module_mapping": 0.021553988924040472, "general_advantage_estimation": 0.11922899558089967, "add_columns_from_episodes_to_train_batch": 0.47001095795703496, "batch_individual_items": 0.5193028950118, "add_states_from_episodes_to_batch": 1.5723131177266554e-05, "add_one_ts_to_episodes_and_truncate": 0.035912759466394384, "add_time_dim_to_batch_and_zero_pad": 4.37620309554811e-05, "numpy_to_tensor": 0.005883399680617657}}}, "num_env_steps_trained_lifetime": 77408000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 4954112, "num_env_steps_trained_lifetime_throughput": 71725.41073782793, "num_module_steps_trained_lifetime_throughput": 4590.4278358793445}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 182000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 41, "trial_id": "76942_00000", "date": "2026-01-15_15-32-48", "timestamp": 1768487568, "time_this_iter_s": 27.36486840248108, "time_total_s": 1087.1642923355103, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA0178A0E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1087.1642923355103, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 26.366666666666667, "ram_util_percent": 45.27948717948718}}
{"timers": {"training_iteration": 23.75663192477556, "restore_env_runners": 2.522633131458605e-05, "training_step": 23.75611828797778, "env_runner_sampling_timer": 13.09824555369384, "learner_update_timer": 10.64632015640395, "synch_weights": 0.004452979880836831, "synch_env_connectors": 0.003507912278149124}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.3389108361405794e-05, "un_batch_to_individual_items": 8.319643695190061e-05, "normalize_and_clip_actions": 0.00010920168811352777, "tensor_to_numpy": 0.00011800567800348104, "get_actions": 0.0003770186164566451, "remove_single_ts_time_rank_from_batch": 3.9617633637764185e-06, "module_to_agent_unmapping": 8.5101522378389e-06}}, "connector_pipeline_timer": 0.0009324945590541917}, "connector_pipeline_timer": 0.0007525999899371527, "num_agent_steps_sampled_lifetime": {"human_0": 186000.0, "human_1": 186000.0, "human_2": 186000.0}, "env_to_module_sum_episodes_length_in": 131.6904176324108, "episode_len_max": 2000, "env_to_module_sum_episodes_length_out": 131.6904176324108, "episode_duration_sec_mean": 11.63573511601091, "timers": {"connectors": {"agent_to_module_mapping": 1.095001061912626e-05, "numpy_to_tensor": 0.00010494999878574163, "add_observations_from_episodes_to_batch": 7.159999950090419e-05, "batch_individual_items": 6.414999370463192e-05, "add_states_from_episodes_to_batch": 1.0799994925037026e-05, "add_time_dim_to_batch_and_zero_pad": 2.5300003471784294e-05}}, "num_env_steps_sampled": 4000.0, "num_agent_steps_sampled": {"human_2": 4000.0, "human_0": 4000.0, "human_1": 4000.0}, "agent_steps": {"human_2": 2000.0, "human_0": 2000.0, "human_1": 2000.0}, "episode_len_mean": 2000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.66771410152555e-05, "add_observations_from_episodes_to_batch": 7.123900302734641e-05, "batch_individual_items": 5.709371620430889e-05, "add_states_from_episodes_to_batch": 1.1626193660575674e-05, "add_time_dim_to_batch_and_zero_pad": 2.2550467356063334e-05, "agent_to_module_mapping": 1.2438947002524494e-05}}, "connector_pipeline_timer": 0.00041302268639585495}, "module_episode_returns_mean": {"shared_policy": -1248.101523333333}, "rlmodule_inference_timer": 0.00037153151397811715, "time_between_sampling": 1.17511183011977, "agent_episode_returns_mean": {"human_0": -456.2783616666665, "human_1": -457.5671566666664, "human_2": -465.4452866666665}, "episode_return_min": -1427.4129999999996, "episode_len_min": 2000, "episode_return_mean": -1379.2908049999999, "num_episodes_lifetime": 84.00000000000006, "sample": 1.5764357672337288, "num_env_steps_sampled_lifetime": 186000.0, "num_module_steps_sampled": {"shared_policy": 12000.0}, "env_reset_timer": 2.678075349998835, "num_module_steps_sampled_lifetime": {"shared_policy": 558000.0}, "num_episodes": 2.0, "env_step_timer": 0.0028774775839415546, "episode_return_max": -1318.823499999999, "weights_seq_no": 41.0, "num_env_steps_sampled_lifetime_throughput": 152.13727903459585}, "learners": {"shared_policy": {"mean_kl_loss": 0.0033275613095611334, "curr_kl_coeff": 1.8626451769865326e-10, "policy_loss": 0.04881260544061661, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "vf_loss_unclipped": 1547.2889404296875, "total_loss": 10.041929244995117, "weights_seq_no": 42.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 294916, "curr_entropy_coeff": 0.01, "module_train_batch_size_mean": 256.0, "vf_explained_var": 0.027693986892700195, "num_module_steps_trained": 120832, "entropy": 0.6883037686347961, "num_module_steps_trained_lifetime": 5074944, "num_module_steps_trained_lifetime_throughput": 4604.388389138412}, "__all_modules__": {"num_trainable_parameters": 294916, "learner_connector": {"connector_pipeline_timer": 1.1753089645860983, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011934048954503384, "agent_to_module_mapping": 0.02159659803480121, "general_advantage_estimation": 0.11910086762505669, "add_columns_from_episodes_to_train_batch": 0.4698266363774543, "batch_individual_items": 0.5209547500617022, "add_states_from_episodes_to_batch": 1.5681899875660205e-05, "add_one_ts_to_episodes_and_truncate": 0.035833576871805245, "add_time_dim_to_batch_and_zero_pad": 4.372741065866492e-05, "numpy_to_tensor": 0.005828312683821233}}}, "num_env_steps_trained_lifetime": 79296000, "learner_connector_sum_episodes_length_out": 4000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4000.0, "num_module_steps_trained": 120832, "num_env_steps_trained": 1888000, "num_module_steps_trained_lifetime": 5074944, "num_env_steps_trained_lifetime_throughput": 71943.55427397839, "num_module_steps_trained_lifetime_throughput": 4604.388670989089}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 186000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 2}, "done": false, "training_iteration": 42, "trial_id": "76942_00000", "date": "2026-01-15_15-33-13", "timestamp": 1768487593, "time_this_iter_s": 24.771065950393677, "time_total_s": 1111.935358285904, "pid": 24224, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVineEnv-v0", "env_config": {"render_mode": "terminal", "topology_mode": "row", "num_humans": 3, "num_drones": 1, "max_boxes_per_vine": 1, "max_backlog": 5, "max_steps": 2000, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0, "vineyard_file": "data/Vinha_Maria_Teresa_RL.xlsx", "reward_delivery": 1.0, "reward_backlog_penalty": 0.5, "reward_fatigue_penalty": 0.5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 4000, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.policy_mapping_fn at 0x000001BA01BE4B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, "Box(0.0, 1.0, (316,), float32)", "Discrete(3)", {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1111.935358285904, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 24.352941176470587, "ram_util_percent": 45.23823529411764}}
