{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.021090030670166, "cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 9.898289949777526, "policy_loss": -0.0035147913514128283, "vf_loss": 9.900974052979942, "vf_explained_var": 0.006469629284176351, "kl": 0.004153442524589738, "entropy": 0.7975630674266005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 2355.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -6335.00700000004, "episode_reward_min": -10978.846000000007, "episode_reward_mean": -8323.919375000027, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 4000, "policy_reward_min": {"shared_policy": -2203.423000000001}, "policy_reward_max": {"shared_policy": -1263.158499999997}, "policy_reward_mean": {"shared_policy": -1664.7838749999987}, "custom_metrics": {"delivered_mean_agents_mean": 216.25, "delivered_mean_agents_min": 210.0, "delivered_mean_agents_max": 219.0, "backlog_mean_agents_mean": 29.5, "backlog_mean_agents_min": 25.0, "backlog_mean_agents_max": 35.0, "manual_delivery_mean_agents_mean": 0.0, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.0, "harvest_mean_agents_mean": 0.15000000000000002, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.05, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.05, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.001141552511415525, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.0045662100456621}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003], "episode_lengths": [1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.99419652352003, "mean_inference_ms": 5.367611503934777, "mean_action_processing_ms": 0.5668180342228286, "mean_env_wait_ms": 4.636345908392134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024968385696411133, "StateBufferConnector_ms": 0.02574920654296875, "ViewRequirementAgentConnector_ms": 0.4506230354309082}, "num_episodes": 4, "episode_return_max": -6335.00700000004, "episode_return_min": -10978.846000000007, "episode_return_mean": -8323.919375000027, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.830546306524074, "num_env_steps_trained_throughput_per_sec": 27.830546306524074, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 143726.967, "restore_workers_time_ms": 0.0, "training_step_time_ms": 143726.967, "sample_time_ms": 62502.799, "learn_time_ms": 81219.15, "learn_throughput": 49.249, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 1, "trial_id": "05971_00000", "date": "2026-02-19_14-17-56", "timestamp": 1771507076, "time_this_iter_s": 143.72796440124512, "time_total_s": 143.72796440124512, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4D090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 143.72796440124512, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.529050279329613, "ram_util_percent": 38.55810055865921, "gpu_util_percent0": 0.2627374301675977, "vram_util_percent0": 0.17150797051414662}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.809521675109863, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.825741861630904, "policy_loss": -0.006805804831958564, "vf_loss": 9.831522793375003, "vf_explained_var": 0.05475563241164902, "kl": 0.010248729075727494, "entropy": 0.7769050508294643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 7065.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -6335.00700000004, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -9128.889937500036, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 8000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -1263.158499999997}, "policy_reward_mean": {"shared_policy": -1825.7779874999978}, "custom_metrics": {"delivered_mean_agents_mean": 219.75, "delivered_mean_agents_min": 210.0, "delivered_mean_agents_max": 228.0, "backlog_mean_agents_mean": 30.5, "backlog_mean_agents_min": 21.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.0, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.0, "harvest_mean_agents_mean": 0.125, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.025, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.025, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0005707762557077625, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.0045662100456621}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.935920630667431, "mean_inference_ms": 5.277449386588554, "mean_action_processing_ms": 0.563379848303635, "mean_env_wait_ms": 4.370823795025908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02497732639312744, "StateBufferConnector_ms": 0.025457143783569336, "ViewRequirementAgentConnector_ms": 0.4875391721725464}, "num_episodes": 4, "episode_return_max": -6335.00700000004, "episode_return_min": -12201.262500000255, "episode_return_mean": -9128.889937500036, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.2391215664571, "num_env_steps_trained_throughput_per_sec": 29.2391215664571, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 140265.492, "restore_workers_time_ms": 0.0, "training_step_time_ms": 140264.991, "sample_time_ms": 59123.417, "learn_time_ms": 81137.066, "learn_throughput": 49.299, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 2, "trial_id": "05971_00000", "date": "2026-02-19_14-20-12", "timestamp": 1771507212, "time_this_iter_s": 136.80601716041565, "time_total_s": 280.53398156166077, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC89D1C280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 280.53398156166077, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.847368421052632, "ram_util_percent": 38.67076023391813, "gpu_util_percent0": 0.2895321637426901, "vram_util_percent0": 0.1719082554129992}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.197683334350586, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.923499546941931, "policy_loss": -0.013639628878080795, "vf_loss": 9.935563260582603, "vf_explained_var": 0.07810945166650599, "kl": 0.015759238324722445, "entropy": 0.7666147684468838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 11775.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -6335.00700000004, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -9202.354708333372, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 12000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -1263.158499999997}, "policy_reward_mean": {"shared_policy": -1840.4709416666644}, "custom_metrics": {"delivered_mean_agents_mean": 216.5, "delivered_mean_agents_min": 201.0, "delivered_mean_agents_max": 228.0, "backlog_mean_agents_mean": 31.583333333333332, "backlog_mean_agents_min": 21.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.03333333333333333, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.09999999999999999, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016666666666666666, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.03333333333333333, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0007773429006305718, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004761904761904762}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.99195864865706, "mean_inference_ms": 5.287519844269933, "mean_action_processing_ms": 0.5664583027889379, "mean_env_wait_ms": 4.274130367992274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01665155092875163, "StateBufferConnector_ms": 0.016971429189046223, "ViewRequirementAgentConnector_ms": 0.5343496799468994}, "num_episodes": 4, "episode_return_max": -6335.00700000004, "episode_return_min": -12201.262500000255, "episode_return_mean": -9202.354708333372, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.77823286853604, "num_env_steps_trained_throughput_per_sec": 27.77823286853604, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 141509.542, "restore_workers_time_ms": 0.0, "training_step_time_ms": 141509.208, "sample_time_ms": 60448.997, "learn_time_ms": 81056.203, "learn_throughput": 49.348, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 3, "trial_id": "05971_00000", "date": "2026-02-19_14-22-36", "timestamp": 1771507356, "time_this_iter_s": 143.9996359348297, "time_total_s": 424.5336174964905, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4EDD0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 424.5336174964905, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.833519553072623, "ram_util_percent": 39.37430167597765, "gpu_util_percent0": 0.26731843575418995, "vram_util_percent0": 0.17646071509471553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5592362880706787, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.985119737029835, "policy_loss": -0.016212334449456377, "vf_loss": 9.999784835685844, "vf_explained_var": 0.07496969034211144, "kl": 0.015472332314884627, "entropy": 0.7507796699833718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 16485.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -6335.00700000004, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -8857.309031250024, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -1263.158499999997}, "policy_reward_mean": {"shared_policy": -1771.461806249999}, "custom_metrics": {"delivered_mean_agents_mean": 212.5, "delivered_mean_agents_min": 186.0, "delivered_mean_agents_max": 228.0, "backlog_mean_agents_mean": 31.75, "backlog_mean_agents_min": 21.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.08750000000000001, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.0125, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.025, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0005830071754729289, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004761904761904762}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0283890446510195, "mean_inference_ms": 5.282475320796159, "mean_action_processing_ms": 0.5697728920828374, "mean_env_wait_ms": 4.223873037575109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018724799156188965, "StateBufferConnector_ms": 0.012728571891784668, "ViewRequirementAgentConnector_ms": 0.5697667598724365}, "num_episodes": 4, "episode_return_max": -6335.00700000004, "episode_return_min": -12201.262500000255, "episode_return_mean": -8857.309031250024, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.115381150834896, "num_env_steps_trained_throughput_per_sec": 29.115381150834896, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 140478.263, "restore_workers_time_ms": 0.0, "training_step_time_ms": 140478.013, "sample_time_ms": 60420.114, "learn_time_ms": 80054.393, "learn_throughput": 49.966, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 4, "trial_id": "05971_00000", "date": "2026-02-19_14-24-54", "timestamp": 1771507494, "time_this_iter_s": 137.38642859458923, "time_total_s": 561.9200460910797, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4FE20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 561.9200460910797, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.808235294117644, "ram_util_percent": 40.19117647058823, "gpu_util_percent0": 0.26117647058823534, "vram_util_percent0": 0.17874292364723124}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6091814637184143, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.98496557385552, "policy_loss": -0.016525305031092872, "vf_loss": 9.999996993192442, "vf_explained_var": 0.061150671835917575, "kl": 0.01493899129181358, "entropy": 0.7335489697517104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 21195.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -1574.9634999999837, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -7958.968950000019, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -312.6100000000001}, "policy_reward_mean": {"shared_policy": -1591.793789999999}, "custom_metrics": {"delivered_mean_agents_mean": 210.25, "delivered_mean_agents_min": 186.0, "delivered_mean_agents_max": 228.0, "backlog_mean_agents_mean": 29.6, "backlog_mean_agents_min": 11.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.04, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.08, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.02, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.02, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00046640574037834314, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004761904761904762}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.04782102244492, "mean_inference_ms": 5.271750636193511, "mean_action_processing_ms": 0.5727018818909653, "mean_env_wait_ms": 4.1896846960386895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.010182857513427734, "ViewRequirementAgentConnector_ms": 0.5258584022521973}, "num_episodes": 4, "episode_return_max": -1574.9634999999837, "episode_return_min": -12201.262500000255, "episode_return_mean": -7958.968950000019, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.949617937690178, "num_env_steps_trained_throughput_per_sec": 28.949617937690178, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 140016.827, "restore_workers_time_ms": 0.0, "training_step_time_ms": 140016.626, "sample_time_ms": 60154.393, "learn_time_ms": 79859.029, "learn_throughput": 50.088, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 5, "trial_id": "05971_00000", "date": "2026-02-19_14-27-12", "timestamp": 1771507632, "time_this_iter_s": 138.17308044433594, "time_total_s": 700.0931265354156, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4DA20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 700.0931265354156, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.495348837209296, "ram_util_percent": 40.11627906976744, "gpu_util_percent0": 0.2533139534883721, "vram_util_percent0": 0.1788869985571625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4129935503005981, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.978259660635784, "policy_loss": -0.018863138020426162, "vf_loss": 9.995427724510241, "vf_explained_var": 0.001961015781779198, "kl": 0.016950694881579298, "entropy": 0.7035169445152242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 25905.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -627.5800000000035, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -6844.579354166682, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 24000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -117.66049999999987}, "policy_reward_mean": {"shared_policy": -1368.9158708333323}, "custom_metrics": {"delivered_mean_agents_mean": 209.625, "delivered_mean_agents_min": 186.0, "delivered_mean_agents_max": 228.0, "backlog_mean_agents_mean": 25.458333333333332, "backlog_mean_agents_min": 1.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05000000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.075, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016666666666666666, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.016666666666666666, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0003886714503152859, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004761904761904762}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.060681309884359, "mean_inference_ms": 5.2527945229876485, "mean_action_processing_ms": 0.574986607995178, "mean_env_wait_ms": 4.165059044019395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03332893053690592, "StateBufferConnector_ms": 0.012645125389099121, "ViewRequirementAgentConnector_ms": 0.5447844664255778}, "num_episodes": 4, "episode_return_max": -627.5800000000035, "episode_return_min": -12201.262500000255, "episode_return_mean": -6844.579354166682, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.223881896368685, "num_env_steps_trained_throughput_per_sec": 30.223881896368685, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 138738.301, "restore_workers_time_ms": 0.0, "training_step_time_ms": 138738.134, "sample_time_ms": 59831.815, "learn_time_ms": 78903.315, "learn_throughput": 50.695, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 6, "trial_id": "05971_00000", "date": "2026-02-19_14-29-25", "timestamp": 1771507765, "time_this_iter_s": 132.34818482398987, "time_total_s": 832.4413113594055, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4C8B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 832.4413113594055, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.075757575757574, "ram_util_percent": 39.17575757575757, "gpu_util_percent0": 0.2642424242424243, "vram_util_percent0": 0.17935411762964282}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9327296018600464, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.972567283120124, "policy_loss": -0.021676396589227924, "vf_loss": 9.992244023527563, "vf_explained_var": 0.06864225950463815, "kl": 0.019996421626950568, "entropy": 0.685629072184269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 30615.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -627.5800000000035, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -6668.123035714302, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 28000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -117.66049999999987}, "policy_reward_mean": {"shared_policy": -1333.6246071428563}, "custom_metrics": {"delivered_mean_agents_mean": 211.82142857142858, "delivered_mean_agents_min": 186.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 26.714285714285715, "backlog_mean_agents_min": 1.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.042857142857142864, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.07142857142857142, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014285714285714287, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.014285714285714287, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00033314695741310223, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004761904761904762}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.068176153392784, "mean_inference_ms": 5.24188836697638, "mean_action_processing_ms": 0.5767556078700258, "mean_env_wait_ms": 4.142836743185712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032135418483189175, "StateBufferConnector_ms": 0.018018484115600586, "ViewRequirementAgentConnector_ms": 0.5561658314296177}, "num_episodes": 4, "episode_return_max": -627.5800000000035, "episode_return_min": -12201.262500000255, "episode_return_mean": -6668.123035714302, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.240839490902374, "num_env_steps_trained_throughput_per_sec": 30.240839490902374, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 137814.467, "restore_workers_time_ms": 0.0, "training_step_time_ms": 137814.324, "sample_time_ms": 59728.513, "learn_time_ms": 78082.95, "learn_throughput": 51.228, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 7, "trial_id": "05971_00000", "date": "2026-02-19_14-31-37", "timestamp": 1771507897, "time_this_iter_s": 132.274019241333, "time_total_s": 964.7153306007385, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADD80D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 964.7153306007385, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.17090909090909, "ram_util_percent": 38.38545454545455, "gpu_util_percent0": 0.26527272727272727, "vram_util_percent0": 0.17360660834036504}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1178737878799438, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.978816450528026, "policy_loss": -0.02170246151827608, "vf_loss": 9.998727853941057, "vf_explained_var": 0.03034612756625862, "kl": 0.017910702008295504, "entropy": 0.6543555867646657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 35325.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -425.9790000000031, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -6146.250593750014, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 32000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -77.5669999999999}, "policy_reward_mean": {"shared_policy": -1229.2501187499995}, "custom_metrics": {"delivered_mean_agents_mean": 210.625, "delivered_mean_agents_min": 186.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 25.4375, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.04375, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.06875, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.0125, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.0125, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00029150358773646445, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004761904761904762}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.07055990624067, "mean_inference_ms": 5.224646447958287, "mean_action_processing_ms": 0.5774670123475512, "mean_env_wait_ms": 4.121311409371687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028118491172790527, "StateBufferConnector_ms": 0.01889169216156006, "ViewRequirementAgentConnector_ms": 0.5504123866558075}, "num_episodes": 4, "episode_return_max": -425.9790000000031, "episode_return_min": -12201.262500000255, "episode_return_mean": -6146.250593750014, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.060196872755533, "num_env_steps_trained_throughput_per_sec": 31.060196872755533, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 136685.431, "restore_workers_time_ms": 0.0, "training_step_time_ms": 136685.306, "sample_time_ms": 59158.444, "learn_time_ms": 77523.86, "learn_throughput": 51.597, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 8, "trial_id": "05971_00000", "date": "2026-02-19_14-33-46", "timestamp": 1771508026, "time_this_iter_s": 128.7866928577423, "time_total_s": 1093.5020234584808, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADD8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1093.5020234584808, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.275, "ram_util_percent": 38.501875, "gpu_util_percent0": 0.25975000000000004, "vram_util_percent0": 0.17421684171958965}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5651003122329712, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.976438717933217, "policy_loss": -0.020960289513051605, "vf_loss": 9.995647150796943, "vf_explained_var": 0.019225118949914435, "kl": 0.017518504451255912, "entropy": 0.6233740184590568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 40035.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -402.2034999999993, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -5635.983527777791, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -72.15949999999995}, "policy_reward_mean": {"shared_policy": -1127.196705555555}, "custom_metrics": {"delivered_mean_agents_mean": 208.63888888888889, "delivered_mean_agents_min": 186.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 23.88888888888889, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.049999999999999996, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.07222222222222224, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.01666666666666667, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.011111111111111112, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00025911430021019065, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004761904761904762}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.077864536180467, "mean_inference_ms": 5.214089585223915, "mean_action_processing_ms": 0.5781944327874865, "mean_env_wait_ms": 4.105163743641755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249942143758138, "StateBufferConnector_ms": 0.01679261525472005, "ViewRequirementAgentConnector_ms": 0.5471289157867432}, "num_episodes": 4, "episode_return_max": -402.2034999999993, "episode_return_min": -12201.262500000255, "episode_return_mean": -5635.983527777791, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.446527930376845, "num_env_steps_trained_throughput_per_sec": 28.446527930376845, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 137122.017, "restore_workers_time_ms": 0.0, "training_step_time_ms": 137121.906, "sample_time_ms": 59483.864, "learn_time_ms": 77634.817, "learn_throughput": 51.523, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 9, "trial_id": "05971_00000", "date": "2026-02-19_14-36-06", "timestamp": 1771508166, "time_this_iter_s": 140.6177077293396, "time_total_s": 1234.1197311878204, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4FBE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1234.1197311878204, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.26781609195402, "ram_util_percent": 38.90229885057471, "gpu_util_percent0": 0.25068965517241376, "vram_util_percent0": 0.1772266956409436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8304560780525208, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.979800504939572, "policy_loss": -0.021816784836106683, "vf_loss": 9.999908066605814, "vf_explained_var": 0.0041376685514065365, "kl": 0.017092273764914664, "entropy": 0.6177175714964573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 44745.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -402.2034999999993, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -5224.96456250001, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -72.15949999999995}, "policy_reward_mean": {"shared_policy": -1044.9929124999994}, "custom_metrics": {"delivered_mean_agents_mean": 207.175, "delivered_mean_agents_min": 186.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 22.675, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.045, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.07, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.015000000000000003, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.015000000000000003, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0003620688495706148, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005154639175257732}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.083301746631195, "mean_inference_ms": 5.2016261837451605, "mean_action_processing_ms": 0.5786093184195732, "mean_env_wait_ms": 4.091170665280643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024989843368530273, "StateBufferConnector_ms": 0.015113353729248047, "ViewRequirementAgentConnector_ms": 0.5590128898620605}, "num_episodes": 4, "episode_return_max": -402.2034999999993, "episode_return_min": -12201.262500000255, "episode_return_mean": -5224.96456250001, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.35608583655471, "num_env_steps_trained_throughput_per_sec": 30.35608583655471, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 136586.745, "restore_workers_time_ms": 0.0, "training_step_time_ms": 136586.644, "sample_time_ms": 59255.702, "learn_time_ms": 77327.741, "learn_throughput": 51.728, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 10, "trial_id": "05971_00000", "date": "2026-02-19_14-38-18", "timestamp": 1771508298, "time_this_iter_s": 131.774094581604, "time_total_s": 1365.8938257694244, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4FE20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1365.8938257694244, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.993865030674847, "ram_util_percent": 39.32024539877301, "gpu_util_percent0": 0.24631901840490797, "vram_util_percent0": 0.1770037553085317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8472576141357422, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.976472013315577, "policy_loss": -0.025559528993102553, "vf_loss": 9.999996943787657, "vf_explained_var": 0.11800013041546896, "kl": 0.020346026916102482, "entropy": 0.6517421446281887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 49455.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": -402.2034999999993, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -5370.917829545467, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 44000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -72.15949999999995}, "policy_reward_mean": {"shared_policy": -1074.18356590909}, "custom_metrics": {"delivered_mean_agents_mean": 207.0681818181818, "delivered_mean_agents_min": 186.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 22.59090909090909, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.07272727272727274, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.018181818181818184, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.018181818181818184, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00044056169925314363, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005154639175257732}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0881156013000375, "mean_inference_ms": 5.192783151651617, "mean_action_processing_ms": 0.5791486865591328, "mean_env_wait_ms": 4.080155813227512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02271803942593661, "StateBufferConnector_ms": 0.01601197502829812, "ViewRequirementAgentConnector_ms": 0.5742777477611195}, "num_episodes": 4, "episode_return_max": -402.2034999999993, "episode_return_min": -12201.262500000255, "episode_return_mean": -5370.917829545467, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.589575764479623, "num_env_steps_trained_throughput_per_sec": 28.589575764479623, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 136205.161, "restore_workers_time_ms": 0.0, "training_step_time_ms": 136205.061, "sample_time_ms": 59042.963, "learn_time_ms": 77159.139, "learn_throughput": 51.841, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 11, "trial_id": "05971_00000", "date": "2026-02-19_14-40-38", "timestamp": 1771508438, "time_this_iter_s": 139.91613626480103, "time_total_s": 1505.8099620342255, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADDA5F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1505.8099620342255, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.044252873563224, "ram_util_percent": 39.89080459770115, "gpu_util_percent0": 0.26913793103448275, "vram_util_percent0": 0.1752283970374364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0023951530456543, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 0.0003, "total_loss": 9.975761122612436, "policy_loss": -0.02711876326007274, "vf_loss": 9.99969833074355, "vf_explained_var": 0.050304029208080026, "kl": 0.021210375501735757, "entropy": 0.6071144054143546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 54165.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": -402.2034999999993, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -5282.903552083347, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 48000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -72.15949999999995}, "policy_reward_mean": {"shared_policy": -1056.5807104166659}, "custom_metrics": {"delivered_mean_agents_mean": 206.35416666666666, "delivered_mean_agents_min": 175.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 21.854166666666668, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05000000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.07916666666666666, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016666666666666666, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.020833333333333332, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0005025844012506107, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005154639175257732}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.092166853787007, "mean_inference_ms": 5.1873266902272, "mean_action_processing_ms": 0.5796618522183618, "mean_env_wait_ms": 4.070888385506959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020824869473775227, "StateBufferConnector_ms": 0.018845995267232258, "ViewRequirementAgentConnector_ms": 0.5765393376350403}, "num_episodes": 4, "episode_return_max": -402.2034999999993, "episode_return_min": -12201.262500000255, "episode_return_mean": -5282.903552083347, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.66219320120125, "num_env_steps_trained_throughput_per_sec": 26.66219320120125, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 137527.277, "restore_workers_time_ms": 0.0, "training_step_time_ms": 137527.277, "sample_time_ms": 59512.984, "learn_time_ms": 78011.433, "learn_throughput": 51.275, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 12, "trial_id": "05971_00000", "date": "2026-02-19_14-43-08", "timestamp": 1771508588, "time_this_iter_s": 150.03016304969788, "time_total_s": 1655.8401250839233, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADDA200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1655.8401250839233, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 21.36844919786096, "ram_util_percent": 39.789304812834224, "gpu_util_percent0": 0.2728342245989304, "vram_util_percent0": 0.16757796070419995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9045946002006531, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 9.97870289018959, "policy_loss": -0.025425090859673774, "vf_loss": 10.0, "vf_explained_var": 0.09774262982315825, "kl": 0.018346515228570802, "entropy": 0.6081201564354501, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 58875.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": -402.2034999999993, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -5433.555788461552, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 52000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -72.15949999999995}, "policy_reward_mean": {"shared_policy": -1086.711157692307}, "custom_metrics": {"delivered_mean_agents_mean": 204.96153846153845, "delivered_mean_agents_min": 175.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 22.5, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05000000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.07692307692307693, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.015384615384615385, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.023076923076923075, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0005673152951163619, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005376344086021506}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.095173489536909, "mean_inference_ms": 5.182107170699353, "mean_action_processing_ms": 0.5801587332222448, "mean_env_wait_ms": 4.062861408002146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01922295643733098, "StateBufferConnector_ms": 0.017396303323599007, "ViewRequirementAgentConnector_ms": 0.5697387915391189}, "num_episodes": 4, "episode_return_max": -402.2034999999993, "episode_return_min": -12201.262500000255, "episode_return_mean": -5433.555788461552, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.625112649289832, "num_env_steps_trained_throughput_per_sec": 29.625112649289832, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 136629.571, "restore_workers_time_ms": 0.0, "training_step_time_ms": 136629.571, "sample_time_ms": 59068.106, "learn_time_ms": 77558.606, "learn_throughput": 51.574, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 13, "trial_id": "05971_00000", "date": "2026-02-19_14-45-23", "timestamp": 1771508723, "time_this_iter_s": 135.0245761871338, "time_total_s": 1790.8647012710571, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4C8B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1790.8647012710571, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 22.82976190476191, "ram_util_percent": 39.796428571428564, "gpu_util_percent0": 0.2623214285714286, "vram_util_percent0": 0.17041416591062414}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9365510940551758, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 9.978317724418234, "policy_loss": -0.025933986523578183, "vf_loss": 9.999998717905356, "vf_explained_var": 0.07920932477446878, "kl": 0.018902252172086312, "entropy": 0.5513871574541059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 63585.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": -402.2034999999993, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -5396.172339285726, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 56000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -72.15949999999995}, "policy_reward_mean": {"shared_policy": -1079.2344678571424}, "custom_metrics": {"delivered_mean_agents_mean": 203.0, "delivered_mean_agents_min": 169.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 22.5, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.07142857142857142, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014285714285714287, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.025, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0006265533486575316, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.096533214647891, "mean_inference_ms": 5.1743196034510515, "mean_action_processing_ms": 0.5804253100216494, "mean_env_wait_ms": 4.054738826151214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017849888120378767, "StateBufferConnector_ms": 0.016153710229056224, "ViewRequirementAgentConnector_ms": 0.5805534975869315}, "num_episodes": 4, "episode_return_max": -402.2034999999993, "episode_return_min": -12201.262500000255, "episode_return_mean": -5396.172339285726, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.089148424410965, "num_env_steps_trained_throughput_per_sec": 32.089148424410965, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 135356.401, "restore_workers_time_ms": 0.0, "training_step_time_ms": 135356.401, "sample_time_ms": 58506.142, "learn_time_ms": 76847.3, "learn_throughput": 52.051, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 14, "trial_id": "05971_00000", "date": "2026-02-19_14-47-28", "timestamp": 1771508848, "time_this_iter_s": 124.65673041343689, "time_total_s": 1915.521431684494, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4F520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1915.521431684494, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.283870967741937, "ram_util_percent": 39.79161290322581, "gpu_util_percent0": 0.2650322580645162, "vram_util_percent0": 0.16603999558756324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9273726940155029, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 9.976759918480163, "policy_loss": -0.02704090993592393, "vf_loss": 9.999989045501515, "vf_explained_var": 0.040378309890722774, "kl": 0.016941276885150295, "entropy": 0.5196802222804658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 68295.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": -402.2034999999993, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -5271.510025000011, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 60000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -72.15949999999995}, "policy_reward_mean": {"shared_policy": -1054.3020049999993}, "custom_metrics": {"delivered_mean_agents_mean": 201.18333333333334, "delivered_mean_agents_min": 164.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 22.166666666666668, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.053333333333333344, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.07, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.013333333333333334, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.02666666666666667, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00067204316031771, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.095803065862911, "mean_inference_ms": 5.165163399594883, "mean_action_processing_ms": 0.5804747117924021, "mean_env_wait_ms": 4.046334473035926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016659895579020183, "StateBufferConnector_ms": 0.015076796213785807, "ViewRequirementAgentConnector_ms": 0.5841132005055746}, "num_episodes": 4, "episode_return_max": -402.2034999999993, "episode_return_min": -12201.262500000255, "episode_return_mean": -5271.510025000011, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.051213059329843, "num_env_steps_trained_throughput_per_sec": 31.051213059329843, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 134421.337, "restore_workers_time_ms": 0.0, "training_step_time_ms": 134421.137, "sample_time_ms": 57973.365, "learn_time_ms": 76444.813, "learn_throughput": 52.325, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 15, "trial_id": "05971_00000", "date": "2026-02-19_14-49-37", "timestamp": 1771508977, "time_this_iter_s": 128.82443952560425, "time_total_s": 2044.3458712100983, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADD89D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2044.3458712100983, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.670186335403727, "ram_util_percent": 39.74782608695653, "gpu_util_percent0": 0.27099378881987574, "vram_util_percent0": 0.16849684586138777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9330006837844849, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 9.978271858555496, "policy_loss": -0.025850454299075967, "vf_loss": 9.999998453265796, "vf_explained_var": 0.06155458166088015, "kl": 0.018328282044405796, "entropy": 0.530342061852447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 73005.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": -402.2034999999993, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -5246.126945312512, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 64000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -72.15949999999995}, "policy_reward_mean": {"shared_policy": -1049.2253890624995}, "custom_metrics": {"delivered_mean_agents_mean": 199.125, "delivered_mean_agents_min": 154.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 21.890625, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.065625, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.0125, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.025, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0006300404627978533, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.094000307307702, "mean_inference_ms": 5.154748559215582, "mean_action_processing_ms": 0.5803550110879594, "mean_env_wait_ms": 4.037814325464269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01716725528240204, "StateBufferConnector_ms": 0.014134496450424194, "ViewRequirementAgentConnector_ms": 0.5860183387994766}, "num_episodes": 4, "episode_return_max": -402.2034999999993, "episode_return_min": -12201.262500000255, "episode_return_mean": -5246.126945312512, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.233832110936525, "num_env_steps_trained_throughput_per_sec": 31.233832110936525, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 133993.396, "restore_workers_time_ms": 0.0, "training_step_time_ms": 133993.196, "sample_time_ms": 57521.435, "learn_time_ms": 76468.799, "learn_throughput": 52.309, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 16, "trial_id": "05971_00000", "date": "2026-02-19_14-51-45", "timestamp": 1771509105, "time_this_iter_s": 128.07125973701477, "time_total_s": 2172.417130947113, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADD97E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2172.417130947113, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 22.491139240506328, "ram_util_percent": 39.78670886075949, "gpu_util_percent0": 0.2624683544303798, "vram_util_percent0": 0.16770837842350333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9138250946998596, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 9.973822507230592, "policy_loss": -0.03055980310897934, "vf_loss": 9.999977541881002, "vf_explained_var": 0.03644758575534618, "kl": 0.01957677706069056, "entropy": 0.43378955295384564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 77715.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": -402.2034999999993, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -5092.923772058835, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 68000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -72.15949999999995}, "policy_reward_mean": {"shared_policy": -1018.5847544117643}, "custom_metrics": {"delivered_mean_agents_mean": 196.22058823529412, "delivered_mean_agents_min": 135.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 21.279411764705884, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.06470588235294118, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014705882352941176, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.023529411764705882, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0005929792591038619, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.092105777485752, "mean_inference_ms": 5.144902319124006, "mean_action_processing_ms": 0.5802091279558593, "mean_env_wait_ms": 4.030093499035834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01764332546907313, "StateBufferConnector_ms": 0.013303055482752183, "ViewRequirementAgentConnector_ms": 0.5861163139343262}, "num_episodes": 4, "episode_return_max": -402.2034999999993, "episode_return_min": -12201.262500000255, "episode_return_mean": -5092.923772058835, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.406192116521286, "num_env_steps_trained_throughput_per_sec": 31.406192116521286, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 133502.591, "restore_workers_time_ms": 0.0, "training_step_time_ms": 133502.392, "sample_time_ms": 57308.717, "learn_time_ms": 76190.614, "learn_throughput": 52.5, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 17, "trial_id": "05971_00000", "date": "2026-02-19_14-53-52", "timestamp": 1771509232, "time_this_iter_s": 127.3684298992157, "time_total_s": 2299.7855608463287, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4D750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2299.7855608463287, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 22.265189873417718, "ram_util_percent": 39.87721518987342, "gpu_util_percent0": 0.25854430379746834, "vram_util_percent0": 0.16413569100814404}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8370612263679504, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 9.991399132471429, "policy_loss": -0.011965534135881186, "vf_loss": 9.999948119712231, "vf_explained_var": -0.011551776370172035, "kl": 0.015184685754158121, "entropy": 0.2722440841028392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 82425.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": -97.41649999999743, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -4842.869333333346, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 72000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -13.870000000000072}, "policy_reward_mean": {"shared_policy": -968.5738666666662}, "custom_metrics": {"delivered_mean_agents_mean": 191.83333333333334, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 20.375, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.061111111111111116, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.013888888888888888, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.022222222222222223, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0005600359669314252, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.09108202485232, "mean_inference_ms": 5.137237316388101, "mean_action_processing_ms": 0.5801467381863412, "mean_env_wait_ms": 4.02360435241056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01804365052117242, "StateBufferConnector_ms": 0.013952785068088107, "ViewRequirementAgentConnector_ms": 0.5895406007766724}, "num_episodes": 4, "episode_return_max": -97.41649999999743, "episode_return_min": -12201.262500000255, "episode_return_mean": -4842.869333333346, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.980933095883792, "num_env_steps_trained_throughput_per_sec": 28.980933095883792, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 134426.551, "restore_workers_time_ms": 0.0, "training_step_time_ms": 134426.351, "sample_time_ms": 57910.318, "learn_time_ms": 76513.173, "learn_throughput": 52.279, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 18, "trial_id": "05971_00000", "date": "2026-02-19_14-56-11", "timestamp": 1771509371, "time_this_iter_s": 138.02628326416016, "time_total_s": 2437.811844110489, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADD9870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2437.811844110489, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.740116279069767, "ram_util_percent": 39.751744186046515, "gpu_util_percent0": 0.25465116279069766, "vram_util_percent0": 0.16967612842389881}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1471967697143555, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 9.971838619248375, "policy_loss": -0.03271804156825896, "vf_loss": 9.999743038428564, "vf_explained_var": 0.050364101084933915, "kl": 0.021393869593201668, "entropy": 0.44856854122915085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 87135.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "env_runners": {"episode_reward_max": -97.41649999999743, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -4821.37067763159, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 76000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -13.870000000000072}, "policy_reward_mean": {"shared_policy": -964.2741355263154}, "custom_metrics": {"delivered_mean_agents_mean": 191.10526315789474, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 20.56578947368421, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05526315789473685, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.05789473684210527, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.013157894736842105, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.021052631578947368, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0005305603897245081, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0900966926579505, "mean_inference_ms": 5.128774656577977, "mean_action_processing_ms": 0.5800696390343995, "mean_env_wait_ms": 4.01771094404613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017093984704268605, "StateBufferConnector_ms": 0.014535063191464073, "ViewRequirementAgentConnector_ms": 0.5882746294925087}, "num_episodes": 4, "episode_return_max": -97.41649999999743, "episode_return_min": -12201.262500000255, "episode_return_mean": -4821.37067763159, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.85744502457359, "num_env_steps_trained_throughput_per_sec": 32.85744502457359, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 132538.882, "restore_workers_time_ms": 0.0, "training_step_time_ms": 132538.682, "sample_time_ms": 57290.399, "learn_time_ms": 75245.522, "learn_throughput": 53.159, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "training_iteration": 19, "trial_id": "05971_00000", "date": "2026-02-19_14-58-12", "timestamp": 1771509492, "time_this_iter_s": 121.74401235580444, "time_total_s": 2559.5558564662933, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4EB90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2559.5558564662933, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.834000000000003, "ram_util_percent": 39.91266666666667, "gpu_util_percent0": 0.25646666666666673, "vram_util_percent0": 0.164254193128155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9084019660949707, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.976210070972483, "policy_loss": -0.029252946953884387, "vf_loss": 10.0, "vf_explained_var": 0.06326953748482302, "kl": 0.016186722619719006, "entropy": 0.501168509121913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 91845.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": -97.41649999999743, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -4861.94893750001, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 80000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -13.870000000000072}, "policy_reward_mean": {"shared_policy": -972.3897874999997}, "custom_metrics": {"delivered_mean_agents_mean": 189.8625, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 20.9, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05500000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.057499999999999996, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.015, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.02, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0005040323702382827, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.088737763099883, "mean_inference_ms": 5.1198533278188645, "mean_action_processing_ms": 0.5799736653460362, "mean_env_wait_ms": 4.0121370361635105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016239285469055176, "StateBufferConnector_ms": 0.01380831003189087, "ViewRequirementAgentConnector_ms": 0.5870437622070312}, "num_episodes": 4, "episode_return_max": -97.41649999999743, "episode_return_min": -12201.262500000255, "episode_return_mean": -4861.94893750001, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.243433169569286, "num_env_steps_trained_throughput_per_sec": 31.243433169569286, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 132164.643, "restore_workers_time_ms": 0.0, "training_step_time_ms": 132164.443, "sample_time_ms": 57068.512, "learn_time_ms": 75093.27, "learn_throughput": 53.267, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 20, "trial_id": "05971_00000", "date": "2026-02-19_15-00-20", "timestamp": 1771509620, "time_this_iter_s": 128.03190326690674, "time_total_s": 2687.5877597332, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADD89D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2687.5877597332, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.232704402515722, "ram_util_percent": 39.49622641509435, "gpu_util_percent0": 0.23283018867924535, "vram_util_percent0": 0.16916610594427192}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8833181858062744, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.985605832118138, "policy_loss": -0.020240635446899604, "vf_loss": 10.0, "vf_explained_var": -0.002993899039655228, "kl": 0.01732288846772792, "entropy": 0.31174647790358073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 96555.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": -97.41649999999743, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -4681.922785714296, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 84000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -13.870000000000072}, "policy_reward_mean": {"shared_policy": -936.3845571428567}, "custom_metrics": {"delivered_mean_agents_mean": 186.6904761904762, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 20.13095238095238, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05238095238095238, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.05714285714285714, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014285714285714285, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.01904761904761905, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00048003082879836446, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.086253321096272, "mean_inference_ms": 5.110549856106597, "mean_action_processing_ms": 0.5797290982087739, "mean_env_wait_ms": 4.006007167929564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017850739615304128, "StateBufferConnector_ms": 0.013150771458943685, "ViewRequirementAgentConnector_ms": 0.5793648106711251}, "num_episodes": 4, "episode_return_max": -97.41649999999743, "episode_return_min": -12201.262500000255, "episode_return_mean": -4681.922785714296, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.54947836175095, "num_env_steps_trained_throughput_per_sec": 31.54947836175095, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 130852.028, "restore_workers_time_ms": 0.0, "training_step_time_ms": 130851.828, "sample_time_ms": 56185.28, "learn_time_ms": 74663.849, "learn_throughput": 53.573, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 21, "trial_id": "05971_00000", "date": "2026-02-19_15-02-27", "timestamp": 1771509747, "time_this_iter_s": 126.79097890853882, "time_total_s": 2814.378738641739, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADDB760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2814.378738641739, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.62721518987342, "ram_util_percent": 39.25569620253165, "gpu_util_percent0": 0.26012658227848107, "vram_util_percent0": 0.17215993766734897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8138318657875061, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.979624412115465, "policy_loss": -0.025744291042193234, "vf_loss": 9.999984885375717, "vf_explained_var": 0.043701689891248244, "kl": 0.01595203361188147, "entropy": 0.4079202218040539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 101265.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": -97.41649999999743, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -4667.463471590918, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 88000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -13.870000000000072}, "policy_reward_mean": {"shared_policy": -933.4926943181813}, "custom_metrics": {"delivered_mean_agents_mean": 185.11363636363637, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 19.90909090909091, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.052272727272727276, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.056818181818181816, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.013636363636363636, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.018181818181818184, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00045821124567116606, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.082753237158157, "mean_inference_ms": 5.100923462772411, "mean_action_processing_ms": 0.5793806386116795, "mean_env_wait_ms": 3.9995104676647744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019311633977023037, "StateBufferConnector_ms": 0.01255300911990079, "ViewRequirementAgentConnector_ms": 0.5747098814357411}, "num_episodes": 4, "episode_return_max": -97.41649999999743, "episode_return_min": -12201.262500000255, "episode_return_mean": -4667.463471590918, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.530500255850924, "num_env_steps_trained_throughput_per_sec": 30.530500255850924, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 128951.163, "restore_workers_time_ms": 0.0, "training_step_time_ms": 128950.963, "sample_time_ms": 55252.895, "learn_time_ms": 73695.368, "learn_throughput": 54.277, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 22, "trial_id": "05971_00000", "date": "2026-02-19_15-04-38", "timestamp": 1771509878, "time_this_iter_s": 131.02452206611633, "time_total_s": 2945.403260707855, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE645E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2945.403260707855, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.70731707317073, "ram_util_percent": 39.25426829268292, "gpu_util_percent0": 0.26567073170731703, "vram_util_percent0": 0.17281536335148404}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8814200162887573, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.979184330091861, "policy_loss": -0.025609231062110854, "vf_loss": 9.999947671829515, "vf_explained_var": 0.03602198169995772, "kl": 0.01435815557768987, "entropy": 0.39465117900614527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 105975.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "env_runners": {"episode_reward_max": -97.41649999999743, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -4611.085983695661, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 92000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -13.870000000000072}, "policy_reward_mean": {"shared_policy": -922.21719673913}, "custom_metrics": {"delivered_mean_agents_mean": 183.7608695652174, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 19.684782608695652, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05217391304347827, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.05434782608695652, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.015217391304347825, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.017391304347826087, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00043828901759850665, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.079864247979138, "mean_inference_ms": 5.093288003651105, "mean_action_processing_ms": 0.5791479731294242, "mean_env_wait_ms": 3.9939340505107253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020640829335088314, "StateBufferConnector_ms": 0.013094363005264946, "ViewRequirementAgentConnector_ms": 0.5810688371243684}, "num_episodes": 4, "episode_return_max": -97.41649999999743, "episode_return_min": -12201.262500000255, "episode_return_mean": -4611.085983695661, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.258219432380073, "num_env_steps_trained_throughput_per_sec": 28.258219432380073, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 129604.278, "restore_workers_time_ms": 0.0, "training_step_time_ms": 129604.079, "sample_time_ms": 55545.214, "learn_time_ms": 74056.265, "learn_throughput": 54.013, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "training_iteration": 23, "trial_id": "05971_00000", "date": "2026-02-19_15-07-00", "timestamp": 1771510020, "time_this_iter_s": 141.5582411289215, "time_total_s": 3086.9615018367767, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADDA440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3086.9615018367767, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 27.535227272727273, "ram_util_percent": 39.75227272727273, "gpu_util_percent0": 0.2420454545454545, "vram_util_percent0": 0.17583312053115424}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8777977228164673, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.977067763537105, "policy_loss": -0.02865066699112218, "vf_loss": 9.999987356829795, "vf_explained_var": 0.03866106336283836, "kl": 0.01698098408064148, "entropy": 0.4411364703294831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 110685.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": -97.41649999999743, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -4636.121713541676, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 96000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -13.870000000000072}, "policy_reward_mean": {"shared_policy": -927.2243427083326}, "custom_metrics": {"delivered_mean_agents_mean": 182.875, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 19.78125, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.05625, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.05416666666666667, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014583333333333335, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.016666666666666666, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00042002697519856886, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0773439546164445, "mean_inference_ms": 5.086536071672338, "mean_action_processing_ms": 0.5789424681292495, "mean_env_wait_ms": 3.988557995012814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020827601353327434, "StateBufferConnector_ms": 0.013587623834609985, "ViewRequirementAgentConnector_ms": 0.5736470222473145}, "num_episodes": 4, "episode_return_max": -97.41649999999743, "episode_return_min": -12201.262500000255, "episode_return_mean": -4636.121713541676, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.55270703399263, "num_env_steps_trained_throughput_per_sec": 28.55270703399263, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 131148.185, "restore_workers_time_ms": 0.0, "training_step_time_ms": 131147.985, "sample_time_ms": 55872.283, "learn_time_ms": 75273.101, "learn_throughput": 53.14, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 24, "trial_id": "05971_00000", "date": "2026-02-19_15-09-20", "timestamp": 1771510160, "time_this_iter_s": 140.09979557991028, "time_total_s": 3227.061297416687, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADD8D30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3227.061297416687, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.836781609195405, "ram_util_percent": 40.21551724137931, "gpu_util_percent0": 0.2543103448275862, "vram_util_percent0": 0.17715229463919727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7371839284896851, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.989613424491477, "policy_loss": -0.016049142062640305, "vf_loss": 10.0, "vf_explained_var": 0.010251640640752837, "kl": 0.016778016347374282, "entropy": 0.2648613999761847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 115395.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -4488.9333800000095, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -897.7866759999995}, "custom_metrics": {"delivered_mean_agents_mean": 179.46, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 19.03, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.054000000000000006, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.054000000000000006, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014000000000000002, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.016, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0004032258961906261, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-6335.00700000004, -10978.846000000007, -8591.289500000057, -7390.535000000003, -8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1265.2039999999984, -1270.8679999999981, -1263.158499999997, -1264.848499999998, -1270.9279999999987, -2193.1510000000026, -2203.423000000001, -2191.2360000000017, -2192.6175000000003, -2198.4184999999998, -1716.174499999998, -1722.8024999999964, -1718.9879999999976, -1712.4469999999983, -1720.8774999999969, -1472.0494999999985, -1479.0849999999984, -1478.4479999999983, -1478.955999999998, -1481.9964999999988, -1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.075609436863887, "mean_inference_ms": 5.080832640963787, "mean_action_processing_ms": 0.5788247503003522, "mean_env_wait_ms": 3.983970988299552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020992279052734375, "StateBufferConnector_ms": 0.01504063606262207, "ViewRequirementAgentConnector_ms": 0.5745127201080322}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -12201.262500000255, "episode_return_mean": -4488.9333800000095, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.824019341728004, "num_env_steps_trained_throughput_per_sec": 28.824019341728004, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 132143.456, "restore_workers_time_ms": 0.0, "training_step_time_ms": 132143.456, "sample_time_ms": 56651.283, "learn_time_ms": 75489.472, "learn_throughput": 52.988, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "training_iteration": 25, "trial_id": "05971_00000", "date": "2026-02-19_15-11-39", "timestamp": 1771510299, "time_this_iter_s": 138.7801456451416, "time_total_s": 3365.8414430618286, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC89D1DAB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3365.8414430618286, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 23.993641618497108, "ram_util_percent": 40.70809248554913, "gpu_util_percent0": 0.2446820809248555, "vram_util_percent0": 0.19019585972422634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3301242589950562, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.983671144619109, "policy_loss": -0.021358755463239936, "vf_loss": 9.999602060054771, "vf_explained_var": 0.022951553277908616, "kl": 0.016082509213311245, "entropy": 0.3064171867037781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 120105.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -12201.262500000255, "episode_reward_mean": -4194.975195000008, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2446.653999999989}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -838.9950389999997}, "custom_metrics": {"delivered_mean_agents_mean": 175.39, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 17.98, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.054000000000000006, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.04800000000000001, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.012, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.014000000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00035756379573400514, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-8744.91499999996, -8611.85550000001, -10177.408999999956, -12201.262500000255, -7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1746.3800000000017, -1753.8925000000017, -1744.5255000000006, -1742.1825000000017, -1757.9345000000008, -1712.7409999999984, -1724.719499999998, -1715.9974999999997, -1723.5584999999992, -1734.8389999999995, -2030.214999999998, -2044.7049999999995, -2029.6119999999985, -2035.9909999999968, -2036.8859999999997, -2437.3929999999887, -2446.653999999989, -2429.484999999991, -2441.8549999999905, -2445.87549999999, -1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.076573102240491, "mean_inference_ms": 5.063504706260847, "mean_action_processing_ms": 0.5791010825873303, "mean_env_wait_ms": 3.952891687566354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999354362487793, "StateBufferConnector_ms": 0.01401066780090332, "ViewRequirementAgentConnector_ms": 0.5800540447235107}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -12201.262500000255, "episode_return_mean": -4194.975195000008, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.579067788132356, "num_env_steps_trained_throughput_per_sec": 30.579067788132356, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 132417.674, "restore_workers_time_ms": 0.0, "training_step_time_ms": 132417.574, "sample_time_ms": 56628.525, "learn_time_ms": 75786.349, "learn_throughput": 52.78, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 26, "trial_id": "05971_00000", "date": "2026-02-19_15-13-50", "timestamp": 1771510430, "time_this_iter_s": 130.81343507766724, "time_total_s": 3496.654878139496, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE64040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3496.654878139496, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 20.4638036809816, "ram_util_percent": 40.35460122699386, "gpu_util_percent0": 0.2761963190184049, "vram_util_percent0": 0.19109065788330074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7771821022033691, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.981485332399924, "policy_loss": -0.023317304781920845, "vf_loss": 10.0, "vf_explained_var": 0.015172234955866625, "kl": 0.014230023527632047, "entropy": 0.3510033537311412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 124815.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10812.813000000067, "episode_reward_mean": -3863.3173100000067, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2170.804999999996}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -772.6634619999999}, "custom_metrics": {"delivered_mean_agents_mean": 171.28, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 17.12, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.054000000000000006, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.05400000000000001, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.012, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.014000000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00035756379573400514, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-7497.967000000007, -10556.608500000102, -10812.813000000067, -8529.748500000005, -7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1494.2460000000005, -1504.7104999999997, -1492.9055, -1502.0814999999998, -1504.0235, -2102.7789999999954, -2112.772499999995, -2108.247499999995, -2111.3509999999956, -2121.458499999995, -2157.522999999995, -2168.135499999996, -2160.8944999999962, -2155.4549999999963, -2170.804999999996, -1699.3245, -1706.8850000000007, -1703.9960000000017, -1703.4580000000008, -1716.085000000001, -1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.081691778163694, "mean_inference_ms": 5.053226595269691, "mean_action_processing_ms": 0.5796117889606498, "mean_env_wait_ms": 3.942702026558385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02097320556640625, "StateBufferConnector_ms": 0.015005111694335938, "ViewRequirementAgentConnector_ms": 0.5776059627532959}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10812.813000000067, "episode_return_mean": -3863.3173100000067, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.68623012468605, "num_env_steps_trained_throughput_per_sec": 29.68623012468605, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 133155.592, "restore_workers_time_ms": 0.0, "training_step_time_ms": 133155.492, "sample_time_ms": 56412.122, "learn_time_ms": 76740.615, "learn_throughput": 52.124, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 27, "trial_id": "05971_00000", "date": "2026-02-19_15-16-05", "timestamp": 1771510565, "time_this_iter_s": 134.74865245819092, "time_total_s": 3631.4035305976868, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AD4F400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3631.4035305976868, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 23.10059880239521, "ram_util_percent": 40.380239520958085, "gpu_util_percent0": 0.25832335329341316, "vram_util_percent0": 0.19099295302896893}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7704893946647644, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.985284663360337, "policy_loss": -0.01982869801038358, "vf_loss": 10.0, "vf_explained_var": 0.0001762252957451369, "kl": 0.01515066319649022, "entropy": 0.3589980670411116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 129525.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -3555.186900000005, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -711.0373799999998}, "custom_metrics": {"delivered_mean_agents_mean": 167.77, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 15.96, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.052000000000000005, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.05600000000000001, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.012, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.012000000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00030994474811495745, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-7692.183500000051, -8182.659499999965, -8041.680999999914, -7372.1639999999925, -3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1536.095999999998, -1539.4594999999983, -1538.4184999999986, -1526.2389999999984, -1551.9704999999976, -1631.016000000002, -1641.1585000000025, -1639.7795000000024, -1628.2235000000032, -1642.4820000000018, -1605.9250000000045, -1613.536000000004, -1607.987000000004, -1597.4440000000036, -1616.7890000000048, -1469.9594999999997, -1481.017, -1466.6000000000008, -1473.5590000000004, -1481.0285000000003, -658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.07711762280273, "mean_inference_ms": 5.03796049112413, "mean_action_processing_ms": 0.5795316717253391, "mean_env_wait_ms": 3.933017144495756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02097320556640625, "StateBufferConnector_ms": 0.015005111694335938, "ViewRequirementAgentConnector_ms": 0.5753166675567627}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -3555.186900000005, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.46422071824367, "num_env_steps_trained_throughput_per_sec": 30.46422071824367, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 132483.571, "restore_workers_time_ms": 0.0, "training_step_time_ms": 132483.471, "sample_time_ms": 55671.665, "learn_time_ms": 76809.001, "learn_throughput": 52.077, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 28, "trial_id": "05971_00000", "date": "2026-02-19_15-18-16", "timestamp": 1771510696, "time_this_iter_s": 131.30757999420166, "time_total_s": 3762.7111105918884, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADD89D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3762.7111105918884, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.060365853658535, "ram_util_percent": 40.64817073170733, "gpu_util_percent0": 0.2633536585365854, "vram_util_percent0": 0.19095166037151337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8085824847221375, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.973980302263977, "policy_loss": -0.031358559443289115, "vf_loss": 10.0, "vf_explained_var": 0.03996917952144728, "kl": 0.01581880665364337, "entropy": 0.4206932306795869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 134235.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -3371.4242450000056, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -674.2848489999997}, "custom_metrics": {"delivered_mean_agents_mean": 165.1, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 15.14, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.04800000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.05800000000000001, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.013999999999999999, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.012000000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00030994474811495745, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-3317.8944999999967, -1574.9634999999837, -7048.143500000032, -5521.432999999956, -660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-658.6985000000006, -660.2200000000007, -671.9900000000008, -658.0380000000006, -668.9480000000009, -314.14699999999993, -312.92749999999995, -315.50999999999993, -312.6100000000001, -319.76899999999983, -1406.2449999999976, -1409.9769999999976, -1409.3379999999977, -1407.1334999999985, -1415.449999999998, -1105.3770000000015, -1108.7525000000016, -1102.329000000001, -1096.8050000000014, -1108.1695000000009, -130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0705653195554, "mean_inference_ms": 5.023918521110451, "mean_action_processing_ms": 0.5791245965100768, "mean_env_wait_ms": 3.9231382671992594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01997542381286621, "StateBufferConnector_ms": 0.015005111694335938, "ViewRequirementAgentConnector_ms": 0.5699889659881592}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -3371.4242450000056, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.90674732399178, "num_env_steps_trained_throughput_per_sec": 30.90674732399178, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 133251.928, "restore_workers_time_ms": 0.0, "training_step_time_ms": 133251.828, "sample_time_ms": 55374.932, "learn_time_ms": 77874.09, "learn_throughput": 51.365, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "training_iteration": 29, "trial_id": "05971_00000", "date": "2026-02-19_15-20-26", "timestamp": 1771510826, "time_this_iter_s": 129.42816758155823, "time_total_s": 3892.1392781734467, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE66D40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3892.1392781734467, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 19.62901234567901, "ram_util_percent": 40.760493827160495, "gpu_util_percent0": 0.27030864197530863, "vram_util_percent0": 0.19063956889636746}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8372899293899536, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.971298839382811, "policy_loss": -0.03506081331572683, "vf_loss": 10.0, "vf_explained_var": 0.0266950978215333, "kl": 0.01884341672779055, "entropy": 0.40974781113951575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 138945.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -3291.7018000000057, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -658.3403599999998}, "custom_metrics": {"delivered_mean_agents_mean": 162.25, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 14.7, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.04800000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.057999999999999996, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.013999999999999999, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.012000000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00030994474811495745, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-660.1570000000073, -2357.751999999961, -1445.0364999999967, -627.5800000000035, -4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-130.26949999999974, -127.91849999999984, -137.62449999999959, -128.01449999999986, -136.32999999999953, -463.93350000000044, -468.56950000000063, -482.44000000000096, -464.0520000000006, -478.7570000000009, -281.91999999999996, -288.5095000000001, -295.8700000000005, -287.0485000000001, -291.68850000000015, -120.4159999999998, -124.56399999999972, -135.77949999999984, -117.66049999999987, -129.15999999999977, -953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0639701497811584, "mean_inference_ms": 5.011028538615522, "mean_action_processing_ms": 0.5784758749863014, "mean_env_wait_ms": 3.913604912581119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018967628479003906, "StateBufferConnector_ms": 0.015005111694335938, "ViewRequirementAgentConnector_ms": 0.5785305500030518}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -3291.7018000000057, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.979944176214698, "num_env_steps_trained_throughput_per_sec": 30.979944176214698, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 133360.817, "restore_workers_time_ms": 0.0, "training_step_time_ms": 133360.717, "sample_time_ms": 55178.193, "learn_time_ms": 78179.618, "learn_throughput": 51.164, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 30, "trial_id": "05971_00000", "date": "2026-02-19_15-22-35", "timestamp": 1771510955, "time_this_iter_s": 129.12279081344604, "time_total_s": 4021.2620689868927, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE660E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4021.2620689868927, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 20.05679012345679, "ram_util_percent": 40.766666666666666, "gpu_util_percent0": 0.2774074074074074, "vram_util_percent0": 0.1891664706556418}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.880169689655304, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.97629627685385, "policy_loss": -0.029525497593203137, "vf_loss": 10.0, "vf_explained_var": 0.035624866551401256, "kl": 0.01724971796051386, "entropy": 0.44107367794984464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 143655.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -3399.2272100000077, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -679.8454419999996}, "custom_metrics": {"delivered_mean_agents_mean": 159.49, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 15.12, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 43.0, "manual_delivery_mean_agents_mean": 0.044000000000000004, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.057999999999999996, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.012000000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00030994474811495745, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-4832.457000000025, -6796.3140000000685, -2326.4980000000055, -8482.271500000028, -425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-953.4515000000005, -969.6215000000005, -970.163000000001, -968.4830000000009, -970.7380000000011, -1350.8434999999986, -1365.0784999999973, -1357.7429999999981, -1363.0309999999972, -1359.6179999999972, -463.7979999999999, -457.92699999999996, -469.72699999999975, -465.9219999999999, -469.1239999999998, -1695.7519999999975, -1700.9274999999975, -1689.3864999999964, -1699.2009999999968, -1697.0044999999966, -82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0571274824094825, "mean_inference_ms": 5.000719854295015, "mean_action_processing_ms": 0.5776899413306973, "mean_env_wait_ms": 3.9041173025928515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01596856117248535, "StateBufferConnector_ms": 0.014006853103637695, "ViewRequirementAgentConnector_ms": 0.5735130310058594}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -3399.2272100000077, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.29604207991488, "num_env_steps_trained_throughput_per_sec": 30.29604207991488, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 133885.363, "restore_workers_time_ms": 0.0, "training_step_time_ms": 133885.263, "sample_time_ms": 55437.895, "learn_time_ms": 78444.457, "learn_throughput": 50.991, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "done": false, "training_iteration": 31, "trial_id": "05971_00000", "date": "2026-02-19_15-24-47", "timestamp": 1771511087, "time_this_iter_s": 132.0374448299408, "time_total_s": 4153.2995138168335, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADD9FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4153.2995138168335, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.17439024390244, "ram_util_percent": 40.66829268292683, "gpu_util_percent0": 0.2604878048780488, "vram_util_percent0": 0.18865874509990824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8339940309524536, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.976644362512415, "policy_loss": -0.02854802353295741, "vf_loss": 10.0, "vf_explained_var": 0.01384675101616327, "kl": 0.015384836620047573, "entropy": 0.3931933187944874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -3317.6265800000056, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -663.5253159999996}, "custom_metrics": {"delivered_mean_agents_mean": 155.39, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 14.39, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.044000000000000004, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.057999999999999996, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.012000000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00030994474811495745, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-425.9790000000031, -5455.479000000007, -2803.7739999999535, -1287.341999999995, -4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-82.08999999999986, -77.5669999999999, -101.02999999999979, -78.94249999999992, -86.3494999999998, -1083.3789999999995, -1092.7459999999999, -1094.7984999999999, -1092.1320000000003, -1092.4234999999994, -554.6929999999998, -560.7445, -561.9029999999997, -552.4234999999998, -574.0100000000002, -253.29750000000004, -250.52600000000015, -265.18, -250.56850000000003, -267.77000000000015, -943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.051373744108319, "mean_inference_ms": 4.9899828011849365, "mean_action_processing_ms": 0.5769221762292196, "mean_env_wait_ms": 3.8962588727327203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017966747283935547, "StateBufferConnector_ms": 0.01350259780883789, "ViewRequirementAgentConnector_ms": 0.5761590003967285}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -3317.6265800000056, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.046666972070856, "num_env_steps_trained_throughput_per_sec": 29.046666972070856, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 134554.654, "restore_workers_time_ms": 0.1, "training_step_time_ms": 134554.454, "sample_time_ms": 56452.687, "learn_time_ms": 78098.853, "learn_throughput": 51.217, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 32, "trial_id": "05971_00000", "date": "2026-02-19_15-27-05", "timestamp": 1771511225, "time_this_iter_s": 137.71943283081055, "time_total_s": 4291.018946647644, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC89C95EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4291.018946647644, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 27.99005847953216, "ram_util_percent": 39.80350877192982, "gpu_util_percent0": 0.270233918128655, "vram_util_percent0": 0.1684736185031868}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9466547966003418, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.971826551522419, "policy_loss": -0.03378958379901202, "vf_loss": 9.999984278547283, "vf_explained_var": 0.04761555079695019, "kl": 0.01668694974206731, "entropy": 0.5262621160525425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 153075.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -3468.0682250000045, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -693.6136449999998}, "custom_metrics": {"delivered_mean_agents_mean": 153.64, "delivered_mean_agents_min": 51.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 14.59, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.044000000000000004, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.055999999999999994, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.012000000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00030994474811495745, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-4771.6130000000285, -430.6964999999998, -610.875000000002, -402.2034999999993, -706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-943.6289999999993, -962.2394999999991, -958.0694999999993, -953.7879999999992, -953.8869999999994, -80.2585000000001, -84.33850000000014, -98.61, -82.04950000000002, -85.43999999999997, -116.15600000000026, -113.72400000000033, -138.9099999999999, -117.46300000000035, -124.6220000000001, -76.76599999999998, -77.16099999999994, -95.65000000000002, -72.15949999999995, -80.46699999999997, -134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.046846297835819, "mean_inference_ms": 4.9819925457746965, "mean_action_processing_ms": 0.5763706781629987, "mean_env_wait_ms": 3.8901219100264792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0189666748046875, "StateBufferConnector_ms": 0.013499259948730469, "ViewRequirementAgentConnector_ms": 0.5863363742828369}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -3468.0682250000045, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.852659941062193, "num_env_steps_trained_throughput_per_sec": 30.852659941062193, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 133364.327, "restore_workers_time_ms": 0.1, "training_step_time_ms": 133364.127, "sample_time_ms": 56091.249, "learn_time_ms": 77269.864, "learn_throughput": 51.767, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "training_iteration": 33, "trial_id": "05971_00000", "date": "2026-02-19_15-29-14", "timestamp": 1771511354, "time_this_iter_s": 129.65546917915344, "time_total_s": 4420.6744158267975, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE66B90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4420.6744158267975, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 24.783749999999998, "ram_util_percent": 40.013125, "gpu_util_percent0": 0.25237499999999996, "vram_util_percent0": 0.1679660784074255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8982619047164917, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.977564513455532, "policy_loss": -0.027995856180431166, "vf_loss": 10.0, "vf_explained_var": 0.04757827473547302, "kl": 0.016475166271619504, "entropy": 0.43934578174238753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 157785.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -3607.2277250000056, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -721.4455449999997}, "custom_metrics": {"delivered_mean_agents_mean": 151.22, "delivered_mean_agents_min": 44.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 15.11, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.04, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.052000000000000005, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.012000000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00030994474811495745, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-706.9649999999995, -1995.3690000000026, -1734.0044999999727, -1666.837000000015, -3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-134.33649999999983, -135.9539999999999, -154.38000000000017, -137.38599999999985, -144.90849999999992, -389.8105000000001, -401.25800000000004, -411.91, -391.1524999999999, -401.23800000000034, -342.5300000000007, -338.06050000000084, -360.56000000000046, -344.8845000000007, -347.9695000000003, -322.30599999999924, -337.232999999999, -344.4389999999994, -326.9389999999993, -335.91999999999916, -796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.041109175900705, "mean_inference_ms": 4.973576251243544, "mean_action_processing_ms": 0.5758344621589476, "mean_env_wait_ms": 3.8841843081874474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020966291427612305, "StateBufferConnector_ms": 0.013499259948730469, "ViewRequirementAgentConnector_ms": 0.59967041015625}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -3607.2277250000056, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.272414187810284, "num_env_steps_trained_throughput_per_sec": 28.272414187810284, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 133503.214, "restore_workers_time_ms": 0.1, "training_step_time_ms": 133503.014, "sample_time_ms": 56643.525, "learn_time_ms": 76856.576, "learn_throughput": 52.045, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 34, "trial_id": "05971_00000", "date": "2026-02-19_15-31-36", "timestamp": 1771511496, "time_this_iter_s": 141.49025797843933, "time_total_s": 4562.164673805237, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE66830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4562.164673805237, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 32.28114285714286, "ram_util_percent": 41.175999999999995, "gpu_util_percent0": 0.2589714285714286, "vram_util_percent0": 0.17947030497592298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.95505291223526, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.973843121984203, "policy_loss": -0.03197165586987625, "vf_loss": 9.99998569083568, "vf_explained_var": 0.07566457988097157, "kl": 0.017271372935878902, "entropy": 0.5852272460541654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 162495.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -3908.3771150000066, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -781.6754229999996}, "custom_metrics": {"delivered_mean_agents_mean": 151.16, "delivered_mean_agents_min": 44.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 15.71, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.044000000000000004, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.05, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.01, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00025839835636238016, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-3993.4135000000265, -7880.358500000014, -8060.96050000006, -7387.069500000018, -1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-796.8835, -799.1689999999999, -808.0724999999994, -789.6700000000001, -799.6185000000002, -1577.2744999999977, -1578.7884999999976, -1571.6154999999956, -1568.926999999997, -1583.7529999999979, -1608.4384999999982, -1621.8504999999975, -1613.1739999999982, -1606.5569999999984, -1610.9404999999983, -1472.5840000000019, -1480.5050000000017, -1479.3355000000006, -1478.3170000000011, -1476.3280000000004, -210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.035585648148069, "mean_inference_ms": 4.966362940571333, "mean_action_processing_ms": 0.5753834304472378, "mean_env_wait_ms": 3.878673835978068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020968914031982422, "StateBufferConnector_ms": 0.013499259948730469, "ViewRequirementAgentConnector_ms": 0.5916023254394531}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -3908.3771150000066, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.10321237135416, "num_env_steps_trained_throughput_per_sec": 30.10321237135416, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 700000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 132913.517, "restore_workers_time_ms": 0.1, "training_step_time_ms": 132913.317, "sample_time_ms": 56111.133, "learn_time_ms": 76799.272, "learn_throughput": 52.084, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "done": false, "training_iteration": 35, "trial_id": "05971_00000", "date": "2026-02-19_15-33-49", "timestamp": 1771511629, "time_this_iter_s": 132.88569831848145, "time_total_s": 4695.050372123718, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADDB910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4695.050372123718, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 23.23855421686747, "ram_util_percent": 41.04578313253012, "gpu_util_percent0": 0.23873493975903612, "vram_util_percent0": 0.17673306808082356}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9543833136558533, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.971838454430776, "policy_loss": -0.0338783109244236, "vf_loss": 10.0, "vf_explained_var": 0.063327136022017, "kl": 0.01693858558924457, "entropy": 0.5604759839436557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 167205.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -3984.516350000005, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -796.9032699999997}, "custom_metrics": {"delivered_mean_agents_mean": 150.7, "delivered_mean_agents_min": 44.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 15.93, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.04, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.05, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014000000000000002, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.01, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00025839835636238016, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-1070.8050000000094, -8486.588000000094, -6304.193499999996, -1397.3995000000118, -7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-210.43049999999883, -212.6619999999988, -227.28999999999883, -206.26249999999894, -214.1599999999988, -1699.1389999999963, -1708.8259999999957, -1697.908999999997, -1690.1394999999964, -1690.5744999999972, -1250.4429999999993, -1264.721499999999, -1268.5059999999985, -1258.4529999999993, -1262.0700000000002, -271.7485000000003, -275.3175000000003, -294.8799999999999, -273.71350000000024, -281.74000000000007, -1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.030378419369936, "mean_inference_ms": 4.9588697773026835, "mean_action_processing_ms": 0.5748948365393907, "mean_env_wait_ms": 3.873203569624018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020968914031982422, "StateBufferConnector_ms": 0.014501333236694336, "ViewRequirementAgentConnector_ms": 0.5878801345825195}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -3984.516350000005, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.890569605191512, "num_env_steps_trained_throughput_per_sec": 29.890569605191512, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 133214.821, "restore_workers_time_ms": 0.1, "training_step_time_ms": 133214.721, "sample_time_ms": 56887.318, "learn_time_ms": 76324.487, "learn_throughput": 52.408, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 36, "trial_id": "05971_00000", "date": "2026-02-19_15-36-03", "timestamp": 1771511763, "time_this_iter_s": 133.82747054100037, "time_total_s": 4828.877842664719, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADD8F70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4828.877842664719, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 26.897590361445783, "ram_util_percent": 41.14518072289157, "gpu_util_percent0": 0.29042168674698793, "vram_util_percent0": 0.17200016480185523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9755063056945801, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.973614913794645, "policy_loss": -0.03196860028929107, "vf_loss": 9.999982648391885, "vf_explained_var": 0.06640639464566662, "kl": 0.016595132414109752, "entropy": 0.47005107561620685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 171915.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -4104.666445000004, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -820.9332889999996}, "custom_metrics": {"delivered_mean_agents_mean": 149.09, "delivered_mean_agents_min": 44.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 16.62, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.038000000000000006, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.046000000000000006, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014000000000000002, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.008, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0002110049914334702, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-7980.074999999939, -10352.595499999996, -5705.872500000039, -4926.987500000057, -5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1587.1595000000036, -1598.486000000003, -1595.1400000000035, -1597.7030000000036, -1601.5865000000028, -2069.1799999999994, -2074.7364999999986, -2062.575999999998, -2075.7524999999987, -2070.3504999999996, -1135.5734999999977, -1141.587999999998, -1147.3684999999982, -1136.917999999998, -1144.4244999999987, -985.3654999999991, -973.6039999999994, -991.1714999999996, -984.770499999999, -992.0759999999997, -1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.025042152983443, "mean_inference_ms": 4.949695916115629, "mean_action_processing_ms": 0.574332315312988, "mean_env_wait_ms": 3.867686214885747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021968603134155273, "StateBufferConnector_ms": 0.01350712776184082, "ViewRequirementAgentConnector_ms": 0.585460901260376}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -4104.666445000004, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.919699698580736, "num_env_steps_trained_throughput_per_sec": 32.919699698580736, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 740000, "timers": {"training_iteration_time_ms": 131891.34, "restore_workers_time_ms": 0.1, "training_step_time_ms": 131891.239, "sample_time_ms": 56784.204, "learn_time_ms": 75104.274, "learn_throughput": 53.259, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000}, "done": false, "training_iteration": 37, "trial_id": "05971_00000", "date": "2026-02-19_15-38-04", "timestamp": 1771511884, "time_this_iter_s": 121.51469898223877, "time_total_s": 4950.392541646957, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE66DD0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4950.392541646957, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 19.879333333333335, "ram_util_percent": 40.913999999999994, "gpu_util_percent0": 0.26613333333333333, "vram_util_percent0": 0.1736028334147533}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9239975214004517, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.973036724949086, "policy_loss": -0.033516981599915716, "vf_loss": 10.0, "vf_explained_var": 0.055804139527545614, "kl": 0.019418391015733817, "entropy": 0.43347693635526485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 176625.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10490.235499999895, "episode_reward_mean": -4065.081135000006, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2107.4394999999977}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -813.0162269999997}, "custom_metrics": {"delivered_mean_agents_mean": 147.96, "delivered_mean_agents_min": 44.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 16.28, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.038000000000000006, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.044000000000000004, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.006000000000000001, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00015724155057325517, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.00558659217877095}, "hist_stats": {"episode_reward": [-5546.676999999992, -1596.7674999999754, -6228.813000000042, -6268.492499999994, -2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1108.4530000000013, -1102.3090000000013, -1114.4985000000013, -1107.8170000000016, -1113.5995000000014, -313.45050000000003, -316.26000000000016, -333.8500000000005, -312.3325000000001, -320.8745000000001, -1243.8544999999972, -1245.9689999999973, -1252.339499999998, -1241.0149999999971, -1245.6349999999975, -1246.0639999999999, -1251.8184999999994, -1258.8194999999985, -1254.9449999999997, -1256.8454999999988, -570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.019827298931777, "mean_inference_ms": 4.940215461734043, "mean_action_processing_ms": 0.5737210320094429, "mean_env_wait_ms": 3.8622321553617325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021968603134155273, "StateBufferConnector_ms": 0.01350712776184082, "ViewRequirementAgentConnector_ms": 0.5880439281463623}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10490.235499999895, "episode_return_mean": -4065.081135000006, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.6187223285168, "num_env_steps_trained_throughput_per_sec": 32.6187223285168, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 131024.079, "restore_workers_time_ms": 0.1, "training_step_time_ms": 131023.978, "sample_time_ms": 56851.359, "learn_time_ms": 74169.809, "learn_throughput": 53.93, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 38, "trial_id": "05971_00000", "date": "2026-02-19_15-40-07", "timestamp": 1771512007, "time_this_iter_s": 122.63901352882385, "time_total_s": 5073.031555175781, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE65E10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5073.031555175781, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 20.001315789473683, "ram_util_percent": 41.00394736842106, "gpu_util_percent0": 0.2638815789473684, "vram_util_percent0": 0.17322766950350962}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0200846195220947, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.970899595880205, "policy_loss": -0.0349379830302635, "vf_loss": 9.99994764915191, "vf_explained_var": 0.07196235979438588, "kl": 0.0174516420236901, "entropy": 0.5121912439917303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 181335.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10809.260000000104, "episode_reward_mean": -4205.636860000007, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2168.000999999997}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -841.1273719999997}, "custom_metrics": {"delivered_mean_agents_mean": 148.58, "delivered_mean_agents_min": 44.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 16.55, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.04, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.044000000000000004, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.004, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00010137562878554563, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005235602094240838}, "hist_stats": {"episode_reward": [-2894.6505000000334, -4891.335500000038, -4035.0580000000186, -2283.9064999999296, -3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-570.0604999999978, -575.8409999999975, -589.2599999999978, -579.4519999999976, -580.0369999999975, -973.0664999999998, -976.0129999999991, -985.0399999999996, -972.9935000000002, -984.2224999999996, -805.1079999999997, -801.1149999999994, -815.78, -798.1299999999997, -814.925, -450.0505000000007, -451.8580000000006, -472.0900000000006, -451.61800000000113, -458.29000000000065, -640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.015170033152674, "mean_inference_ms": 4.931936900537136, "mean_action_processing_ms": 0.5731901052770577, "mean_env_wait_ms": 3.8574181404898127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021968603134155273, "StateBufferConnector_ms": 0.01350712776184082, "ViewRequirementAgentConnector_ms": 0.5852112770080566}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10809.260000000104, "episode_return_mean": -4205.636860000007, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.95184917889456, "num_env_steps_trained_throughput_per_sec": 32.95184917889456, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 130220.845, "restore_workers_time_ms": 0.1, "training_step_time_ms": 130220.745, "sample_time_ms": 56960.081, "learn_time_ms": 73258.054, "learn_throughput": 54.602, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "training_iteration": 39, "trial_id": "05971_00000", "date": "2026-02-19_15-42-09", "timestamp": 1771512129, "time_this_iter_s": 121.39624214172363, "time_total_s": 5194.427797317505, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADDAC20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5194.427797317505, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 20.012582781456956, "ram_util_percent": 41.02384105960265, "gpu_util_percent0": 0.25655629139072855, "vram_util_percent0": 0.1693206339757422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9682169556617737, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.971458720350974, "policy_loss": -0.03445749668258138, "vf_loss": 10.0, "vf_explained_var": 0.07036602461667071, "kl": 0.017529539865075106, "entropy": 0.4470120124756151, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 186045.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10809.260000000104, "episode_reward_mean": -4334.554195000007, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2168.000999999997}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -866.9108389999997}, "custom_metrics": {"delivered_mean_agents_mean": 148.37, "delivered_mean_agents_min": 44.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 17.08, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.036000000000000004, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.04200000000000001, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-3227.038500000045, -5002.258499999949, -1738.5874999999971, -9493.638500000101, -4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-640.1444999999978, -638.6494999999979, -658.3489999999973, -637.8919999999976, -652.0034999999976, -999.5595000000034, -1000.4270000000034, -1004.0080000000029, -989.8250000000032, -1008.4390000000031, -345.66999999999996, -340.51700000000017, -359.80900000000025, -339.11700000000013, -353.47450000000003, -1896.8165000000008, -1903.946500000001, -1894.1465000000005, -1894.0495000000005, -1904.6795000000009, -836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0115210012006415, "mean_inference_ms": 4.924486710225099, "mean_action_processing_ms": 0.5727510079335637, "mean_env_wait_ms": 3.8533901669838873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0239713191986084, "StateBufferConnector_ms": 0.01350712776184082, "ViewRequirementAgentConnector_ms": 0.5874958038330078}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10809.260000000104, "episode_return_mean": -4334.554195000007, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.12703991679318, "num_env_steps_trained_throughput_per_sec": 33.12703991679318, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 129383.994, "restore_workers_time_ms": 0.1, "training_step_time_ms": 129383.894, "sample_time_ms": 57056.752, "learn_time_ms": 72324.532, "learn_throughput": 55.306, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 40, "trial_id": "05971_00000", "date": "2026-02-19_15-44-09", "timestamp": 1771512249, "time_this_iter_s": 120.75327944755554, "time_total_s": 5315.18107676506, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE67EB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5315.18107676506, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 19.578523489932884, "ram_util_percent": 41.04563758389261, "gpu_util_percent0": 0.2571812080536912, "vram_util_percent0": 0.16920899138696993}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9974621534347534, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.972364889335227, "policy_loss": -0.033652276676860014, "vf_loss": 10.0, "vf_explained_var": 0.06856720042583037, "kl": 0.017828636416542757, "entropy": 0.5178755280445083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 190755.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10840.274499999918, "episode_reward_mean": -4481.820405000007, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2174.078000000002}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -896.3640809999996}, "custom_metrics": {"delivered_mean_agents_mean": 149.21, "delivered_mean_agents_min": 44.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 17.69, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.036000000000000004, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.04600000000000001, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-4186.451499999999, -2926.4860000000317, -2159.4195000000354, -1294.334999999987, -521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972, -7641.672000000002, -7787.576500000082, -10840.274499999918, -7918.621000000018], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-836.0844999999999, -831.185, -850.1999999999995, -825.1784999999999, -843.8034999999995, -583.4159999999994, -579.2994999999991, -602.5799999999991, -572.261499999999, -588.9289999999992, -431.46049999999855, -426.7069999999985, -439.0589999999984, -423.05599999999856, -439.1369999999986, -254.7600000000004, -253.9385000000004, -269.11000000000035, -251.42700000000045, -265.09950000000043, -104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023, -1524.3104999999982, -1527.950499999997, -1529.1639999999968, -1523.1579999999983, -1537.0889999999972, -1556.071999999997, -1562.1059999999964, -1559.0399999999954, -1550.7754999999959, -1559.5829999999967, -2162.838500000001, -2168.200500000002, -2164.782000000001, -2170.3755000000037, -2174.078000000002, -1586.0809999999994, -1584.6354999999999, -1581.0045000000005, -1584.5639999999996, -1582.336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.008592904689201, "mean_inference_ms": 4.917912794756742, "mean_action_processing_ms": 0.5723976710947366, "mean_env_wait_ms": 3.850057733593638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0239870548248291, "StateBufferConnector_ms": 0.01350712776184082, "ViewRequirementAgentConnector_ms": 0.5874419212341309}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10840.274499999918, "episode_return_mean": -4481.820405000007, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.066223625049645, "num_env_steps_trained_throughput_per_sec": 33.066223625049645, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 820000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 820000, "timers": {"training_iteration_time_ms": 128277.886, "restore_workers_time_ms": 0.1, "training_step_time_ms": 128277.785, "sample_time_ms": 57046.578, "learn_time_ms": 71228.598, "learn_throughput": 56.157, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000}, "done": false, "training_iteration": 41, "trial_id": "05971_00000", "date": "2026-02-19_15-46-10", "timestamp": 1771512370, "time_this_iter_s": 120.97687578201294, "time_total_s": 5436.157952547073, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE67D00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5436.157952547073, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 19.63933333333333, "ram_util_percent": 41.05066666666667, "gpu_util_percent0": 0.258, "vram_util_percent0": 0.16933479889268843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9630556702613831, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.969434564230042, "policy_loss": -0.03659340637378126, "vf_loss": 10.0, "vf_explained_var": 0.08096178301833491, "kl": 0.017860700990341028, "entropy": 0.4197520403472228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 195465.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": -45.98649999999997, "episode_reward_min": -10840.274499999918, "episode_reward_mean": -4652.506020000006, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2174.078000000002}, "policy_reward_max": {"shared_policy": -0.6470000000000209}, "policy_reward_mean": {"shared_policy": -930.5012039999997}, "custom_metrics": {"delivered_mean_agents_mean": 149.66, "delivered_mean_agents_min": 44.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 18.5, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.036000000000000004, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.046000000000000006, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014000000000000002, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-521.6905000000095, -741.4344999999925, -1007.2340000000069, -97.41649999999743, -3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972, -7641.672000000002, -7787.576500000082, -10840.274499999918, -7918.621000000018, -7023.054500000019, -9046.999500000027, -8901.586500000012, -2663.6129999999953], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-104.99949999999919, -95.2734999999992, -124.02999999999916, -85.1579999999992, -112.2294999999992, -148.9870000000003, -141.29400000000024, -165.28000000000026, -133.04350000000014, -152.83000000000027, -198.85399999999998, -194.22049999999967, -216.62999999999977, -196.31949999999983, -201.20999999999975, -17.53700000000013, -13.870000000000072, -24.300000000000136, -19.05950000000012, -22.650000000000134, -788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023, -1524.3104999999982, -1527.950499999997, -1529.1639999999968, -1523.1579999999983, -1537.0889999999972, -1556.071999999997, -1562.1059999999964, -1559.0399999999954, -1550.7754999999959, -1559.5829999999967, -2162.838500000001, -2168.200500000002, -2164.782000000001, -2170.3755000000037, -2174.078000000002, -1586.0809999999994, -1584.6354999999999, -1581.0045000000005, -1584.5639999999996, -1582.336, -1401.2139999999993, -1401.6554999999992, -1411.2669999999994, -1398.8884999999993, -1410.0294999999992, -1806.7030000000038, -1808.3940000000018, -1807.8935000000033, -1805.9720000000038, -1818.0370000000037, -1783.1424999999983, -1775.4134999999987, -1783.2214999999987, -1774.0444999999975, -1785.7644999999975, -532.9285000000008, -525.8900000000006, -538.796500000001, -527.8535000000008, -538.1445000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.006087699728532, "mean_inference_ms": 4.911835460063544, "mean_action_processing_ms": 0.5720947225557906, "mean_env_wait_ms": 3.8469783319777218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023975133895874023, "StateBufferConnector_ms": 0.014507055282592773, "ViewRequirementAgentConnector_ms": 0.5874247550964355}, "num_episodes": 4, "episode_return_max": -45.98649999999997, "episode_return_min": -10840.274499999918, "episode_return_mean": -4652.506020000006, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.204825091082434, "num_env_steps_trained_throughput_per_sec": 30.204825091082434, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 127749.86, "restore_workers_time_ms": 0.0, "training_step_time_ms": 127749.86, "sample_time_ms": 56797.237, "learn_time_ms": 70950.118, "learn_throughput": 56.378, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 42, "trial_id": "05971_00000", "date": "2026-02-19_15-48-23", "timestamp": 1771512503, "time_this_iter_s": 132.43818306922913, "time_total_s": 5568.5961356163025, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE670A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5568.5961356163025, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 22.39939393939394, "ram_util_percent": 41.328484848484855, "gpu_util_percent0": 0.27236363636363636, "vram_util_percent0": 0.18228375597696556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2790559530258179, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.976149709462613, "policy_loss": -0.0285560082975427, "vf_loss": 9.999530195531825, "vf_explained_var": 0.04312604022886596, "kl": 0.015334839472173475, "entropy": 0.3573382504142014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 200175.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000}, "env_runners": {"episode_reward_max": 9.800000000000002, "episode_reward_min": -10840.274499999918, "episode_reward_mean": -4858.815240000005, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2174.078000000002}, "policy_reward_max": {"shared_policy": 4.749999999999999}, "policy_reward_mean": {"shared_policy": -971.7630479999997}, "custom_metrics": {"delivered_mean_agents_mean": 150.63, "delivered_mean_agents_min": 8.0, "delivered_mean_agents_max": 243.0, "backlog_mean_agents_mean": 19.14, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 39.0, "manual_delivery_mean_agents_mean": 0.038000000000000006, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.046, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014000000000000002, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-3974.501499999989, -9741.976499999972, -3233.508500000015, -787.5930000000114, -7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972, -7641.672000000002, -7787.576500000082, -10840.274499999918, -7918.621000000018, -7023.054500000019, -9046.999500000027, -8901.586500000012, -2663.6129999999953, -6372.980000000008, -6871.078500000001, -9764.438999999938, 9.800000000000002], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-788.0730000000005, -797.1080000000009, -799.858000000001, -787.2420000000001, -802.2205000000002, -1948.3625000000034, -1955.404000000003, -1941.846000000002, -1939.8400000000042, -1956.5240000000047, -641.4840000000002, -649.8805000000001, -652.4024999999995, -639.1015000000001, -650.6399999999998, -151.64400000000023, -148.0855000000002, -173.88999999999956, -147.2335000000002, -166.73999999999958, -1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023, -1524.3104999999982, -1527.950499999997, -1529.1639999999968, -1523.1579999999983, -1537.0889999999972, -1556.071999999997, -1562.1059999999964, -1559.0399999999954, -1550.7754999999959, -1559.5829999999967, -2162.838500000001, -2168.200500000002, -2164.782000000001, -2170.3755000000037, -2174.078000000002, -1586.0809999999994, -1584.6354999999999, -1581.0045000000005, -1584.5639999999996, -1582.336, -1401.2139999999993, -1401.6554999999992, -1411.2669999999994, -1398.8884999999993, -1410.0294999999992, -1806.7030000000038, -1808.3940000000018, -1807.8935000000033, -1805.9720000000038, -1818.0370000000037, -1783.1424999999983, -1775.4134999999987, -1783.2214999999987, -1774.0444999999975, -1785.7644999999975, -532.9285000000008, -525.8900000000006, -538.796500000001, -527.8535000000008, -538.1445000000009, -1274.7959999999985, -1269.7129999999986, -1272.6804999999993, -1269.7849999999976, -1286.0054999999988, -1369.4995000000017, -1378.2995000000008, -1372.2995000000008, -1365.4605000000004, -1385.5195000000012, -1948.034500000001, -1952.3005000000019, -1950.078000000002, -1951.7980000000018, -1962.2280000000019, 1.2999999999999998, 4.749999999999999, 1.15, 2.4499999999999997, 0.14999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.002893472311609, "mean_inference_ms": 4.904617065017568, "mean_action_processing_ms": 0.5717314662042167, "mean_env_wait_ms": 3.8435151385704796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02298116683959961, "StateBufferConnector_ms": 0.015502691268920898, "ViewRequirementAgentConnector_ms": 0.5815777778625488}, "num_episodes": 4, "episode_return_max": 9.800000000000002, "episode_return_min": -10840.274499999918, "episode_return_mean": -4858.815240000005, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.60959341390034, "num_env_steps_trained_throughput_per_sec": 31.60959341390034, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 860000, "timers": {"training_iteration_time_ms": 127439.399, "restore_workers_time_ms": 0.0, "training_step_time_ms": 127439.399, "sample_time_ms": 56409.847, "learn_time_ms": 71027.147, "learn_throughput": 56.316, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000}, "done": false, "training_iteration": 43, "trial_id": "05971_00000", "date": "2026-02-19_15-50-29", "timestamp": 1771512629, "time_this_iter_s": 126.54990434646606, "time_total_s": 5695.146039962769, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADDB490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5695.146039962769, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 19.39108280254777, "ram_util_percent": 41.40382165605095, "gpu_util_percent0": 0.26222929936305733, "vram_util_percent0": 0.18660989050311316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0294537544250488, "cur_kl_coeff": 0.3375, "cur_lr": 0.0003, "total_loss": 9.971845651938404, "policy_loss": -0.034909377315510734, "vf_loss": 9.99998514373844, "vf_explained_var": 0.0652671115413593, "kl": 0.020058962320614524, "entropy": 0.46207947219759543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 204885.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 9.800000000000002, "episode_reward_min": -10840.274499999918, "episode_reward_mean": -4976.108125000006, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2174.078000000002}, "policy_reward_max": {"shared_policy": 4.749999999999999}, "policy_reward_mean": {"shared_policy": -995.2216249999996}, "custom_metrics": {"delivered_mean_agents_mean": 151.14, "delivered_mean_agents_min": 8.0, "delivered_mean_agents_max": 227.0, "backlog_mean_agents_mean": 19.21, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.034, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.048, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.014000000000000002, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-7451.068999999958, -2392.753000000002, -6642.701000000079, -6045.220499999992, -424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972, -7641.672000000002, -7787.576500000082, -10840.274499999918, -7918.621000000018, -7023.054500000019, -9046.999500000027, -8901.586500000012, -2663.6129999999953, -6372.980000000008, -6871.078500000001, -9764.438999999938, 9.800000000000002, -7216.066500000021, -6848.32449999997, -7915.5109999999995, -7486.966000000048], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1493.304500000001, -1491.6280000000013, -1493.4085000000007, -1483.8220000000006, -1488.9060000000015, -472.63700000000097, -472.48000000000053, -493.99, -470.63900000000046, -483.0070000000007, -1327.8189999999975, -1329.8364999999974, -1326.9169999999974, -1323.4349999999977, -1334.6934999999976, -1204.6820000000005, -1210.1595, -1211.8545000000001, -1203.048, -1215.4765, -88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023, -1524.3104999999982, -1527.950499999997, -1529.1639999999968, -1523.1579999999983, -1537.0889999999972, -1556.071999999997, -1562.1059999999964, -1559.0399999999954, -1550.7754999999959, -1559.5829999999967, -2162.838500000001, -2168.200500000002, -2164.782000000001, -2170.3755000000037, -2174.078000000002, -1586.0809999999994, -1584.6354999999999, -1581.0045000000005, -1584.5639999999996, -1582.336, -1401.2139999999993, -1401.6554999999992, -1411.2669999999994, -1398.8884999999993, -1410.0294999999992, -1806.7030000000038, -1808.3940000000018, -1807.8935000000033, -1805.9720000000038, -1818.0370000000037, -1783.1424999999983, -1775.4134999999987, -1783.2214999999987, -1774.0444999999975, -1785.7644999999975, -532.9285000000008, -525.8900000000006, -538.796500000001, -527.8535000000008, -538.1445000000009, -1274.7959999999985, -1269.7129999999986, -1272.6804999999993, -1269.7849999999976, -1286.0054999999988, -1369.4995000000017, -1378.2995000000008, -1372.2995000000008, -1365.4605000000004, -1385.5195000000012, -1948.034500000001, -1952.3005000000019, -1950.078000000002, -1951.7980000000018, -1962.2280000000019, 1.2999999999999998, 4.749999999999999, 1.15, 2.4499999999999997, 0.14999999999999997, -1438.9909999999975, -1444.231999999997, -1443.5909999999967, -1437.9594999999974, -1451.292999999997, -1366.203500000002, -1367.7285000000022, -1369.7165000000025, -1362.8020000000026, -1381.8740000000016, -1577.8615000000013, -1587.4115000000004, -1584.945, -1578.7925000000005, -1586.500500000001, -1499.7485000000008, -1495.071499999999, -1495.0520000000004, -1492.0544999999993, -1505.0394999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.999677219301024, "mean_inference_ms": 4.898238495703367, "mean_action_processing_ms": 0.5713685061277524, "mean_env_wait_ms": 3.839983598873536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02298116683959961, "StateBufferConnector_ms": 0.01450204849243164, "ViewRequirementAgentConnector_ms": 0.574723482131958}, "num_episodes": 4, "episode_return_max": 9.800000000000002, "episode_return_min": -10840.274499999918, "episode_return_mean": -4976.108125000006, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.404025700924404, "num_env_steps_trained_throughput_per_sec": 31.404025700924404, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 126028.553, "restore_workers_time_ms": 0.0, "training_step_time_ms": 126028.553, "sample_time_ms": 55492.747, "learn_time_ms": 70533.302, "learn_throughput": 56.711, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 44, "trial_id": "05971_00000", "date": "2026-02-19_15-52-37", "timestamp": 1771512757, "time_this_iter_s": 127.37920427322388, "time_total_s": 5822.525244235992, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE65B40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5822.525244235992, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 19.735220125786164, "ram_util_percent": 41.42327044025158, "gpu_util_percent0": 0.2577987421383648, "vram_util_percent0": 0.1864993409591579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.607865571975708, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 0.0003, "total_loss": 9.971072704776837, "policy_loss": -0.034457822733968024, "vf_loss": 9.997451088332319, "vf_explained_var": 0.020605352717093853, "kl": 0.015959385900702273, "entropy": 0.3137232568423459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 209595.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "env_runners": {"episode_reward_max": 9.800000000000002, "episode_reward_min": -10840.274499999918, "episode_reward_mean": -4935.884870000006, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2174.078000000002}, "policy_reward_max": {"shared_policy": 4.749999999999999}, "policy_reward_mean": {"shared_policy": -987.1769739999996}, "custom_metrics": {"delivered_mean_agents_mean": 150.35, "delivered_mean_agents_min": 8.0, "delivered_mean_agents_max": 227.0, "backlog_mean_agents_mean": 19.07, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.032, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.046, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.012000000000000002, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-424.2569999999982, -1332.5315000000123, -1295.8980000000158, -1272.912499999953, -765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972, -7641.672000000002, -7787.576500000082, -10840.274499999918, -7918.621000000018, -7023.054500000019, -9046.999500000027, -8901.586500000012, -2663.6129999999953, -6372.980000000008, -6871.078500000001, -9764.438999999938, 9.800000000000002, -7216.066500000021, -6848.32449999997, -7915.5109999999995, -7486.966000000048, -2399.6924999999887, -9901.076500000045, -4725.421499999987, -1483.2275000000175], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-88.43000000000016, -80.81700000000039, -99.51000000000012, -68.39000000000027, -87.11000000000014, -260.45949999999914, -262.6329999999992, -278.2999999999988, -258.4489999999992, -272.68999999999886, -260.5179999999988, -252.57199999999847, -274.9199999999991, -247.22799999999867, -260.6599999999989, -247.35250000000093, -246.66000000000096, -265.8200000000035, -251.9800000000012, -261.1000000000033, -154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023, -1524.3104999999982, -1527.950499999997, -1529.1639999999968, -1523.1579999999983, -1537.0889999999972, -1556.071999999997, -1562.1059999999964, -1559.0399999999954, -1550.7754999999959, -1559.5829999999967, -2162.838500000001, -2168.200500000002, -2164.782000000001, -2170.3755000000037, -2174.078000000002, -1586.0809999999994, -1584.6354999999999, -1581.0045000000005, -1584.5639999999996, -1582.336, -1401.2139999999993, -1401.6554999999992, -1411.2669999999994, -1398.8884999999993, -1410.0294999999992, -1806.7030000000038, -1808.3940000000018, -1807.8935000000033, -1805.9720000000038, -1818.0370000000037, -1783.1424999999983, -1775.4134999999987, -1783.2214999999987, -1774.0444999999975, -1785.7644999999975, -532.9285000000008, -525.8900000000006, -538.796500000001, -527.8535000000008, -538.1445000000009, -1274.7959999999985, -1269.7129999999986, -1272.6804999999993, -1269.7849999999976, -1286.0054999999988, -1369.4995000000017, -1378.2995000000008, -1372.2995000000008, -1365.4605000000004, -1385.5195000000012, -1948.034500000001, -1952.3005000000019, -1950.078000000002, -1951.7980000000018, -1962.2280000000019, 1.2999999999999998, 4.749999999999999, 1.15, 2.4499999999999997, 0.14999999999999997, -1438.9909999999975, -1444.231999999997, -1443.5909999999967, -1437.9594999999974, -1451.292999999997, -1366.203500000002, -1367.7285000000022, -1369.7165000000025, -1362.8020000000026, -1381.8740000000016, -1577.8615000000013, -1587.4115000000004, -1584.945, -1578.7925000000005, -1586.500500000001, -1499.7485000000008, -1495.071499999999, -1495.0520000000004, -1492.0544999999993, -1505.0394999999999, -472.5665000000007, -463.74000000000063, -489.9990000000007, -482.4870000000006, -490.90000000000066, -1971.8699999999965, -1982.1964999999984, -1978.3064999999979, -1982.1924999999987, -1986.5109999999977, -942.1385000000008, -942.1505000000005, -950.444500000001, -939.529500000001, -951.1585000000009, -288.58499999999964, -287.0134999999994, -308.66999999999916, -296.38899999999956, -302.5699999999993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.996706179055238, "mean_inference_ms": 4.892608867277678, "mean_action_processing_ms": 0.5710090134346715, "mean_env_wait_ms": 3.836595785631139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023981332778930664, "StateBufferConnector_ms": 0.01450204849243164, "ViewRequirementAgentConnector_ms": 0.5782301425933838}, "num_episodes": 4, "episode_return_max": 9.800000000000002, "episode_return_min": -10840.274499999918, "episode_return_mean": -4935.884870000006, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.407919607993325, "num_env_steps_trained_throughput_per_sec": 31.407919607993325, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 125476.576, "restore_workers_time_ms": 0.0, "training_step_time_ms": 125476.576, "sample_time_ms": 55333.372, "learn_time_ms": 70140.8, "learn_throughput": 57.028, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "training_iteration": 45, "trial_id": "05971_00000", "date": "2026-02-19_15-54-44", "timestamp": 1771512884, "time_this_iter_s": 127.36392951011658, "time_total_s": 5949.889173746109, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE67D00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5949.889173746109, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 19.497468354430378, "ram_util_percent": 41.31202531645569, "gpu_util_percent0": 0.26208860759493674, "vram_util_percent0": 0.18479497628514713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8634987473487854, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 0.0003, "total_loss": 9.975931005417161, "policy_loss": -0.030282429497957924, "vf_loss": 9.999920810610373, "vf_explained_var": 0.042337219591100254, "kl": 0.01242986446486755, "entropy": 0.2585275537648778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 214305.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 9.800000000000002, "episode_reward_min": -10840.274499999918, "episode_reward_mean": -5023.222265000007, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2174.078000000002}, "policy_reward_max": {"shared_policy": 4.749999999999999}, "policy_reward_mean": {"shared_policy": -1004.6444529999998}, "custom_metrics": {"delivered_mean_agents_mean": 149.98, "delivered_mean_agents_min": 8.0, "delivered_mean_agents_max": 227.0, "backlog_mean_agents_mean": 19.71, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.032, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.044000000000000004, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.012000000000000002, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-765.2619999999989, -5421.146999999986, -10490.235499999895, -778.6270000000261, -546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972, -7641.672000000002, -7787.576500000082, -10840.274499999918, -7918.621000000018, -7023.054500000019, -9046.999500000027, -8901.586500000012, -2663.6129999999953, -6372.980000000008, -6871.078500000001, -9764.438999999938, 9.800000000000002, -7216.066500000021, -6848.32449999997, -7915.5109999999995, -7486.966000000048, -2399.6924999999887, -9901.076500000045, -4725.421499999987, -1483.2275000000175, -71.0794999999999, -2641.138499999987, -3794.2660000000114, -6552.854499999996], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-154.84700000000055, -144.7395000000006, -168.65000000000052, -141.0855000000007, -155.94000000000054, -1082.2900000000013, -1081.0325000000012, -1087.5280000000018, -1080.1915000000015, -1090.105000000001, -2091.1494999999973, -2099.3499999999963, -2098.1014999999957, -2094.194999999996, -2107.4394999999977, -154.50649999999857, -152.9669999999986, -168.6099999999987, -141.26349999999863, -161.2799999999987, -108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023, -1524.3104999999982, -1527.950499999997, -1529.1639999999968, -1523.1579999999983, -1537.0889999999972, -1556.071999999997, -1562.1059999999964, -1559.0399999999954, -1550.7754999999959, -1559.5829999999967, -2162.838500000001, -2168.200500000002, -2164.782000000001, -2170.3755000000037, -2174.078000000002, -1586.0809999999994, -1584.6354999999999, -1581.0045000000005, -1584.5639999999996, -1582.336, -1401.2139999999993, -1401.6554999999992, -1411.2669999999994, -1398.8884999999993, -1410.0294999999992, -1806.7030000000038, -1808.3940000000018, -1807.8935000000033, -1805.9720000000038, -1818.0370000000037, -1783.1424999999983, -1775.4134999999987, -1783.2214999999987, -1774.0444999999975, -1785.7644999999975, -532.9285000000008, -525.8900000000006, -538.796500000001, -527.8535000000008, -538.1445000000009, -1274.7959999999985, -1269.7129999999986, -1272.6804999999993, -1269.7849999999976, -1286.0054999999988, -1369.4995000000017, -1378.2995000000008, -1372.2995000000008, -1365.4605000000004, -1385.5195000000012, -1948.034500000001, -1952.3005000000019, -1950.078000000002, -1951.7980000000018, -1962.2280000000019, 1.2999999999999998, 4.749999999999999, 1.15, 2.4499999999999997, 0.14999999999999997, -1438.9909999999975, -1444.231999999997, -1443.5909999999967, -1437.9594999999974, -1451.292999999997, -1366.203500000002, -1367.7285000000022, -1369.7165000000025, -1362.8020000000026, -1381.8740000000016, -1577.8615000000013, -1587.4115000000004, -1584.945, -1578.7925000000005, -1586.500500000001, -1499.7485000000008, -1495.071499999999, -1495.0520000000004, -1492.0544999999993, -1505.0394999999999, -472.5665000000007, -463.74000000000063, -489.9990000000007, -482.4870000000006, -490.90000000000066, -1971.8699999999965, -1982.1964999999984, -1978.3064999999979, -1982.1924999999987, -1986.5109999999977, -942.1385000000008, -942.1505000000005, -950.444500000001, -939.529500000001, -951.1585000000009, -288.58499999999964, -287.0134999999994, -308.66999999999916, -296.38899999999956, -302.5699999999993, -12.7295, -7.549999999999996, -17.200000000000006, -16.85, -16.75000000000001, -525.6690000000007, -517.1160000000003, -538.6165000000009, -526.3185000000007, -533.4185000000008, -757.5595000000001, -745.5800000000005, -762.5085000000005, -760.8290000000004, -767.7890000000004, -1311.7765000000006, -1310.5729999999994, -1311.667000000001, -1302.9555000000007, -1315.8825000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.99466007011737, "mean_inference_ms": 4.887635194566035, "mean_action_processing_ms": 0.5707584036620085, "mean_env_wait_ms": 3.834020956241871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021978139877319336, "StateBufferConnector_ms": 0.015501260757446289, "ViewRequirementAgentConnector_ms": 0.5852460861206055}, "num_episodes": 4, "episode_return_max": 9.800000000000002, "episode_return_min": -10840.274499999918, "episode_return_mean": -5023.222265000007, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.679479772123297, "num_env_steps_trained_throughput_per_sec": 31.679479772123297, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 124720.899, "restore_workers_time_ms": 0.0, "training_step_time_ms": 124720.899, "sample_time_ms": 54607.816, "learn_time_ms": 70110.612, "learn_throughput": 57.053, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 46, "trial_id": "05971_00000", "date": "2026-02-19_15-56-51", "timestamp": 1771513011, "time_this_iter_s": 126.2747232913971, "time_total_s": 6076.163897037506, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE67370>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6076.163897037506, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 19.540764331210195, "ram_util_percent": 41.08853503184714, "gpu_util_percent0": 0.2563057324840764, "vram_util_percent0": 0.18427464146692843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9049550890922546, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 0.0003, "total_loss": 9.972535855198108, "policy_loss": -0.035862997602552744, "vf_loss": 9.999991637025415, "vf_explained_var": 0.11191585700476499, "kl": 0.016606868972223094, "entropy": 0.44147758441492757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 219015.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000}, "env_runners": {"episode_reward_max": 9.800000000000002, "episode_reward_min": -12951.865499999962, "episode_reward_mean": -5176.278670000006, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2599.653000000001}, "policy_reward_max": {"shared_policy": 4.749999999999999}, "policy_reward_mean": {"shared_policy": -1035.2557339999996}, "custom_metrics": {"delivered_mean_agents_mean": 150.98, "delivered_mean_agents_min": 8.0, "delivered_mean_agents_max": 227.0, "backlog_mean_agents_mean": 20.28, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.034, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.04200000000000001, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.012000000000000002, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-546.5735000000101, -3860.2519999999904, -8172.157000000033, -904.142500000059, -10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972, -7641.672000000002, -7787.576500000082, -10840.274499999918, -7918.621000000018, -7023.054500000019, -9046.999500000027, -8901.586500000012, -2663.6129999999953, -6372.980000000008, -6871.078500000001, -9764.438999999938, 9.800000000000002, -7216.066500000021, -6848.32449999997, -7915.5109999999995, -7486.966000000048, -2399.6924999999887, -9901.076500000045, -4725.421499999987, -1483.2275000000175, -71.0794999999999, -2641.138499999987, -3794.2660000000114, -6552.854499999996, -8037.57, -2877.3384999999817, -12951.865499999962, -8894.137999999994], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-108.13299999999941, -97.81699999999947, -122.10999999999937, -99.10349999999941, -119.40999999999937, -762.9390000000003, -772.8240000000003, -777.4500000000005, -775.9890000000006, -771.0500000000003, -1621.0329999999965, -1645.3739999999964, -1640.7604999999974, -1624.088999999997, -1640.9004999999966, -180.95699999999795, -169.46299999999778, -196.96999999999778, -172.72249999999792, -184.02999999999778, -2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023, -1524.3104999999982, -1527.950499999997, -1529.1639999999968, -1523.1579999999983, -1537.0889999999972, -1556.071999999997, -1562.1059999999964, -1559.0399999999954, -1550.7754999999959, -1559.5829999999967, -2162.838500000001, -2168.200500000002, -2164.782000000001, -2170.3755000000037, -2174.078000000002, -1586.0809999999994, -1584.6354999999999, -1581.0045000000005, -1584.5639999999996, -1582.336, -1401.2139999999993, -1401.6554999999992, -1411.2669999999994, -1398.8884999999993, -1410.0294999999992, -1806.7030000000038, -1808.3940000000018, -1807.8935000000033, -1805.9720000000038, -1818.0370000000037, -1783.1424999999983, -1775.4134999999987, -1783.2214999999987, -1774.0444999999975, -1785.7644999999975, -532.9285000000008, -525.8900000000006, -538.796500000001, -527.8535000000008, -538.1445000000009, -1274.7959999999985, -1269.7129999999986, -1272.6804999999993, -1269.7849999999976, -1286.0054999999988, -1369.4995000000017, -1378.2995000000008, -1372.2995000000008, -1365.4605000000004, -1385.5195000000012, -1948.034500000001, -1952.3005000000019, -1950.078000000002, -1951.7980000000018, -1962.2280000000019, 1.2999999999999998, 4.749999999999999, 1.15, 2.4499999999999997, 0.14999999999999997, -1438.9909999999975, -1444.231999999997, -1443.5909999999967, -1437.9594999999974, -1451.292999999997, -1366.203500000002, -1367.7285000000022, -1369.7165000000025, -1362.8020000000026, -1381.8740000000016, -1577.8615000000013, -1587.4115000000004, -1584.945, -1578.7925000000005, -1586.500500000001, -1499.7485000000008, -1495.071499999999, -1495.0520000000004, -1492.0544999999993, -1505.0394999999999, -472.5665000000007, -463.74000000000063, -489.9990000000007, -482.4870000000006, -490.90000000000066, -1971.8699999999965, -1982.1964999999984, -1978.3064999999979, -1982.1924999999987, -1986.5109999999977, -942.1385000000008, -942.1505000000005, -950.444500000001, -939.529500000001, -951.1585000000009, -288.58499999999964, -287.0134999999994, -308.66999999999916, -296.38899999999956, -302.5699999999993, -12.7295, -7.549999999999996, -17.200000000000006, -16.85, -16.75000000000001, -525.6690000000007, -517.1160000000003, -538.6165000000009, -526.3185000000007, -533.4185000000008, -757.5595000000001, -745.5800000000005, -762.5085000000005, -760.8290000000004, -767.7890000000004, -1311.7765000000006, -1310.5729999999994, -1311.667000000001, -1302.9555000000007, -1315.8825000000008, -1608.010500000003, -1606.4705000000024, -1601.2895000000033, -1604.8435000000025, -1616.9560000000026, -572.0755000000008, -567.461500000001, -581.031500000001, -574.1600000000005, -582.6100000000006, -2584.365, -2584.795500000001, -2584.727, -2599.653000000001, -2598.325000000001, -1772.4894999999988, -1777.9544999999978, -1775.0579999999993, -1786.6389999999988, -1781.9969999999992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.993631106676447, "mean_inference_ms": 4.883414959741016, "mean_action_processing_ms": 0.5706207125672276, "mean_env_wait_ms": 3.83220092795673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022022724151611328, "StateBufferConnector_ms": 0.015501260757446289, "ViewRequirementAgentConnector_ms": 0.5878973007202148}, "num_episodes": 4, "episode_return_max": 9.800000000000002, "episode_return_min": -12951.865499999962, "episode_return_mean": -5176.278670000006, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.450006576635275, "num_env_steps_trained_throughput_per_sec": 31.450006576635275, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 940000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 940000, "timers": {"training_iteration_time_ms": 125288.718, "restore_workers_time_ms": 0.0, "training_step_time_ms": 125288.718, "sample_time_ms": 54723.575, "learn_time_ms": 70562.51, "learn_throughput": 56.687, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000}, "done": false, "training_iteration": 47, "trial_id": "05971_00000", "date": "2026-02-19_15-58-58", "timestamp": 1771513138, "time_this_iter_s": 127.19198346138, "time_total_s": 6203.355880498886, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE61900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6203.355880498886, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 19.354430379746834, "ram_util_percent": 41.20822784810127, "gpu_util_percent0": 0.25518987341772154, "vram_util_percent0": 0.18359609307847854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9542879462242126, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 0.0003, "total_loss": 9.976770294294742, "policy_loss": -0.03076748329198933, "vf_loss": 9.999984455918558, "vf_explained_var": 0.10722424901721331, "kl": 0.014920133226060481, "entropy": 0.4145226675550396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 223725.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 9.800000000000002, "episode_reward_min": -12951.865499999962, "episode_reward_mean": -5333.419625000005, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2599.653000000001}, "policy_reward_max": {"shared_policy": 4.749999999999999}, "policy_reward_mean": {"shared_policy": -1066.6839249999998}, "custom_metrics": {"delivered_mean_agents_mean": 151.6, "delivered_mean_agents_min": 8.0, "delivered_mean_agents_max": 227.0, "backlog_mean_agents_mean": 20.81, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.032, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.04400000000000001, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.01, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-10046.866499999953, -2320.3619999999887, -1626.7160000000224, -6853.829500000061, -1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972, -7641.672000000002, -7787.576500000082, -10840.274499999918, -7918.621000000018, -7023.054500000019, -9046.999500000027, -8901.586500000012, -2663.6129999999953, -6372.980000000008, -6871.078500000001, -9764.438999999938, 9.800000000000002, -7216.066500000021, -6848.32449999997, -7915.5109999999995, -7486.966000000048, -2399.6924999999887, -9901.076500000045, -4725.421499999987, -1483.2275000000175, -71.0794999999999, -2641.138499999987, -3794.2660000000114, -6552.854499999996, -8037.57, -2877.3384999999817, -12951.865499999962, -8894.137999999994, -5889.666500000052, -5212.05099999998, -9139.015000000003, -8956.487999999868], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-2002.7084999999981, -2008.5904999999984, -2008.4599999999987, -2014.5114999999976, -2012.5959999999982, -462.4895000000005, -455.1950000000002, -474.77000000000055, -456.54800000000046, -471.3595000000006, -324.930000000001, -318.67000000000087, -340.360000000001, -316.49600000000083, -326.2600000000009, -1369.4854999999966, -1370.9324999999976, -1373.3764999999983, -1364.4589999999969, -1375.575999999996, -324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023, -1524.3104999999982, -1527.950499999997, -1529.1639999999968, -1523.1579999999983, -1537.0889999999972, -1556.071999999997, -1562.1059999999964, -1559.0399999999954, -1550.7754999999959, -1559.5829999999967, -2162.838500000001, -2168.200500000002, -2164.782000000001, -2170.3755000000037, -2174.078000000002, -1586.0809999999994, -1584.6354999999999, -1581.0045000000005, -1584.5639999999996, -1582.336, -1401.2139999999993, -1401.6554999999992, -1411.2669999999994, -1398.8884999999993, -1410.0294999999992, -1806.7030000000038, -1808.3940000000018, -1807.8935000000033, -1805.9720000000038, -1818.0370000000037, -1783.1424999999983, -1775.4134999999987, -1783.2214999999987, -1774.0444999999975, -1785.7644999999975, -532.9285000000008, -525.8900000000006, -538.796500000001, -527.8535000000008, -538.1445000000009, -1274.7959999999985, -1269.7129999999986, -1272.6804999999993, -1269.7849999999976, -1286.0054999999988, -1369.4995000000017, -1378.2995000000008, -1372.2995000000008, -1365.4605000000004, -1385.5195000000012, -1948.034500000001, -1952.3005000000019, -1950.078000000002, -1951.7980000000018, -1962.2280000000019, 1.2999999999999998, 4.749999999999999, 1.15, 2.4499999999999997, 0.14999999999999997, -1438.9909999999975, -1444.231999999997, -1443.5909999999967, -1437.9594999999974, -1451.292999999997, -1366.203500000002, -1367.7285000000022, -1369.7165000000025, -1362.8020000000026, -1381.8740000000016, -1577.8615000000013, -1587.4115000000004, -1584.945, -1578.7925000000005, -1586.500500000001, -1499.7485000000008, -1495.071499999999, -1495.0520000000004, -1492.0544999999993, -1505.0394999999999, -472.5665000000007, -463.74000000000063, -489.9990000000007, -482.4870000000006, -490.90000000000066, -1971.8699999999965, -1982.1964999999984, -1978.3064999999979, -1982.1924999999987, -1986.5109999999977, -942.1385000000008, -942.1505000000005, -950.444500000001, -939.529500000001, -951.1585000000009, -288.58499999999964, -287.0134999999994, -308.66999999999916, -296.38899999999956, -302.5699999999993, -12.7295, -7.549999999999996, -17.200000000000006, -16.85, -16.75000000000001, -525.6690000000007, -517.1160000000003, -538.6165000000009, -526.3185000000007, -533.4185000000008, -757.5595000000001, -745.5800000000005, -762.5085000000005, -760.8290000000004, -767.7890000000004, -1311.7765000000006, -1310.5729999999994, -1311.667000000001, -1302.9555000000007, -1315.8825000000008, -1608.010500000003, -1606.4705000000024, -1601.2895000000033, -1604.8435000000025, -1616.9560000000026, -572.0755000000008, -567.461500000001, -581.031500000001, -574.1600000000005, -582.6100000000006, -2584.365, -2584.795500000001, -2584.727, -2599.653000000001, -2598.325000000001, -1772.4894999999988, -1777.9544999999978, -1775.0579999999993, -1786.6389999999988, -1781.9969999999992, -1175.1809999999996, -1181.8190000000002, -1172.5085, -1176.7719999999995, -1183.3859999999995, -1035.3480000000015, -1039.8880000000015, -1040.6470000000015, -1049.400000000002, -1046.7680000000018, -1825.2659999999962, -1827.1859999999954, -1820.6489999999967, -1833.3264999999958, -1832.5874999999971, -1785.2970000000048, -1796.193000000004, -1790.8840000000037, -1794.359500000004, -1789.7545000000048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.992273193779615, "mean_inference_ms": 4.877928166792219, "mean_action_processing_ms": 0.5704035443464106, "mean_env_wait_ms": 3.830000639315398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02002739906311035, "StateBufferConnector_ms": 0.015496969223022461, "ViewRequirementAgentConnector_ms": 0.5825819969177246}, "num_episodes": 4, "episode_return_max": 9.800000000000002, "episode_return_min": -12951.865499999962, "episode_return_mean": -5333.419625000005, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.237322859643662, "num_env_steps_trained_throughput_per_sec": 31.237322859643662, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 125831.017, "restore_workers_time_ms": 0.0, "training_step_time_ms": 125831.017, "sample_time_ms": 54812.31, "learn_time_ms": 71016.123, "learn_throughput": 56.325, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 48, "trial_id": "05971_00000", "date": "2026-02-19_16-01-06", "timestamp": 1771513266, "time_this_iter_s": 128.0599546432495, "time_total_s": 6331.415835142136, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8ADDB910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6331.415835142136, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 19.885624999999997, "ram_util_percent": 41.238749999999996, "gpu_util_percent0": 0.25993750000000004, "vram_util_percent0": 0.18361397777234978}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9364369511604309, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 0.0003, "total_loss": 9.970065969722286, "policy_loss": -0.037735508194375156, "vf_loss": 9.9999857645379, "vf_explained_var": 0.10171363425862258, "kl": 0.015438428115587445, "entropy": 0.41440629007456914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 228435.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "env_runners": {"episode_reward_max": 9.800000000000002, "episode_reward_min": -12951.865499999962, "episode_reward_mean": -5411.568555000005, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2599.653000000001}, "policy_reward_max": {"shared_policy": 4.749999999999999}, "policy_reward_mean": {"shared_policy": -1082.3137109999998}, "custom_metrics": {"delivered_mean_agents_mean": 152.25, "delivered_mean_agents_min": 8.0, "delivered_mean_agents_max": 227.0, "backlog_mean_agents_mean": 21.14, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 41.0, "manual_delivery_mean_agents_mean": 0.030000000000000006, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.048000000000000015, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.01, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-1615.6400000000026, -45.98649999999997, -1356.7874999999826, -807.2395000000371, -541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972, -7641.672000000002, -7787.576500000082, -10840.274499999918, -7918.621000000018, -7023.054500000019, -9046.999500000027, -8901.586500000012, -2663.6129999999953, -6372.980000000008, -6871.078500000001, -9764.438999999938, 9.800000000000002, -7216.066500000021, -6848.32449999997, -7915.5109999999995, -7486.966000000048, -2399.6924999999887, -9901.076500000045, -4725.421499999987, -1483.2275000000175, -71.0794999999999, -2641.138499999987, -3794.2660000000114, -6552.854499999996, -8037.57, -2877.3384999999817, -12951.865499999962, -8894.137999999994, -5889.666500000052, -5212.05099999998, -9139.015000000003, -8956.487999999868, -8385.188000000007, -5290.776500000002, -10201.989000000036, -4784.713500000018], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-324.569500000001, -320.0465000000006, -336.8100000000015, -308.9940000000006, -325.22000000000116, -10.769500000000015, -1.510000000000011, -18.26000000000002, -0.6470000000000209, -14.800000000000008, -275.229500000001, -267.88700000000074, -288.21000000000146, -256.7550000000007, -268.70600000000076, -159.59599999999853, -158.3639999999985, -174.25999999999837, -149.73099999999866, -165.28849999999844, -107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023, -1524.3104999999982, -1527.950499999997, -1529.1639999999968, -1523.1579999999983, -1537.0889999999972, -1556.071999999997, -1562.1059999999964, -1559.0399999999954, -1550.7754999999959, -1559.5829999999967, -2162.838500000001, -2168.200500000002, -2164.782000000001, -2170.3755000000037, -2174.078000000002, -1586.0809999999994, -1584.6354999999999, -1581.0045000000005, -1584.5639999999996, -1582.336, -1401.2139999999993, -1401.6554999999992, -1411.2669999999994, -1398.8884999999993, -1410.0294999999992, -1806.7030000000038, -1808.3940000000018, -1807.8935000000033, -1805.9720000000038, -1818.0370000000037, -1783.1424999999983, -1775.4134999999987, -1783.2214999999987, -1774.0444999999975, -1785.7644999999975, -532.9285000000008, -525.8900000000006, -538.796500000001, -527.8535000000008, -538.1445000000009, -1274.7959999999985, -1269.7129999999986, -1272.6804999999993, -1269.7849999999976, -1286.0054999999988, -1369.4995000000017, -1378.2995000000008, -1372.2995000000008, -1365.4605000000004, -1385.5195000000012, -1948.034500000001, -1952.3005000000019, -1950.078000000002, -1951.7980000000018, -1962.2280000000019, 1.2999999999999998, 4.749999999999999, 1.15, 2.4499999999999997, 0.14999999999999997, -1438.9909999999975, -1444.231999999997, -1443.5909999999967, -1437.9594999999974, -1451.292999999997, -1366.203500000002, -1367.7285000000022, -1369.7165000000025, -1362.8020000000026, -1381.8740000000016, -1577.8615000000013, -1587.4115000000004, -1584.945, -1578.7925000000005, -1586.500500000001, -1499.7485000000008, -1495.071499999999, -1495.0520000000004, -1492.0544999999993, -1505.0394999999999, -472.5665000000007, -463.74000000000063, -489.9990000000007, -482.4870000000006, -490.90000000000066, -1971.8699999999965, -1982.1964999999984, -1978.3064999999979, -1982.1924999999987, -1986.5109999999977, -942.1385000000008, -942.1505000000005, -950.444500000001, -939.529500000001, -951.1585000000009, -288.58499999999964, -287.0134999999994, -308.66999999999916, -296.38899999999956, -302.5699999999993, -12.7295, -7.549999999999996, -17.200000000000006, -16.85, -16.75000000000001, -525.6690000000007, -517.1160000000003, -538.6165000000009, -526.3185000000007, -533.4185000000008, -757.5595000000001, -745.5800000000005, -762.5085000000005, -760.8290000000004, -767.7890000000004, -1311.7765000000006, -1310.5729999999994, -1311.667000000001, -1302.9555000000007, -1315.8825000000008, -1608.010500000003, -1606.4705000000024, -1601.2895000000033, -1604.8435000000025, -1616.9560000000026, -572.0755000000008, -567.461500000001, -581.031500000001, -574.1600000000005, -582.6100000000006, -2584.365, -2584.795500000001, -2584.727, -2599.653000000001, -2598.325000000001, -1772.4894999999988, -1777.9544999999978, -1775.0579999999993, -1786.6389999999988, -1781.9969999999992, -1175.1809999999996, -1181.8190000000002, -1172.5085, -1176.7719999999995, -1183.3859999999995, -1035.3480000000015, -1039.8880000000015, -1040.6470000000015, -1049.400000000002, -1046.7680000000018, -1825.2659999999962, -1827.1859999999954, -1820.6489999999967, -1833.3264999999958, -1832.5874999999971, -1785.2970000000048, -1796.193000000004, -1790.8840000000037, -1794.359500000004, -1789.7545000000048, -1674.8754999999978, -1679.240999999998, -1673.8314999999982, -1678.769999999997, -1678.4699999999987, -1057.1725000000006, -1052.1165000000005, -1057.9475000000002, -1058.6040000000007, -1064.9359999999995, -2034.3719999999967, -2041.003999999996, -2034.7174999999972, -2048.376999999996, -2043.5184999999956, -951.8880000000003, -956.3090000000001, -957.3010000000004, -956.9450000000004, -962.2705000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.990645481183424, "mean_inference_ms": 4.871991319211136, "mean_action_processing_ms": 0.5701606782635231, "mean_env_wait_ms": 3.8279888172749463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019022464752197266, "StateBufferConnector_ms": 0.014499664306640625, "ViewRequirementAgentConnector_ms": 0.5879864692687988}, "num_episodes": 4, "episode_return_max": 9.800000000000002, "episode_return_min": -12951.865499999962, "episode_return_mean": -5411.568555000005, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.38083025668489, "num_env_steps_trained_throughput_per_sec": 31.38083025668489, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 980000, "timers": {"training_iteration_time_ms": 126438.728, "restore_workers_time_ms": 0.0, "training_step_time_ms": 126438.728, "sample_time_ms": 54872.599, "learn_time_ms": 71563.266, "learn_throughput": 55.895, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "done": false, "training_iteration": 49, "trial_id": "05971_00000", "date": "2026-02-19_16-03-14", "timestamp": 1771513394, "time_this_iter_s": 127.47831535339355, "time_total_s": 6458.894150495529, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE64700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6458.894150495529, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 19.677848101265823, "ram_util_percent": 41.16012658227848, "gpu_util_percent0": 0.264493670886076, "vram_util_percent0": 0.1836169633857513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8911421895027161, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 0.0003, "total_loss": 9.973166048045877, "policy_loss": -0.034901750474009514, "vf_loss": 10.0, "vf_explained_var": 0.0694815981539951, "kl": 0.015936371285595673, "entropy": 0.3895272350298624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 233145.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 9.800000000000002, "episode_reward_min": -12951.865499999962, "episode_reward_mean": -5634.664660000005, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2599.653000000001}, "policy_reward_max": {"shared_policy": 4.749999999999999}, "policy_reward_mean": {"shared_policy": -1126.9329319999997}, "custom_metrics": {"delivered_mean_agents_mean": 155.02, "delivered_mean_agents_min": 8.0, "delivered_mean_agents_max": 227.0, "backlog_mean_agents_mean": 22.12, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 41.0, "manual_delivery_mean_agents_mean": 0.032, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.048, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.4, "enqueue_mean_agents_mean": 0.012, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 4.901960784313725e-05, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.004901960784313725}, "hist_stats": {"episode_reward": [-541.6840000000162, -2091.2439999999965, -522.7799999999967, -744.1510000000064, -940.883999999992, -4202.473000000004, -453.06100000000686, -973.2355000000229, -1446.9164999999978, -2962.1415000000093, -1514.8725000000113, -660.1654999999929, -6928.388500000003, -1381.6814999999824, -3597.6049999999977, -1004.747499999997, -4461.311000000031, -1687.2380000000062, -1504.537499999994, -1837.103499999981, -1739.8395000000096, -995.7809999999952, -6090.865999999997, -7016.580000000112, -463.6779999999998, -3011.738999999968, -725.7964999999882, -10076.264000000008, -9788.43199999991, -7855.273999999977, -2047.8230000000012, -5325.2094999999845, -4664.199999999976, -6403.252000000017, -811.0265000000074, -8252.859500000039, -8537.025500000093, -8577.52899999997, -8757.681500000004, -10345.878500000043, -10220.03949999994, -10242.641000000087, -7972.8064999999715, -6500.238500000006, -4944.439500000029, -7993.258000000011, -6616.080499999936, -9720.217500000059, -8566.78000000007, -128.52849999999762, -9778.894000000058, -6532.796999999996, -7879.445000000008, -6075.527499999991, -8932.090000000037, -10809.260000000104, -8122.18200000003, -4086.295500000009, -6968.4729999999945, -7819.733499999972, -7641.672000000002, -7787.576500000082, -10840.274499999918, -7918.621000000018, -7023.054500000019, -9046.999500000027, -8901.586500000012, -2663.6129999999953, -6372.980000000008, -6871.078500000001, -9764.438999999938, 9.800000000000002, -7216.066500000021, -6848.32449999997, -7915.5109999999995, -7486.966000000048, -2399.6924999999887, -9901.076500000045, -4725.421499999987, -1483.2275000000175, -71.0794999999999, -2641.138499999987, -3794.2660000000114, -6552.854499999996, -8037.57, -2877.3384999999817, -12951.865499999962, -8894.137999999994, -5889.666500000052, -5212.05099999998, -9139.015000000003, -8956.487999999868, -8385.188000000007, -5290.776500000002, -10201.989000000036, -4784.713500000018, -7624.455500000052, -6848.50950000004, -1652.4460000000324, -10009.852999999976], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-107.52699999999916, -98.88099999999922, -121.00999999999918, -100.59599999999926, -113.66999999999918, -423.51999999999987, -412.7764999999998, -428.4699999999999, -407.28749999999974, -419.18999999999977, -106.1599999999997, -96.4969999999999, -119.82999999999961, -95.1629999999999, -105.12999999999973, -156.14949999999976, -135.56600000000032, -164.44999999999973, -138.23550000000026, -149.7499999999998, -187.95950000000036, -179.53650000000022, -202.82000000000033, -181.55800000000028, -189.01000000000036, -838.2400000000008, -837.1690000000009, -852.0000000000015, -833.8275000000011, -841.236500000001, -93.11000000000014, -78.88999999999999, -101.1600000000001, -79.79100000000004, -100.1100000000001, -197.15999999999906, -182.66949999999903, -212.8499999999991, -181.02599999999947, -199.52999999999912, -292.3165000000004, -285.6570000000007, -299.84000000000003, -278.7230000000009, -290.38000000000045, -593.9295000000003, -586.7835000000008, -601.5, -586.4185000000009, -593.5100000000006, -307.8800000000007, -289.48400000000106, -315.6100000000002, -297.71850000000103, -304.1800000000007, -135.49000000000004, -122.54850000000002, -148.02000000000012, -118.93700000000015, -135.17000000000013, -1384.4485000000009, -1389.6524999999992, -1388.3370000000004, -1377.8864999999994, -1388.0640000000003, -278.4700000000018, -269.7365000000017, -288.3395000000019, -265.2655000000018, -279.8700000000018, -717.3189999999998, -717.6780000000005, -728.2459999999998, -707.9820000000004, -726.38, -203.81850000000014, -197.57950000000025, -214.67000000000016, -184.08249999999998, -204.59700000000015, -891.4740000000004, -893.7800000000002, -903.3535000000003, -875.5239999999994, -897.1795000000004, -335.4369999999998, -331.7584999999998, -349.9299999999999, -331.8624999999999, -338.2499999999999, -302.4894999999997, -296.50949999999966, -313.83000000000004, -287.8084999999996, -303.9, -364.95, -367.6465000000002, -380.47999999999917, -362.1170000000002, -361.91000000000025, -349.6499999999993, -338.54999999999956, -359.21999999999946, -337.9999999999992, -354.4194999999993, -197.66300000000038, -189.34850000000026, -207.58000000000038, -192.8795000000003, -208.31000000000046, -1216.2494999999988, -1220.9819999999984, -1222.7934999999989, -1206.6814999999986, -1224.159499999999, -1400.2959999999941, -1403.0309999999945, -1402.3899999999935, -1396.9579999999937, -1413.904999999995, -96.77449999999995, -83.48999999999981, -103.06999999999998, -84.8634999999999, -95.47999999999995, -600.3585000000011, -598.3535000000011, -614.4295000000012, -587.897500000001, -610.7000000000014, -144.74650000000057, -141.0400000000005, -156.4800000000007, -136.85000000000042, -146.6800000000006, -2010.198499999999, -2028.559999999999, -2006.5054999999984, -2006.9474999999984, -2024.0524999999973, -1954.2374999999981, -1966.333499999998, -1955.6769999999974, -1950.1099999999972, -1962.0739999999967, -1570.4324999999967, -1576.1689999999974, -1567.9514999999972, -1562.7054999999973, -1578.015499999997, -406.2305000000002, -409.09850000000006, -413.84000000000003, -401.36400000000015, -417.2900000000001, -1060.9190000000008, -1069.5500000000004, -1067.529999999999, -1052.8820000000014, -1074.3285, -930.4820000000026, -932.7530000000028, -944.0365000000025, -916.1830000000023, -940.7455000000028, -1280.0719999999997, -1278.857499999999, -1279.8399999999992, -1270.1104999999998, -1294.3719999999987, -163.18699999999984, -159.22299999999987, -166.75999999999982, -155.94649999999982, -165.9099999999998, -1648.2789999999984, -1650.6879999999985, -1649.2794999999985, -1646.3394999999991, -1658.2734999999977, -1703.5094999999951, -1715.168499999994, -1712.3589999999947, -1689.9749999999935, -1716.013499999994, -1711.9385000000009, -1722.3485000000005, -1716.4650000000015, -1707.9665000000014, -1718.8105000000005, -1752.7574999999981, -1750.713499999998, -1747.616, -1747.3404999999975, -1759.253999999998, -2070.4300000000026, -2075.568000000002, -2070.4740000000024, -2056.900500000002, -2072.5060000000026, -2038.740000000001, -2049.683000000001, -2045.3930000000025, -2040.0440000000017, -2046.1795000000016, -2044.5290000000005, -2055.2520000000004, -2050.234000000001, -2038.26, -2054.365999999999, -1597.600000000003, -1589.471500000003, -1593.8580000000038, -1589.458000000001, -1602.4190000000033, -1304.747999999998, -1293.3269999999968, -1302.613999999997, -1290.065499999997, -1309.483999999998, -985.871999999999, -989.4769999999991, -990.7124999999996, -984.3609999999989, -994.0169999999991, -1592.2650000000015, -1605.0040000000013, -1593.6295000000002, -1594.982500000001, -1607.3770000000015, -1314.4110000000014, -1324.8525000000013, -1321.1155000000003, -1326.2935000000018, -1329.4080000000015, -1939.4219999999978, -1946.965999999998, -1946.1119999999985, -1937.9179999999978, -1949.7994999999978, -1712.974999999999, -1714.1989999999992, -1712.9470000000003, -1707.7649999999983, -1718.8939999999993, -25.670000000000115, -19.990000000000077, -29.089000000000116, -22.960000000000107, -30.819500000000104, -1954.6819999999998, -1958.1125000000002, -1951.8410000000008, -1952.1299999999983, -1962.1285000000012, -1305.3194999999985, -1309.5729999999985, -1305.4994999999976, -1295.3649999999977, -1317.0399999999986, -1577.3830000000003, -1579.6480000000001, -1572.9770000000008, -1564.3210000000001, -1585.1160000000002, -1210.7495000000004, -1218.3179999999998, -1208.4964999999986, -1213.002, -1224.9615, -1786.0019999999959, -1784.1504999999952, -1786.7104999999963, -1781.976999999995, -1793.2499999999955, -2161.6544999999983, -2161.944499999999, -2156.742999999999, -2160.9169999999976, -2168.000999999997, -1623.882999999998, -1625.5049999999983, -1630.428499999999, -1613.4244999999992, -1628.9409999999984, -815.9574999999992, -808.243499999999, -819.6759999999991, -817.8794999999989, -824.5389999999985, -1394.4110000000012, -1386.9255, -1391.8335000000006, -1393.2034999999996, -1402.0994999999996, -1558.9045000000026, -1558.6200000000013, -1570.1150000000025, -1562.9980000000032, -1569.0960000000023, -1524.3104999999982, -1527.950499999997, -1529.1639999999968, -1523.1579999999983, -1537.0889999999972, -1556.071999999997, -1562.1059999999964, -1559.0399999999954, -1550.7754999999959, -1559.5829999999967, -2162.838500000001, -2168.200500000002, -2164.782000000001, -2170.3755000000037, -2174.078000000002, -1586.0809999999994, -1584.6354999999999, -1581.0045000000005, -1584.5639999999996, -1582.336, -1401.2139999999993, -1401.6554999999992, -1411.2669999999994, -1398.8884999999993, -1410.0294999999992, -1806.7030000000038, -1808.3940000000018, -1807.8935000000033, -1805.9720000000038, -1818.0370000000037, -1783.1424999999983, -1775.4134999999987, -1783.2214999999987, -1774.0444999999975, -1785.7644999999975, -532.9285000000008, -525.8900000000006, -538.796500000001, -527.8535000000008, -538.1445000000009, -1274.7959999999985, -1269.7129999999986, -1272.6804999999993, -1269.7849999999976, -1286.0054999999988, -1369.4995000000017, -1378.2995000000008, -1372.2995000000008, -1365.4605000000004, -1385.5195000000012, -1948.034500000001, -1952.3005000000019, -1950.078000000002, -1951.7980000000018, -1962.2280000000019, 1.2999999999999998, 4.749999999999999, 1.15, 2.4499999999999997, 0.14999999999999997, -1438.9909999999975, -1444.231999999997, -1443.5909999999967, -1437.9594999999974, -1451.292999999997, -1366.203500000002, -1367.7285000000022, -1369.7165000000025, -1362.8020000000026, -1381.8740000000016, -1577.8615000000013, -1587.4115000000004, -1584.945, -1578.7925000000005, -1586.500500000001, -1499.7485000000008, -1495.071499999999, -1495.0520000000004, -1492.0544999999993, -1505.0394999999999, -472.5665000000007, -463.74000000000063, -489.9990000000007, -482.4870000000006, -490.90000000000066, -1971.8699999999965, -1982.1964999999984, -1978.3064999999979, -1982.1924999999987, -1986.5109999999977, -942.1385000000008, -942.1505000000005, -950.444500000001, -939.529500000001, -951.1585000000009, -288.58499999999964, -287.0134999999994, -308.66999999999916, -296.38899999999956, -302.5699999999993, -12.7295, -7.549999999999996, -17.200000000000006, -16.85, -16.75000000000001, -525.6690000000007, -517.1160000000003, -538.6165000000009, -526.3185000000007, -533.4185000000008, -757.5595000000001, -745.5800000000005, -762.5085000000005, -760.8290000000004, -767.7890000000004, -1311.7765000000006, -1310.5729999999994, -1311.667000000001, -1302.9555000000007, -1315.8825000000008, -1608.010500000003, -1606.4705000000024, -1601.2895000000033, -1604.8435000000025, -1616.9560000000026, -572.0755000000008, -567.461500000001, -581.031500000001, -574.1600000000005, -582.6100000000006, -2584.365, -2584.795500000001, -2584.727, -2599.653000000001, -2598.325000000001, -1772.4894999999988, -1777.9544999999978, -1775.0579999999993, -1786.6389999999988, -1781.9969999999992, -1175.1809999999996, -1181.8190000000002, -1172.5085, -1176.7719999999995, -1183.3859999999995, -1035.3480000000015, -1039.8880000000015, -1040.6470000000015, -1049.400000000002, -1046.7680000000018, -1825.2659999999962, -1827.1859999999954, -1820.6489999999967, -1833.3264999999958, -1832.5874999999971, -1785.2970000000048, -1796.193000000004, -1790.8840000000037, -1794.359500000004, -1789.7545000000048, -1674.8754999999978, -1679.240999999998, -1673.8314999999982, -1678.769999999997, -1678.4699999999987, -1057.1725000000006, -1052.1165000000005, -1057.9475000000002, -1058.6040000000007, -1064.9359999999995, -2034.3719999999967, -2041.003999999996, -2034.7174999999972, -2048.376999999996, -2043.5184999999956, -951.8880000000003, -956.3090000000001, -957.3010000000004, -956.9450000000004, -962.2705000000005, -1520.8575000000005, -1522.458500000001, -1518.4159999999997, -1526.7425000000017, -1535.9810000000007, -1367.7989999999975, -1376.6994999999974, -1366.1969999999967, -1367.0089999999973, -1370.8049999999978, -325.79949999999855, -319.93799999999936, -340.4584999999983, -332.69999999999874, -333.54999999999853, -1998.8035000000066, -2008.3325000000032, -1994.3750000000025, -2003.9765000000039, -2004.3655000000037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.988304417565956, "mean_inference_ms": 4.865251548328851, "mean_action_processing_ms": 0.5698350920426526, "mean_env_wait_ms": 3.825530690205261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019020557403564453, "StateBufferConnector_ms": 0.01250314712524414, "ViewRequirementAgentConnector_ms": 0.5852053165435791}, "num_episodes": 4, "episode_return_max": 9.800000000000002, "episode_return_min": -12951.865499999962, "episode_return_mean": -5634.664660000005, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.686536108977723, "num_env_steps_trained_throughput_per_sec": 31.686536108977723, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 126987.658, "restore_workers_time_ms": 0.0, "training_step_time_ms": 126987.658, "sample_time_ms": 54885.149, "learn_time_ms": 72099.693, "learn_throughput": 55.479, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": true, "training_iteration": 50, "trial_id": "05971_00000", "date": "2026-02-19_16-05-20", "timestamp": 1771513520, "time_this_iter_s": 126.24430871009827, "time_total_s": 6585.138459205627, "pid": 42696, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001DC8AE65EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6585.138459205627, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 19.1031847133758, "ram_util_percent": 41.14968152866241, "gpu_util_percent0": 0.26140127388535034, "vram_util_percent0": 0.18419918538547944}}
