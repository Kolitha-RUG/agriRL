{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.136700630187988, "cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 9.859407360943512, "policy_loss": -0.00381649640456016, "vf_loss": 9.862269129014066, "vf_explained_var": 0.018292580440545537, "kl": 0.004773698134702001, "entropy": 0.7936300759609085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 2355.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -6762.517500000011, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -8927.846500000014, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 4000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": -1346.6824999999997}, "policy_reward_mean": {"shared_policy": -1785.5692999999997}, "custom_metrics": {"delivered_mean_agents_mean": 219.0, "delivered_mean_agents_min": 205.0, "delivered_mean_agents_max": 227.0, "backlog_mean_agents_mean": 32.75, "backlog_mean_agents_min": 29.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.1, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.05, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.0, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.0, "drone_credit_mean_agents_mean": 0.0, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.0, "drone_share_proxy_mean": 0.0, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.0}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011], "episode_lengths": [1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.687091226251207, "mean_inference_ms": 6.887470355959899, "mean_action_processing_ms": 0.6445653138831686, "mean_env_wait_ms": 4.704313795437249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025218725204467773, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5434572696685791}, "num_episodes": 4, "episode_return_max": -6762.517500000011, "episode_return_min": -10141.812500000005, "episode_return_mean": -8927.846500000014, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 23.605580011497374, "num_env_steps_trained_throughput_per_sec": 23.605580011497374, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 169451.46, "restore_workers_time_ms": 0.0, "training_step_time_ms": 169451.46, "sample_time_ms": 67977.113, "learn_time_ms": 101468.961, "learn_throughput": 39.421, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 1, "trial_id": "386ba_00000", "date": "2026-02-09_22-24-04", "timestamp": 1770672244, "time_this_iter_s": 169.45247101783752, "time_total_s": 169.45247101783752, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA091AFBE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 169.45247101783752, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.83397129186603, "ram_util_percent": 47.726794258373204, "gpu_util_percent0": 0.3382775119617225, "vram_util_percent0": 0.20312021560318166}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.80430030822754, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.74228138042863, "policy_loss": -0.008833102461527994, "vf_loss": 9.749942964808955, "vf_explained_var": 0.05536508920845712, "kl": 0.011715102049609167, "entropy": 0.7841924507779934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 7065.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -6520.371499999972, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -8622.169312499995, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 8000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": -1296.3805000000025}, "policy_reward_mean": {"shared_policy": -1724.4338624999996}, "custom_metrics": {"delivered_mean_agents_mean": 223.375, "delivered_mean_agents_min": 205.0, "delivered_mean_agents_max": 231.0, "backlog_mean_agents_mean": 30.75, "backlog_mean_agents_min": 24.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.07500000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.025, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.025, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.0, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.0, "drone_share_proxy_mean": 0.0, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.0}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7289676436590256, "mean_inference_ms": 6.906729206616576, "mean_action_processing_ms": 0.6500677963079373, "mean_env_wait_ms": 4.562104925035827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03758370876312256, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.6638973951339722}, "num_episodes": 4, "episode_return_max": -6520.371499999972, "episode_return_min": -10141.812500000005, "episode_return_mean": -8622.169312499995, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 25.046662561746142, "num_env_steps_trained_throughput_per_sec": 25.046662561746142, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 164576.688, "restore_workers_time_ms": 0.0, "training_step_time_ms": 164576.688, "sample_time_ms": 67352.378, "learn_time_ms": 97219.355, "learn_throughput": 41.144, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 2, "trial_id": "386ba_00000", "date": "2026-02-09_22-26-44", "timestamp": 1770672404, "time_this_iter_s": 159.7029149532318, "time_total_s": 329.15538597106934, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA091AEB90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 329.15538597106934, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.878282828282828, "ram_util_percent": 41.597474747474735, "gpu_util_percent0": 0.3083333333333333, "vram_util_percent0": 0.20661919636028084}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.467885971069336, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.831321010265635, "policy_loss": -0.01068078520324184, "vf_loss": 9.840567008502418, "vf_explained_var": 0.06783348390251208, "kl": 0.014347862108351641, "entropy": 0.7655082796789279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 11775.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -6520.371499999972, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -8403.193166666655, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 12000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": -1296.3805000000025}, "policy_reward_mean": {"shared_policy": -1680.6386333333332}, "custom_metrics": {"delivered_mean_agents_mean": 217.0, "delivered_mean_agents_min": 200.0, "delivered_mean_agents_max": 231.0, "backlog_mean_agents_mean": 30.0, "backlog_mean_agents_min": 23.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05000000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.03333333333333333, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.016666666666666666, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.016666666666666666, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0004166666666666667, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.774461537695608, "mean_inference_ms": 6.941092644820164, "mean_action_processing_ms": 0.6548334257626482, "mean_env_wait_ms": 4.506125814234076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03348986307779948, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.6868382294972738}, "num_episodes": 4, "episode_return_max": -6520.371499999972, "episode_return_min": -10141.812500000005, "episode_return_mean": -8403.193166666655, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 22.574975743987284, "num_env_steps_trained_throughput_per_sec": 22.574975743987284, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 168780.24, "restore_workers_time_ms": 0.0, "training_step_time_ms": 168780.24, "sample_time_ms": 67982.922, "learn_time_ms": 100792.511, "learn_throughput": 39.685, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 3, "trial_id": "386ba_00000", "date": "2026-02-09_22-29-41", "timestamp": 1770672581, "time_this_iter_s": 177.18835401535034, "time_total_s": 506.3437399864197, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA091AF880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 506.3437399864197, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.430275229357804, "ram_util_percent": 41.28715596330275, "gpu_util_percent0": 0.28, "vram_util_percent0": 0.20697496448147432}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.627277374267578, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.805581671720857, "policy_loss": -0.011026392795734755, "vf_loss": 9.81536160831492, "vf_explained_var": 0.06149747202097737, "kl": 0.012464598394157386, "entropy": 0.7436230744778983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 16485.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -689.5405000000069, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -7328.315374999991, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": -130.02949999999987}, "policy_reward_mean": {"shared_policy": -1465.6630750000004}, "custom_metrics": {"delivered_mean_agents_mean": 215.375, "delivered_mean_agents_min": 200.0, "delivered_mean_agents_max": 231.0, "backlog_mean_agents_mean": 26.8125, "backlog_mean_agents_min": 2.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.2, "harvest_mean_agents_mean": 0.025, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.037500000000000006, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.0125, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0003125, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.775494624465297, "mean_inference_ms": 6.868536800780642, "mean_action_processing_ms": 0.653952453830385, "mean_env_wait_ms": 4.457396934838517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02511739730834961, "StateBufferConnector_ms": 0.009419023990631104, "ViewRequirementAgentConnector_ms": 0.6561383605003357}, "num_episodes": 4, "episode_return_max": -689.5405000000069, "episode_return_min": -10141.812500000005, "episode_return_mean": -7328.315374999991, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.37457215856493, "num_env_steps_trained_throughput_per_sec": 26.37457215856493, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 164500.487, "restore_workers_time_ms": 0.0, "training_step_time_ms": 164500.236, "sample_time_ms": 65795.99, "learn_time_ms": 98699.892, "learn_throughput": 40.527, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 4, "trial_id": "386ba_00000", "date": "2026-02-09_22-32-13", "timestamp": 1770672733, "time_this_iter_s": 151.66373991966248, "time_total_s": 658.0074799060822, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA044EF1C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 658.0074799060822, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.635828877005345, "ram_util_percent": 40.60053475935828, "gpu_util_percent0": 0.24475935828877005, "vram_util_percent0": 0.2104618993753739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.718476295471191, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.672336223019157, "policy_loss": -0.015160095408032875, "vf_loss": 9.686119995400658, "vf_explained_var": 0.08909860506432325, "kl": 0.0137632346401488, "entropy": 0.7286485322847994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 21195.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -689.5405000000069, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -6948.586099999993, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": -130.02949999999987}, "policy_reward_mean": {"shared_policy": -1389.7172200000005}, "custom_metrics": {"delivered_mean_agents_mean": 215.55, "delivered_mean_agents_min": 200.0, "delivered_mean_agents_max": 231.0, "backlog_mean_agents_mean": 26.65, "backlog_mean_agents_min": 2.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.06000000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.02, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.030000000000000006, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.01, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00025, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.767021744830187, "mean_inference_ms": 6.78283051460417, "mean_action_processing_ms": 0.6521799748636083, "mean_env_wait_ms": 4.418289458598855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020093917846679688, "StateBufferConnector_ms": 0.012542009353637695, "ViewRequirementAgentConnector_ms": 0.6375908851623535}, "num_episodes": 4, "episode_return_max": -689.5405000000069, "episode_return_min": -10141.812500000005, "episode_return_mean": -6948.586099999993, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 25.997015475058436, "num_env_steps_trained_throughput_per_sec": 25.997015475058436, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 162373.153, "restore_workers_time_ms": 0.0, "training_step_time_ms": 162372.952, "sample_time_ms": 64531.87, "learn_time_ms": 97836.522, "learn_throughput": 40.885, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 5, "trial_id": "386ba_00000", "date": "2026-02-09_22-34-47", "timestamp": 1770672887, "time_this_iter_s": 153.86581873893738, "time_total_s": 811.8732986450195, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09201360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 811.8732986450195, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.92578947368421, "ram_util_percent": 40.01157894736843, "gpu_util_percent0": 0.22931578947368417, "vram_util_percent0": 0.2083935412542103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.283266067504883, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.600599933632367, "policy_loss": -0.01715690116116267, "vf_loss": 9.616199577436833, "vf_explained_var": 0.16080747173343748, "kl": 0.015572578175759778, "entropy": 0.7253277803935316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 25905.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -335.4194999999981, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -6159.150374999995, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 24000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": -63.17099999999997}, "policy_reward_mean": {"shared_policy": -1231.830075}, "custom_metrics": {"delivered_mean_agents_mean": 216.0, "delivered_mean_agents_min": 200.0, "delivered_mean_agents_max": 234.0, "backlog_mean_agents_mean": 24.916666666666668, "backlog_mean_agents_min": 2.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05000000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.016666666666666666, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.041666666666666664, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.016666666666666666, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.000396021021021021, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.769356269973461, "mean_inference_ms": 6.731759828047472, "mean_action_processing_ms": 0.6533446138512139, "mean_env_wait_ms": 4.4011186616142375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018870830535888672, "StateBufferConnector_ms": 0.010451674461364746, "ViewRequirementAgentConnector_ms": 0.6475081046422323}, "num_episodes": 4, "episode_return_max": -335.4194999999981, "episode_return_min": -10141.812500000005, "episode_return_mean": -6159.150374999995, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.211664935631145, "num_env_steps_trained_throughput_per_sec": 26.211664935631145, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 160744.929, "restore_workers_time_ms": 0.0, "training_step_time_ms": 160744.762, "sample_time_ms": 65139.153, "learn_time_ms": 95601.31, "learn_throughput": 41.84, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 6, "trial_id": "386ba_00000", "date": "2026-02-09_22-37-20", "timestamp": 1770673040, "time_this_iter_s": 152.60732650756836, "time_total_s": 964.4806251525879, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA092024D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 964.4806251525879, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 31.79523809523809, "ram_util_percent": 40.72116402116403, "gpu_util_percent0": 0.28068783068783065, "vram_util_percent0": 0.21455840654668207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.300536155700684, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.801881231927569, "policy_loss": -0.01921793786549818, "vf_loss": 9.819462250347097, "vf_explained_var": 0.23555921373093963, "kl": 0.01636932221100307, "entropy": 0.7127134620510596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 30615.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -335.4194999999981, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -5778.647678571425, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 28000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": -63.17099999999997}, "policy_reward_mean": {"shared_policy": -1155.729535714286}, "custom_metrics": {"delivered_mean_agents_mean": 214.39285714285714, "delivered_mean_agents_min": 199.0, "delivered_mean_agents_max": 234.0, "backlog_mean_agents_mean": 25.464285714285715, "backlog_mean_agents_min": 2.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.042857142857142864, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.021428571428571432, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.03571428571428571, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.014285714285714287, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00033944658944658944, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.771024247133559, "mean_inference_ms": 6.688633342608531, "mean_action_processing_ms": 0.6538068334448329, "mean_env_wait_ms": 4.386712306980203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01617499760219029, "StateBufferConnector_ms": 0.012516123907906669, "ViewRequirementAgentConnector_ms": 0.6435275077819824}, "num_episodes": 4, "episode_return_max": -335.4194999999981, "episode_return_min": -10141.812500000005, "episode_return_mean": -5778.647678571425, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.29416803839981, "num_env_steps_trained_throughput_per_sec": 28.29416803839981, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 157977.352, "restore_workers_time_ms": 0.0, "training_step_time_ms": 157977.066, "sample_time_ms": 64876.545, "learn_time_ms": 93096.406, "learn_throughput": 42.966, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 7, "trial_id": "386ba_00000", "date": "2026-02-09_22-39-41", "timestamp": 1770673181, "time_this_iter_s": 141.37540364265442, "time_total_s": 1105.8560287952423, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09202050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1105.8560287952423, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 24.482758620689655, "ram_util_percent": 40.755172413793105, "gpu_util_percent0": 0.3235632183908046, "vram_util_percent0": 0.20061808983148874}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.691543579101562, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.364786063435224, "policy_loss": -0.019338746717092906, "vf_loss": 9.382622452956603, "vf_explained_var": 0.3119937979112006, "kl": 0.015023581621979563, "entropy": 0.6832207143812928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 35325.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -328.7140000000006, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -5212.147578124996, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 32000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": -57.33450000000005}, "policy_reward_mean": {"shared_policy": -1042.4295156250002}, "custom_metrics": {"delivered_mean_agents_mean": 212.84375, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 234.0, "backlog_mean_agents_mean": 24.03125, "backlog_mean_agents_min": 2.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.037500000000000006, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.018750000000000003, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.03125, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.0125, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00029701576576576577, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.767229611038241, "mean_inference_ms": 6.632902526803337, "mean_action_processing_ms": 0.6530326119296492, "mean_env_wait_ms": 4.3697605582223975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014153122901916504, "StateBufferConnector_ms": 0.01877695322036743, "ViewRequirementAgentConnector_ms": 0.6480708718299866}, "num_episodes": 4, "episode_return_max": -328.7140000000006, "episode_return_min": -10141.812500000005, "episode_return_mean": -5212.147578124996, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.262854717551413, "num_env_steps_trained_throughput_per_sec": 30.262854717551413, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 154752.088, "restore_workers_time_ms": 0.0, "training_step_time_ms": 154751.838, "sample_time_ms": 63728.588, "learn_time_ms": 91019.149, "learn_throughput": 43.947, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 8, "trial_id": "386ba_00000", "date": "2026-02-09_22-41-53", "timestamp": 1770673313, "time_this_iter_s": 132.1787519454956, "time_total_s": 1238.034780740738, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA091AFAC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1238.034780740738, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.903658536585365, "ram_util_percent": 40.84695121951219, "gpu_util_percent0": 0.2684756097560975, "vram_util_percent0": 0.19914404780344822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.266436576843262, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 4.959295391479622, "policy_loss": -0.015657559308498277, "vf_loss": 4.973389764399032, "vf_explained_var": 0.4057962651085702, "kl": 0.01563193599716481, "entropy": 0.6372135427220865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 40035.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 442.73149999999623, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -4605.205986111107, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 105.79549999999998}, "policy_reward_mean": {"shared_policy": -921.0411972222224}, "custom_metrics": {"delivered_mean_agents_mean": 213.97222222222223, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 234.0, "backlog_mean_agents_mean": 21.5, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.03333333333333334, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.01666666666666667, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.03333333333333333, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.011111111111111112, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00026401401401401404, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.761424694641813, "mean_inference_ms": 6.572625506592938, "mean_action_processing_ms": 0.6519459010293419, "mean_env_wait_ms": 4.352574924546523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015381971995035807, "StateBufferConnector_ms": 0.01951720979478624, "ViewRequirementAgentConnector_ms": 0.6388485431671143}, "num_episodes": 4, "episode_return_max": 442.73149999999623, "episode_return_min": -10141.812500000005, "episode_return_mean": -4605.205986111107, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.071739632311083, "num_env_steps_trained_throughput_per_sec": 30.071739632311083, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 152336.884, "restore_workers_time_ms": 0.0, "training_step_time_ms": 152336.661, "sample_time_ms": 62850.605, "learn_time_ms": 89481.856, "learn_throughput": 44.702, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 9, "trial_id": "386ba_00000", "date": "2026-02-09_22-44-07", "timestamp": 1770673447, "time_this_iter_s": 133.01925206184387, "time_total_s": 1371.0540328025818, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09270B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1371.0540328025818, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 21.387804878048783, "ram_util_percent": 40.853658536585364, "gpu_util_percent0": 0.2530487804878049, "vram_util_percent0": 0.1991410690242711}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.489253997802734, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 6.23129682773744, "policy_loss": -0.02361768901371842, "vf_loss": 6.2531111077391675, "vf_explained_var": 0.35675236094276364, "kl": 0.018034178940109682, "entropy": 0.6496173461151731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 44745.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 442.73149999999623, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -4264.565112499998, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 105.79549999999998}, "policy_reward_mean": {"shared_policy": -852.9130225000001}, "custom_metrics": {"delivered_mean_agents_mean": 215.15, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 235.0, "backlog_mean_agents_mean": 20.725, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.04, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.02, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.03, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.01, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0002376126126126126, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7531979688810235, "mean_inference_ms": 6.511182262621349, "mean_action_processing_ms": 0.6504852187488708, "mean_env_wait_ms": 4.335494334856572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016360878944396973, "StateBufferConnector_ms": 0.017565488815307617, "ViewRequirementAgentConnector_ms": 0.6276679039001465}, "num_episodes": 4, "episode_return_max": 442.73149999999623, "episode_return_min": -10141.812500000005, "episode_return_mean": -4264.565112499998, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.51129960075341, "num_env_steps_trained_throughput_per_sec": 30.51129960075341, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 150213.093, "restore_workers_time_ms": 0.0, "training_step_time_ms": 150212.892, "sample_time_ms": 62016.698, "learn_time_ms": 88192.114, "learn_throughput": 45.356, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 10, "trial_id": "386ba_00000", "date": "2026-02-09_22-46-18", "timestamp": 1770673578, "time_this_iter_s": 131.10397028923035, "time_total_s": 1502.1580030918121, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA090F1120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1502.1580030918121, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 21.40246913580247, "ram_util_percent": 40.80925925925926, "gpu_util_percent0": 0.2573456790123457, "vram_util_percent0": 0.199247468442225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.814437866210938, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 3.044558979371551, "policy_loss": -0.024572806350784, "vf_loss": 3.0673070459861917, "vf_explained_var": 0.7035112544229836, "kl": 0.018247414708187318, "entropy": 0.5989120294334023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 49455.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": 442.73149999999623, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -3866.098863636362, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 44000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 105.79549999999998}, "policy_reward_mean": {"shared_policy": -773.2197727272727}, "custom_metrics": {"delivered_mean_agents_mean": 215.1818181818182, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 235.0, "backlog_mean_agents_mean": 19.181818181818183, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05454545454545454, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.02727272727272727, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.02727272727272727, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.009090909090909092, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00021601146601146602, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7455552446311895, "mean_inference_ms": 6.454167679082275, "mean_action_processing_ms": 0.6491010256559958, "mean_env_wait_ms": 4.320441758631583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017659772526134144, "StateBufferConnector_ms": 0.015968626195734196, "ViewRequirementAgentConnector_ms": 0.6372489712455056}, "num_episodes": 4, "episode_return_max": 442.73149999999623, "episode_return_min": -10141.812500000005, "episode_return_mean": -3866.098863636362, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.157716690671204, "num_env_steps_trained_throughput_per_sec": 29.157716690671204, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 146986.442, "restore_workers_time_ms": 0.0, "training_step_time_ms": 146986.242, "sample_time_ms": 60986.062, "learn_time_ms": 85996.339, "learn_throughput": 46.514, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 11, "trial_id": "386ba_00000", "date": "2026-02-09_22-48-35", "timestamp": 1770673715, "time_this_iter_s": 137.18897128105164, "time_total_s": 1639.3469743728638, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09202170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1639.3469743728638, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.891176470588235, "ram_util_percent": 40.864705882352936, "gpu_util_percent0": 0.2837647058823529, "vram_util_percent0": 0.19962714445817406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.26203727722168, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 2.6651625022513596, "policy_loss": -0.021798324509723518, "vf_loss": 2.6851773241269865, "vf_explained_var": 0.4662415278185705, "kl": 0.017835038669519007, "entropy": 0.596727251690158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 54165.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 447.82549999999605, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -3522.918958333332, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 48000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 105.79549999999998}, "policy_reward_mean": {"shared_policy": -704.5837916666666}, "custom_metrics": {"delivered_mean_agents_mean": 215.66666666666666, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 235.0, "backlog_mean_agents_mean": 17.770833333333332, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05416666666666667, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.024999999999999998, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.024999999999999998, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.012500000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0002949097353167121, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.741717566176378, "mean_inference_ms": 6.407026170962598, "mean_action_processing_ms": 0.6482658412963421, "mean_env_wait_ms": 4.309676376809209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016188124815622967, "StateBufferConnector_ms": 0.016740461190541584, "ViewRequirementAgentConnector_ms": 0.6560941537221273}, "num_episodes": 4, "episode_return_max": 447.82549999999605, "episode_return_min": -10141.812500000005, "episode_return_mean": -3522.918958333332, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.251100546061526, "num_env_steps_trained_throughput_per_sec": 27.251100546061526, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 145694.557, "restore_workers_time_ms": 0.0, "training_step_time_ms": 145694.356, "sample_time_ms": 60764.415, "learn_time_ms": 84926.3, "learn_throughput": 47.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 12, "trial_id": "386ba_00000", "date": "2026-02-09_22-51-02", "timestamp": 1770673862, "time_this_iter_s": 146.78606152534485, "time_total_s": 1786.1330358982086, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA092011B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1786.1330358982086, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.29226519337017, "ram_util_percent": 40.091160220994475, "gpu_util_percent0": 0.30513812154696135, "vram_util_percent0": 0.2013646165929388}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.394698143005371, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 1.2152431516067743, "policy_loss": -0.011724342331151832, "vf_loss": 1.2251407635439733, "vf_explained_var": 0.3123755821123751, "kl": 0.018267285516649093, "entropy": 0.5804340243339539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 58875.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": 462.7799999999959, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -3219.096923076922, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 52000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 107.06650000000002}, "policy_reward_mean": {"shared_policy": -643.8193846153846}, "custom_metrics": {"delivered_mean_agents_mean": 215.44230769230768, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 235.0, "backlog_mean_agents_mean": 16.423076923076923, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05384615384615385, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.023076923076923075, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.023076923076923075, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.01153846153846154, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0002722243710615804, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.738785890915743, "mean_inference_ms": 6.367176480172669, "mean_action_processing_ms": 0.6475732667685771, "mean_env_wait_ms": 4.3000865667379236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01494288444519043, "StateBufferConnector_ms": 0.015452733406653771, "ViewRequirementAgentConnector_ms": 0.6590105020082914}, "num_episodes": 4, "episode_return_max": 462.7799999999959, "episode_return_min": -10141.812500000005, "episode_return_mean": -3219.096923076922, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.58060355973304, "num_env_steps_trained_throughput_per_sec": 27.58060355973304, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 142478.768, "restore_workers_time_ms": 0.0, "training_step_time_ms": 142478.568, "sample_time_ms": 60015.778, "learn_time_ms": 82459.049, "learn_throughput": 48.509, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 13, "trial_id": "386ba_00000", "date": "2026-02-09_22-53-27", "timestamp": 1770674007, "time_this_iter_s": 145.03448843955994, "time_total_s": 1931.1675243377686, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09271EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1931.1675243377686, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 28.147486033519552, "ram_util_percent": 39.968156424581004, "gpu_util_percent0": 0.32039106145251395, "vram_util_percent0": 0.19942660331374698}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.050048828125, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 3.274320959260256, "policy_loss": -0.027561291270729177, "vf_loss": 3.3002723418729825, "vf_explained_var": 0.3190408042914802, "kl": 0.01609904454458708, "entropy": 0.5770328754389109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 63585.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 486.0194999999949, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2989.008401785714, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 56000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 115.15050000000016}, "policy_reward_mean": {"shared_policy": -597.8016803571429}, "custom_metrics": {"delivered_mean_agents_mean": 216.85714285714286, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 250.0, "backlog_mean_agents_mean": 15.678571428571429, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05357142857142857, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.02142857142857143, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.02142857142857143, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.010714285714285716, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00025277977312861035, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.736582647459223, "mean_inference_ms": 6.333214177122254, "mean_action_processing_ms": 0.647028072169847, "mean_env_wait_ms": 4.2922803764452215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875535556248255, "StateBufferConnector_ms": 0.01613114561353411, "ViewRequirementAgentConnector_ms": 0.6570867129734584}, "num_episodes": 4, "episode_return_max": 486.0194999999949, "episode_return_min": -10141.812500000005, "episode_return_mean": -2989.008401785714, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.96062653829276, "num_env_steps_trained_throughput_per_sec": 27.96062653829276, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 141618.476, "restore_workers_time_ms": 0.0, "training_step_time_ms": 141618.376, "sample_time_ms": 60353.392, "learn_time_ms": 81261.343, "learn_throughput": 49.224, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 14, "trial_id": "386ba_00000", "date": "2026-02-09_22-55-50", "timestamp": 1770674150, "time_this_iter_s": 143.06236147880554, "time_total_s": 2074.229885816574, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09270AF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2074.229885816574, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 27.894915254237286, "ram_util_percent": 39.78870056497175, "gpu_util_percent0": 0.3048587570621469, "vram_util_percent0": 0.20036763183824197}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.184410095214844, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 1.67230283924855, "policy_loss": -0.019415421512041186, "vf_loss": 1.6900306020825786, "vf_explained_var": 0.6150270464567116, "kl": 0.01687659316007153, "entropy": 0.5427912874965911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 68295.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 486.0194999999949, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2763.9732416666666, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 60000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 115.39350000000006}, "policy_reward_mean": {"shared_policy": -552.7946483333334}, "custom_metrics": {"delivered_mean_agents_mean": 218.18333333333334, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 250.0, "backlog_mean_agents_mean": 14.633333333333333, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05333333333333334, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.02, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.02, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.010000000000000002, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00023592778825336965, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.735874500625133, "mean_inference_ms": 6.304182804710958, "mean_action_processing_ms": 0.64666195430271, "mean_env_wait_ms": 4.286231230409674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014620621999104818, "StateBufferConnector_ms": 0.01590450604756673, "ViewRequirementAgentConnector_ms": 0.6477216879526774}, "num_episodes": 4, "episode_return_max": 486.0194999999949, "episode_return_min": -10141.812500000005, "episode_return_mean": -2763.9732416666666, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.37072628341848, "num_env_steps_trained_throughput_per_sec": 27.37072628341848, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 140846.248, "restore_workers_time_ms": 0.0, "training_step_time_ms": 140846.149, "sample_time_ms": 60814.986, "learn_time_ms": 80027.759, "learn_throughput": 49.983, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 15, "trial_id": "386ba_00000", "date": "2026-02-09_22-58-16", "timestamp": 1770674296, "time_this_iter_s": 146.14834308624268, "time_total_s": 2220.3782289028168, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09203D90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2220.3782289028168, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 31.44917127071823, "ram_util_percent": 40.5292817679558, "gpu_util_percent0": 0.2996685082872928, "vram_util_percent0": 0.22154574677401512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.008111000061035, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 1.623857367747402, "policy_loss": -0.025490591990328423, "vf_loss": 1.6478420091409338, "vf_explained_var": 0.7344006737326361, "kl": 0.01505950883751851, "entropy": 0.5165989949508331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 73005.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 486.0194999999949, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2568.983453125, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 64000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 115.39350000000006}, "policy_reward_mean": {"shared_policy": -513.7966906250001}, "custom_metrics": {"delivered_mean_agents_mean": 219.109375, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 250.0, "backlog_mean_agents_mean": 13.890625, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.021875, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.01875, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.009375000000000001, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00022118230148753405, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.735224505172647, "mean_inference_ms": 6.2802276425747525, "mean_action_processing_ms": 0.6463929511309051, "mean_env_wait_ms": 4.281077829638731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015268102288246155, "StateBufferConnector_ms": 0.0164765864610672, "ViewRequirementAgentConnector_ms": 0.6569270044565201}, "num_episodes": 4, "episode_return_max": 486.0194999999949, "episode_return_min": -10141.812500000005, "episode_return_mean": -2568.983453125, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 24.52821922058501, "num_env_steps_trained_throughput_per_sec": 24.52821922058501, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 141893.614, "restore_workers_time_ms": 0.0, "training_step_time_ms": 141893.515, "sample_time_ms": 60368.308, "learn_time_ms": 81521.551, "learn_throughput": 49.067, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 16, "trial_id": "386ba_00000", "date": "2026-02-09_23-00-59", "timestamp": 1770674459, "time_this_iter_s": 163.0828366279602, "time_total_s": 2383.461065530777, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA091AE7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2383.461065530777, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 27.935323383084576, "ram_util_percent": 40.57860696517414, "gpu_util_percent0": 0.31422885572139303, "vram_util_percent0": 0.22349476360260254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.59489631652832, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 2.574162412626222, "policy_loss": -0.02743623298316039, "vf_loss": 2.599975307377534, "vf_explained_var": 0.517441848103914, "kl": 0.01623340339449134, "entropy": 0.5276706562553495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 77715.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": 511.6464999999965, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2415.9898161764704, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 68000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 118.77299999999993}, "policy_reward_mean": {"shared_policy": -483.1979632352942}, "custom_metrics": {"delivered_mean_agents_mean": 219.9558823529412, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 255.0, "backlog_mean_agents_mean": 13.544117647058824, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.047058823529411764, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.023529411764705882, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.01764705882352941, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.008823529411764707, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00020817157787062028, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.736122675261538, "mean_inference_ms": 6.264259571992443, "mean_action_processing_ms": 0.6463089366450301, "mean_env_wait_ms": 4.277559807144617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01584186273462632, "StateBufferConnector_ms": 0.01550737549276913, "ViewRequirementAgentConnector_ms": 0.6529706365921918}, "num_episodes": 4, "episode_return_max": 511.6464999999965, "episode_return_min": -10141.812500000005, "episode_return_mean": -2415.9898161764704, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 23.41673883931728, "num_env_steps_trained_throughput_per_sec": 23.41673883931728, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 144838.223, "restore_workers_time_ms": 0.0, "training_step_time_ms": 144838.223, "sample_time_ms": 61159.923, "learn_time_ms": 83674.545, "learn_throughput": 47.804, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 17, "trial_id": "386ba_00000", "date": "2026-02-09_23-03-50", "timestamp": 1770674630, "time_this_iter_s": 170.8258228302002, "time_total_s": 2554.286888360977, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09201CF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2554.286888360977, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.839336492890997, "ram_util_percent": 40.66872037914691, "gpu_util_percent0": 0.3256872037914692, "vram_util_percent0": 0.22125547269498538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.559106349945068, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.8868695185252815, "policy_loss": -0.010660367400678085, "vf_loss": 0.8958599795391605, "vf_explained_var": 0.7336424235072612, "kl": 0.01669906325823727, "entropy": 0.4632336265152427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 82425.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 534.9649999999991, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2253.4425347222223, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 72000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 129.05549999999997}, "policy_reward_mean": {"shared_policy": -450.6885069444444}, "custom_metrics": {"delivered_mean_agents_mean": 221.88888888888889, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 268.0, "backlog_mean_agents_mean": 12.791666666666666, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05277777777777778, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.022222222222222223, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.016666666666666666, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.008333333333333335, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00019660649021114137, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956, 517.3764999999976, 534.9649999999991, 502.33249999999657, 484.77099999999655], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018, 80.85000000000018, 106.65700000000008, 124.92999999999984, 110.31750000000002, 94.62200000000007, 80.67100000000028, 114.94000000000007, 129.05549999999997, 117.83150000000012, 92.46700000000017, 75.10000000000022, 108.11750000000019, 123.35350000000005, 100.48400000000007, 95.2775, 76.32000000000018, 102.40250000000016, 112.00699999999999, 99.83300000000023, 94.20850000000019]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.737152908658185, "mean_inference_ms": 6.250693721776788, "mean_action_processing_ms": 0.646227898411207, "mean_env_wait_ms": 4.274226114804823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014961759249369303, "StateBufferConnector_ms": 0.019542376200358074, "ViewRequirementAgentConnector_ms": 0.6505939695570204}, "num_episodes": 4, "episode_return_max": 534.9649999999991, "episode_return_min": -10141.812500000005, "episode_return_mean": -2253.4425347222223, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 25.559626858018465, "num_env_steps_trained_throughput_per_sec": 25.559626858018465, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 147270.38, "restore_workers_time_ms": 0.0, "training_step_time_ms": 147270.38, "sample_time_ms": 61944.598, "learn_time_ms": 85322.127, "learn_throughput": 46.881, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 18, "trial_id": "386ba_00000", "date": "2026-02-09_23-06-27", "timestamp": 1770674787, "time_this_iter_s": 156.50377297401428, "time_total_s": 2710.7906613349915, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA092039A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2710.7906613349915, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.079792746113988, "ram_util_percent": 40.85181347150259, "gpu_util_percent0": 0.33170984455958546, "vram_util_percent0": 0.21968076624201724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.380878448486328, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 2.425278119853601, "policy_loss": -0.026335297632199217, "vf_loss": 2.4500266137143356, "vf_explained_var": 0.759683432662563, "kl": 0.015868057141476218, "entropy": 0.5062646882992135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 87135.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "env_runners": {"episode_reward_max": 538.044, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2118.800993421053, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 76000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 129.05549999999997}, "policy_reward_mean": {"shared_policy": -423.7601986842106}, "custom_metrics": {"delivered_mean_agents_mean": 224.39473684210526, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 275.0, "backlog_mean_agents_mean": 12.328947368421053, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.05526315789473685, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.021052631578947368, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.015789473684210527, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.007894736842105265, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00018625878020002868, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956, 517.3764999999976, 534.9649999999991, 502.33249999999657, 484.77099999999655, 536.2184999999987, -353.5290000000061, 498.253499999993, 538.044], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018, 80.85000000000018, 106.65700000000008, 124.92999999999984, 110.31750000000002, 94.62200000000007, 80.67100000000028, 114.94000000000007, 129.05549999999997, 117.83150000000012, 92.46700000000017, 75.10000000000022, 108.11750000000019, 123.35350000000005, 100.48400000000007, 95.2775, 76.32000000000018, 102.40250000000016, 112.00699999999999, 99.83300000000023, 94.20850000000019, 85.73000000000027, 114.335, 123.46249999999999, 106.63900000000008, 106.05200000000006, -92.17999999999992, -66.78199999999978, -57.08549999999983, -62.67299999999985, -74.8084999999997, 77.61100000000039, 108.72750000000009, 115.34650000000018, 104.47850000000021, 92.09000000000029, 79.83050000000027, 111.03000000000004, 124.1635, 116.36800000000008, 106.652]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.737617845029321, "mean_inference_ms": 6.23756547452596, "mean_action_processing_ms": 0.6460553757507416, "mean_env_wait_ms": 4.270985951061361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014174298236244604, "StateBufferConnector_ms": 0.01983642578125, "ViewRequirementAgentConnector_ms": 0.6545421324278179}, "num_episodes": 4, "episode_return_max": 538.044, "episode_return_min": -10141.812500000005, "episode_return_mean": -2118.800993421053, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.050229135887108, "num_env_steps_trained_throughput_per_sec": 26.050229135887108, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 149323.807, "restore_workers_time_ms": 0.0, "training_step_time_ms": 149323.807, "sample_time_ms": 62372.805, "learn_time_ms": 86947.496, "learn_throughput": 46.005, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "training_iteration": 19, "trial_id": "386ba_00000", "date": "2026-02-09_23-09-00", "timestamp": 1770674940, "time_this_iter_s": 153.5565230846405, "time_total_s": 2864.347184419632, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09272E60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2864.347184419632, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.376190476190477, "ram_util_percent": 40.81534391534391, "gpu_util_percent0": 0.24629629629629632, "vram_util_percent0": 0.2207695866709056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.069916248321533, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.8210731622029388, "policy_loss": -0.014920470386352034, "vf_loss": 0.8340363293949459, "vf_explained_var": 0.7445810888856333, "kl": 0.019573030436725057, "entropy": 0.47082440927150143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 91845.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 585.393500000002, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -1983.8228437500006, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 80000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 135.44199999999995}, "policy_reward_mean": {"shared_policy": -396.76456874999997}, "custom_metrics": {"delivered_mean_agents_mean": 227.7625, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 294.0, "backlog_mean_agents_mean": 11.7125, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 37.0, "manual_delivery_mean_agents_mean": 0.057499999999999996, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.02, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.015, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.0075000000000000015, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00017694584119002724, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956, 517.3764999999976, 534.9649999999991, 502.33249999999657, 484.77099999999655, 536.2184999999987, -353.5290000000061, 498.253499999993, 538.044, 585.393500000002, 573.4955000000017, 585.2130000000036, 578.9460000000008], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018, 80.85000000000018, 106.65700000000008, 124.92999999999984, 110.31750000000002, 94.62200000000007, 80.67100000000028, 114.94000000000007, 129.05549999999997, 117.83150000000012, 92.46700000000017, 75.10000000000022, 108.11750000000019, 123.35350000000005, 100.48400000000007, 95.2775, 76.32000000000018, 102.40250000000016, 112.00699999999999, 99.83300000000023, 94.20850000000019, 85.73000000000027, 114.335, 123.46249999999999, 106.63900000000008, 106.05200000000006, -92.17999999999992, -66.78199999999978, -57.08549999999983, -62.67299999999985, -74.8084999999997, 77.61100000000039, 108.72750000000009, 115.34650000000018, 104.47850000000021, 92.09000000000029, 79.83050000000027, 111.03000000000004, 124.1635, 116.36800000000008, 106.652, 92.76550000000029, 125.47200000000002, 134.73549999999997, 116.94200000000001, 115.47850000000017, 93.38450000000027, 116.03550000000008, 129.49649999999997, 119.50700000000003, 115.07200000000022, 94.94000000000021, 121.61050000000007, 133.37899999999993, 118.94850000000001, 116.33500000000002, 93.34200000000034, 117.13300000000014, 135.44199999999995, 118.24550000000006, 114.78350000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.737619587662621, "mean_inference_ms": 6.225023914175782, "mean_action_processing_ms": 0.6458398722647145, "mean_env_wait_ms": 4.268051072101646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013465583324432373, "StateBufferConnector_ms": 0.020093321800231934, "ViewRequirementAgentConnector_ms": 0.6493562459945679}, "num_episodes": 4, "episode_return_max": 585.393500000002, "episode_return_min": -10141.812500000005, "episode_return_mean": -1983.8228437500006, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 25.879163140309096, "num_env_steps_trained_throughput_per_sec": 25.879163140309096, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 151670.36, "restore_workers_time_ms": 0.0, "training_step_time_ms": 151670.36, "sample_time_ms": 62984.039, "learn_time_ms": 88682.714, "learn_throughput": 45.105, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 20, "trial_id": "386ba_00000", "date": "2026-02-09_23-11-35", "timestamp": 1770675095, "time_this_iter_s": 154.5715057849884, "time_total_s": 3018.9186902046204, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA092711B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3018.9186902046204, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 21.16178010471204, "ram_util_percent": 41.007329842931945, "gpu_util_percent0": 0.2457068062827226, "vram_util_percent0": 0.21696097212879525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.99277400970459, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 7.9272989161708045, "policy_loss": -0.030397675280022234, "vf_loss": 7.954980192467918, "vf_explained_var": 0.7146600944094851, "kl": 0.027164010451829628, "entropy": 0.5537329631626227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 96555.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": 585.393500000002, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2131.8153809523815, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 84000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 135.44199999999995}, "policy_reward_mean": {"shared_policy": -426.3630761904762}, "custom_metrics": {"delivered_mean_agents_mean": 228.9047619047619, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 294.0, "backlog_mean_agents_mean": 13.05952380952381, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 45.0, "manual_delivery_mean_agents_mean": 0.054761904761904755, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.02142857142857143, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.014285714285714285, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.0071428571428571435, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0001685198487524069, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956, 517.3764999999976, 534.9649999999991, 502.33249999999657, 484.77099999999655, 536.2184999999987, -353.5290000000061, 498.253499999993, 538.044, 585.393500000002, 573.4955000000017, 585.2130000000036, 578.9460000000008, -2537.6894999999886, -3717.389000000016, -7670.596999999969, -6440.988999999994], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018, 80.85000000000018, 106.65700000000008, 124.92999999999984, 110.31750000000002, 94.62200000000007, 80.67100000000028, 114.94000000000007, 129.05549999999997, 117.83150000000012, 92.46700000000017, 75.10000000000022, 108.11750000000019, 123.35350000000005, 100.48400000000007, 95.2775, 76.32000000000018, 102.40250000000016, 112.00699999999999, 99.83300000000023, 94.20850000000019, 85.73000000000027, 114.335, 123.46249999999999, 106.63900000000008, 106.05200000000006, -92.17999999999992, -66.78199999999978, -57.08549999999983, -62.67299999999985, -74.8084999999997, 77.61100000000039, 108.72750000000009, 115.34650000000018, 104.47850000000021, 92.09000000000029, 79.83050000000027, 111.03000000000004, 124.1635, 116.36800000000008, 106.652, 92.76550000000029, 125.47200000000002, 134.73549999999997, 116.94200000000001, 115.47850000000017, 93.38450000000027, 116.03550000000008, 129.49649999999997, 119.50700000000003, 115.07200000000022, 94.94000000000021, 121.61050000000007, 133.37899999999993, 118.94850000000001, 116.33500000000002, 93.34200000000034, 117.13300000000014, 135.44199999999995, 118.24550000000006, 114.78350000000003, -519.6820000000008, -510.37100000000066, -490.08450000000056, -505.2565000000007, -512.2955000000007, -762.3184999999996, -747.4039999999999, -727.2814999999996, -739.2879999999993, -741.097, -1545.8235000000009, -1541.0495000000012, -1518.568000000001, -1526.7804999999998, -1538.3755000000017, -1301.6400000000006, -1294.4789999999991, -1272.3984999999989, -1284.4529999999993, -1288.018499999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.736990953996491, "mean_inference_ms": 6.212749455667027, "mean_action_processing_ms": 0.6455878407881144, "mean_env_wait_ms": 4.2650725057384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012824365070887975, "StateBufferConnector_ms": 0.021522953396751768, "ViewRequirementAgentConnector_ms": 0.6422454402560279}, "num_episodes": 4, "episode_return_max": 585.393500000002, "episode_return_min": -10141.812500000005, "episode_return_mean": -2131.8153809523815, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.222900972815992, "num_env_steps_trained_throughput_per_sec": 26.222900972815992, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 153205.707, "restore_workers_time_ms": 0.0, "training_step_time_ms": 153205.607, "sample_time_ms": 63124.508, "learn_time_ms": 90077.441, "learn_throughput": 44.406, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 21, "trial_id": "386ba_00000", "date": "2026-02-09_23-14-08", "timestamp": 1770675248, "time_this_iter_s": 152.5434217453003, "time_total_s": 3171.4621119499207, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09271C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3171.4621119499207, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.22446808510638, "ram_util_percent": 41.022872340425536, "gpu_util_percent0": 0.2551063829787234, "vram_util_percent0": 0.21703920631125984}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.48326301574707, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 0.0003, "total_loss": 4.0801811032993776, "policy_loss": -0.029668919172833996, "vf_loss": 4.107258016997335, "vf_explained_var": 0.8227920303425718, "kl": 0.01728002306305855, "entropy": 0.4705311815133773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 101265.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 627.2585000000066, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2030.8717954545455, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 88000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 143.8059999999997}, "policy_reward_mean": {"shared_policy": -406.1743590909091}, "custom_metrics": {"delivered_mean_agents_mean": 231.875, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 319.0, "backlog_mean_agents_mean": 12.988636363636363, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 45.0, "manual_delivery_mean_agents_mean": 0.05454545454545456, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.025, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.013636363636363636, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.00681818181818182, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.0001608598556272975, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956, 517.3764999999976, 534.9649999999991, 502.33249999999657, 484.77099999999655, 536.2184999999987, -353.5290000000061, 498.253499999993, 538.044, 585.393500000002, 573.4955000000017, 585.2130000000036, 578.9460000000008, -2537.6894999999886, -3717.389000000016, -7670.596999999969, -6440.988999999994, -552.6165000000024, 201.21949999999916, 79.91249999999752, 627.2585000000066], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018, 80.85000000000018, 106.65700000000008, 124.92999999999984, 110.31750000000002, 94.62200000000007, 80.67100000000028, 114.94000000000007, 129.05549999999997, 117.83150000000012, 92.46700000000017, 75.10000000000022, 108.11750000000019, 123.35350000000005, 100.48400000000007, 95.2775, 76.32000000000018, 102.40250000000016, 112.00699999999999, 99.83300000000023, 94.20850000000019, 85.73000000000027, 114.335, 123.46249999999999, 106.63900000000008, 106.05200000000006, -92.17999999999992, -66.78199999999978, -57.08549999999983, -62.67299999999985, -74.8084999999997, 77.61100000000039, 108.72750000000009, 115.34650000000018, 104.47850000000021, 92.09000000000029, 79.83050000000027, 111.03000000000004, 124.1635, 116.36800000000008, 106.652, 92.76550000000029, 125.47200000000002, 134.73549999999997, 116.94200000000001, 115.47850000000017, 93.38450000000027, 116.03550000000008, 129.49649999999997, 119.50700000000003, 115.07200000000022, 94.94000000000021, 121.61050000000007, 133.37899999999993, 118.94850000000001, 116.33500000000002, 93.34200000000034, 117.13300000000014, 135.44199999999995, 118.24550000000006, 114.78350000000003, -519.6820000000008, -510.37100000000066, -490.08450000000056, -505.2565000000007, -512.2955000000007, -762.3184999999996, -747.4039999999999, -727.2814999999996, -739.2879999999993, -741.097, -1545.8235000000009, -1541.0495000000012, -1518.568000000001, -1526.7804999999998, -1538.3755000000017, -1301.6400000000006, -1294.4789999999991, -1272.3984999999989, -1284.4529999999993, -1288.018499999999, -129.76949999999982, -106.70200000000004, -94.57000000000008, -108.60900000000007, -112.96599999999997, 23.801500000000125, 51.15749999999984, 53.63499999999997, 44.212499999999835, 28.41300000000011, -6.664999999999669, 15.80850000000021, 35.93300000000004, 19.63300000000008, 15.203000000000086, 95.81000000000031, 134.44550000000015, 143.8059999999997, 127.32000000000014, 125.87700000000017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.73641357248983, "mean_inference_ms": 6.201183830058472, "mean_action_processing_ms": 0.6453849058876245, "mean_env_wait_ms": 4.262679249298843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012241439385847612, "StateBufferConnector_ms": 0.02054463733326305, "ViewRequirementAgentConnector_ms": 0.6301281127062711}, "num_episodes": 4, "episode_return_max": 627.2585000000066, "episode_return_min": -10141.812500000005, "episode_return_mean": -2030.8717954545455, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 25.958794338469904, "num_env_steps_trained_throughput_per_sec": 25.958794338469904, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 153936.437, "restore_workers_time_ms": 0.0, "training_step_time_ms": 153936.337, "sample_time_ms": 62890.444, "learn_time_ms": 91042.136, "learn_throughput": 43.936, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 22, "trial_id": "386ba_00000", "date": "2026-02-09_23-16-42", "timestamp": 1770675402, "time_this_iter_s": 154.09640288352966, "time_total_s": 3325.5585148334503, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA092030A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3325.5585148334503, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 28.29315789473684, "ram_util_percent": 41.37315789473685, "gpu_util_percent0": 0.23536842105263156, "vram_util_percent0": 0.21629470598822406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.694881439208984, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 0.0003, "total_loss": 7.45195254257024, "policy_loss": -0.03535769807062094, "vf_loss": 7.484023831806871, "vf_explained_var": 0.7822522563412944, "kl": 0.02190937257621193, "entropy": 0.5862335622247364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 105975.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "env_runners": {"episode_reward_max": 627.2585000000066, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2066.4653315217392, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 92000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 143.8059999999997}, "policy_reward_mean": {"shared_policy": -413.2930663043479}, "custom_metrics": {"delivered_mean_agents_mean": 232.5, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 319.0, "backlog_mean_agents_mean": 13.423913043478262, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 45.0, "manual_delivery_mean_agents_mean": 0.05217391304347827, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.02391304347826087, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.015217391304347825, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.006521739130434784, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00015386594886089325, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956, 517.3764999999976, 534.9649999999991, 502.33249999999657, 484.77099999999655, 536.2184999999987, -353.5290000000061, 498.253499999993, 538.044, 585.393500000002, 573.4955000000017, 585.2130000000036, 578.9460000000008, -2537.6894999999886, -3717.389000000016, -7670.596999999969, -6440.988999999994, -552.6165000000024, 201.21949999999916, 79.91249999999752, 627.2585000000066, -1652.591500000002, -2507.2619999999965, -4429.50750000003, -2808.7314999999953], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018, 80.85000000000018, 106.65700000000008, 124.92999999999984, 110.31750000000002, 94.62200000000007, 80.67100000000028, 114.94000000000007, 129.05549999999997, 117.83150000000012, 92.46700000000017, 75.10000000000022, 108.11750000000019, 123.35350000000005, 100.48400000000007, 95.2775, 76.32000000000018, 102.40250000000016, 112.00699999999999, 99.83300000000023, 94.20850000000019, 85.73000000000027, 114.335, 123.46249999999999, 106.63900000000008, 106.05200000000006, -92.17999999999992, -66.78199999999978, -57.08549999999983, -62.67299999999985, -74.8084999999997, 77.61100000000039, 108.72750000000009, 115.34650000000018, 104.47850000000021, 92.09000000000029, 79.83050000000027, 111.03000000000004, 124.1635, 116.36800000000008, 106.652, 92.76550000000029, 125.47200000000002, 134.73549999999997, 116.94200000000001, 115.47850000000017, 93.38450000000027, 116.03550000000008, 129.49649999999997, 119.50700000000003, 115.07200000000022, 94.94000000000021, 121.61050000000007, 133.37899999999993, 118.94850000000001, 116.33500000000002, 93.34200000000034, 117.13300000000014, 135.44199999999995, 118.24550000000006, 114.78350000000003, -519.6820000000008, -510.37100000000066, -490.08450000000056, -505.2565000000007, -512.2955000000007, -762.3184999999996, -747.4039999999999, -727.2814999999996, -739.2879999999993, -741.097, -1545.8235000000009, -1541.0495000000012, -1518.568000000001, -1526.7804999999998, -1538.3755000000017, -1301.6400000000006, -1294.4789999999991, -1272.3984999999989, -1284.4529999999993, -1288.018499999999, -129.76949999999982, -106.70200000000004, -94.57000000000008, -108.60900000000007, -112.96599999999997, 23.801500000000125, 51.15749999999984, 53.63499999999997, 44.212499999999835, 28.41300000000011, -6.664999999999669, 15.80850000000021, 35.93300000000004, 19.63300000000008, 15.203000000000086, 95.81000000000031, 134.44550000000015, 143.8059999999997, 127.32000000000014, 125.87700000000017, -343.9869999999998, -327.06749999999965, -312.7054999999999, -334.86949999999973, -333.9619999999999, -514.3450000000005, -501.0945000000001, -487.5235000000002, -499.5350000000003, -504.7639999999999, -896.2499999999993, -885.9869999999992, -867.5819999999994, -884.1549999999988, -895.5334999999991, -568.8080000000004, -563.3885000000007, -545.5455000000002, -560.0940000000002, -570.8955000000007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.736265268946758, "mean_inference_ms": 6.191727256318655, "mean_action_processing_ms": 0.6452611222186325, "mean_env_wait_ms": 4.260576115218148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014977092328278915, "StateBufferConnector_ms": 0.020738529122394066, "ViewRequirementAgentConnector_ms": 0.629254268563312}, "num_episodes": 4, "episode_return_max": 627.2585000000066, "episode_return_min": -10141.812500000005, "episode_return_mean": -2066.4653315217392, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.994416159505853, "num_env_steps_trained_throughput_per_sec": 27.994416159505853, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 153722.055, "restore_workers_time_ms": 0.0, "training_step_time_ms": 153721.954, "sample_time_ms": 63296.475, "learn_time_ms": 90422.021, "learn_throughput": 44.237, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "training_iteration": 23, "trial_id": "386ba_00000", "date": "2026-02-09_23-19-05", "timestamp": 1770675545, "time_this_iter_s": 142.8926477432251, "time_total_s": 3468.4511625766754, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09201240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3468.4511625766754, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.47613636363636, "ram_util_percent": 40.943749999999994, "gpu_util_percent0": 0.2876136363636364, "vram_util_percent0": 0.21685074055158324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.58446502685547, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 7.588758531700021, "policy_loss": -0.035352252750072206, "vf_loss": 7.620320167966709, "vf_explained_var": 0.8902984164323017, "kl": 0.01684718402008831, "entropy": 0.562722051763737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 110685.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 627.2585000000066, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2140.3728072916674, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 96000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 143.8059999999997}, "policy_reward_mean": {"shared_policy": -428.0745614583332}, "custom_metrics": {"delivered_mean_agents_mean": 232.86458333333334, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 319.0, "backlog_mean_agents_mean": 13.895833333333334, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 45.0, "manual_delivery_mean_agents_mean": 0.052083333333333336, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.025000000000000005, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.014583333333333332, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.006250000000000001, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00014745486765835604, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956, 517.3764999999976, 534.9649999999991, 502.33249999999657, 484.77099999999655, 536.2184999999987, -353.5290000000061, 498.253499999993, 538.044, 585.393500000002, 573.4955000000017, 585.2130000000036, 578.9460000000008, -2537.6894999999886, -3717.389000000016, -7670.596999999969, -6440.988999999994, -552.6165000000024, 201.21949999999916, 79.91249999999752, 627.2585000000066, -1652.591500000002, -2507.2619999999965, -4429.50750000003, -2808.7314999999953, -5925.102500000056, -4068.401000000015, -5661.03749999999, 293.56199999999757], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018, 80.85000000000018, 106.65700000000008, 124.92999999999984, 110.31750000000002, 94.62200000000007, 80.67100000000028, 114.94000000000007, 129.05549999999997, 117.83150000000012, 92.46700000000017, 75.10000000000022, 108.11750000000019, 123.35350000000005, 100.48400000000007, 95.2775, 76.32000000000018, 102.40250000000016, 112.00699999999999, 99.83300000000023, 94.20850000000019, 85.73000000000027, 114.335, 123.46249999999999, 106.63900000000008, 106.05200000000006, -92.17999999999992, -66.78199999999978, -57.08549999999983, -62.67299999999985, -74.8084999999997, 77.61100000000039, 108.72750000000009, 115.34650000000018, 104.47850000000021, 92.09000000000029, 79.83050000000027, 111.03000000000004, 124.1635, 116.36800000000008, 106.652, 92.76550000000029, 125.47200000000002, 134.73549999999997, 116.94200000000001, 115.47850000000017, 93.38450000000027, 116.03550000000008, 129.49649999999997, 119.50700000000003, 115.07200000000022, 94.94000000000021, 121.61050000000007, 133.37899999999993, 118.94850000000001, 116.33500000000002, 93.34200000000034, 117.13300000000014, 135.44199999999995, 118.24550000000006, 114.78350000000003, -519.6820000000008, -510.37100000000066, -490.08450000000056, -505.2565000000007, -512.2955000000007, -762.3184999999996, -747.4039999999999, -727.2814999999996, -739.2879999999993, -741.097, -1545.8235000000009, -1541.0495000000012, -1518.568000000001, -1526.7804999999998, -1538.3755000000017, -1301.6400000000006, -1294.4789999999991, -1272.3984999999989, -1284.4529999999993, -1288.018499999999, -129.76949999999982, -106.70200000000004, -94.57000000000008, -108.60900000000007, -112.96599999999997, 23.801500000000125, 51.15749999999984, 53.63499999999997, 44.212499999999835, 28.41300000000011, -6.664999999999669, 15.80850000000021, 35.93300000000004, 19.63300000000008, 15.203000000000086, 95.81000000000031, 134.44550000000015, 143.8059999999997, 127.32000000000014, 125.87700000000017, -343.9869999999998, -327.06749999999965, -312.7054999999999, -334.86949999999973, -333.9619999999999, -514.3450000000005, -501.0945000000001, -487.5235000000002, -499.5350000000003, -504.7639999999999, -896.2499999999993, -885.9869999999992, -867.5819999999994, -884.1549999999988, -895.5334999999991, -568.8080000000004, -563.3885000000007, -545.5455000000002, -560.0940000000002, -570.8955000000007, -1183.0154999999977, -1183.2959999999975, -1173.542499999998, -1187.8734999999979, -1197.3749999999975, -824.5245000000002, -816.3505000000001, -795.0304999999997, -813.4645000000003, -819.031, -1141.0085000000001, -1127.0375, -1115.328, -1133.7635000000002, -1143.9000000000003, 40.08250000000022, 68.4520000000001, 69.40499999999982, 59.29800000000013, 56.32450000000017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.736231906614022, "mean_inference_ms": 6.182088218348473, "mean_action_processing_ms": 0.6451417106485412, "mean_env_wait_ms": 4.258612172604132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015393892923990885, "StateBufferConnector_ms": 0.020917505025863647, "ViewRequirementAgentConnector_ms": 0.6263847152392069}, "num_episodes": 4, "episode_return_max": 627.2585000000066, "episode_return_min": -10141.812500000005, "episode_return_mean": -2140.3728072916674, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.994339973411176, "num_env_steps_trained_throughput_per_sec": 27.994339973411176, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 153704.826, "restore_workers_time_ms": 0.1, "training_step_time_ms": 153704.626, "sample_time_ms": 63073.906, "learn_time_ms": 90626.862, "learn_throughput": 44.137, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 24, "trial_id": "386ba_00000", "date": "2026-02-09_23-21-28", "timestamp": 1770675688, "time_this_iter_s": 142.89454078674316, "time_total_s": 3611.3457033634186, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA092715A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3611.3457033634186, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.174431818181816, "ram_util_percent": 41.260795454545445, "gpu_util_percent0": 0.22778409090909094, "vram_util_percent0": 0.2271991717369099}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.9711856842041, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 9.073034361011157, "policy_loss": -0.035483974512891876, "vf_loss": 9.104197206719919, "vf_explained_var": 0.8237350799602055, "kl": 0.019204978559309284, "entropy": 0.6018133941729358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 115395.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "env_runners": {"episode_reward_max": 627.2585000000066, "episode_reward_min": -10141.812500000005, "episode_reward_mean": -2322.1099899999986, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -2035.031000000001}, "policy_reward_max": {"shared_policy": 143.8059999999997}, "policy_reward_mean": {"shared_policy": -464.421998}, "custom_metrics": {"delivered_mean_agents_mean": 232.36, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 319.0, "backlog_mean_agents_mean": 14.51, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 45.0, "manual_delivery_mean_agents_mean": 0.05, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.024000000000000004, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.006000000000000001, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00014155667295202178, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9688.361000000032, -9118.695000000007, -10141.812500000005, -6762.517500000011, -9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956, 517.3764999999976, 534.9649999999991, 502.33249999999657, 484.77099999999655, 536.2184999999987, -353.5290000000061, 498.253499999993, 538.044, 585.393500000002, 573.4955000000017, 585.2130000000036, 578.9460000000008, -2537.6894999999886, -3717.389000000016, -7670.596999999969, -6440.988999999994, -552.6165000000024, 201.21949999999916, 79.91249999999752, 627.2585000000066, -1652.591500000002, -2507.2619999999965, -4429.50750000003, -2808.7314999999953, -5925.102500000056, -4068.401000000015, -5661.03749999999, 293.56199999999757, -5411.226999999998, -7003.3535, -5466.829499999998, -8853.799499999832], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1933.881499999999, -1945.673, -1923.8209999999976, -1940.776999999999, -1944.2084999999993, -1821.0689999999977, -1827.031499999998, -1815.0364999999986, -1823.3004999999982, -1832.2574999999983, -2025.0030000000036, -2035.031000000001, -2024.4610000000007, -2025.8780000000008, -2031.4395000000022, -1346.6824999999997, -1356.4285, -1348.3064999999995, -1355.8270000000002, -1355.2729999999992, -1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018, 80.85000000000018, 106.65700000000008, 124.92999999999984, 110.31750000000002, 94.62200000000007, 80.67100000000028, 114.94000000000007, 129.05549999999997, 117.83150000000012, 92.46700000000017, 75.10000000000022, 108.11750000000019, 123.35350000000005, 100.48400000000007, 95.2775, 76.32000000000018, 102.40250000000016, 112.00699999999999, 99.83300000000023, 94.20850000000019, 85.73000000000027, 114.335, 123.46249999999999, 106.63900000000008, 106.05200000000006, -92.17999999999992, -66.78199999999978, -57.08549999999983, -62.67299999999985, -74.8084999999997, 77.61100000000039, 108.72750000000009, 115.34650000000018, 104.47850000000021, 92.09000000000029, 79.83050000000027, 111.03000000000004, 124.1635, 116.36800000000008, 106.652, 92.76550000000029, 125.47200000000002, 134.73549999999997, 116.94200000000001, 115.47850000000017, 93.38450000000027, 116.03550000000008, 129.49649999999997, 119.50700000000003, 115.07200000000022, 94.94000000000021, 121.61050000000007, 133.37899999999993, 118.94850000000001, 116.33500000000002, 93.34200000000034, 117.13300000000014, 135.44199999999995, 118.24550000000006, 114.78350000000003, -519.6820000000008, -510.37100000000066, -490.08450000000056, -505.2565000000007, -512.2955000000007, -762.3184999999996, -747.4039999999999, -727.2814999999996, -739.2879999999993, -741.097, -1545.8235000000009, -1541.0495000000012, -1518.568000000001, -1526.7804999999998, -1538.3755000000017, -1301.6400000000006, -1294.4789999999991, -1272.3984999999989, -1284.4529999999993, -1288.018499999999, -129.76949999999982, -106.70200000000004, -94.57000000000008, -108.60900000000007, -112.96599999999997, 23.801500000000125, 51.15749999999984, 53.63499999999997, 44.212499999999835, 28.41300000000011, -6.664999999999669, 15.80850000000021, 35.93300000000004, 19.63300000000008, 15.203000000000086, 95.81000000000031, 134.44550000000015, 143.8059999999997, 127.32000000000014, 125.87700000000017, -343.9869999999998, -327.06749999999965, -312.7054999999999, -334.86949999999973, -333.9619999999999, -514.3450000000005, -501.0945000000001, -487.5235000000002, -499.5350000000003, -504.7639999999999, -896.2499999999993, -885.9869999999992, -867.5819999999994, -884.1549999999988, -895.5334999999991, -568.8080000000004, -563.3885000000007, -545.5455000000002, -560.0940000000002, -570.8955000000007, -1183.0154999999977, -1183.2959999999975, -1173.542499999998, -1187.8734999999979, -1197.3749999999975, -824.5245000000002, -816.3505000000001, -795.0304999999997, -813.4645000000003, -819.031, -1141.0085000000001, -1127.0375, -1115.328, -1133.7635000000002, -1143.9000000000003, 40.08250000000022, 68.4520000000001, 69.40499999999982, 59.29800000000013, 56.32450000000017, -1084.2600000000023, -1079.4250000000025, -1070.3025000000018, -1088.0090000000018, -1089.2305000000024, -1407.3805000000007, -1399.6775000000016, -1385.4035000000022, -1404.3535000000015, -1406.538500000001, -1098.9980000000014, -1092.021500000001, -1076.1150000000016, -1094.4425000000015, -1105.2525000000016, -1770.1585000000027, -1768.9495000000031, -1756.4075000000028, -1778.8670000000034, -1779.4170000000029]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7365228840165665, "mean_inference_ms": 6.172157814111092, "mean_action_processing_ms": 0.6450122227433566, "mean_env_wait_ms": 4.256753761287667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01577615737915039, "StateBufferConnector_ms": 0.0200808048248291, "ViewRequirementAgentConnector_ms": 0.6257705688476562}, "num_episodes": 4, "episode_return_max": 627.2585000000066, "episode_return_min": -10141.812500000005, "episode_return_mean": -2322.1099899999986, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.869565665686746, "num_env_steps_trained_throughput_per_sec": 28.869565665686746, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 152946.094, "restore_workers_time_ms": 0.1, "training_step_time_ms": 152945.894, "sample_time_ms": 62701.884, "learn_time_ms": 90239.952, "learn_throughput": 44.326, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "training_iteration": 25, "trial_id": "386ba_00000", "date": "2026-02-09_23-23-46", "timestamp": 1770675826, "time_this_iter_s": 138.56121444702148, "time_total_s": 3749.90691781044, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09201A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3749.90691781044, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 27.878488372093024, "ram_util_percent": 41.39883720930233, "gpu_util_percent0": 0.2447093023255814, "vram_util_percent0": 0.24075078674407244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.394672393798828, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 7.514641158697205, "policy_loss": -0.03583910566440244, "vf_loss": 7.546284053988771, "vf_explained_var": 0.9084144604307325, "kl": 0.018649822209180756, "entropy": 0.5612263113450093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 120105.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 627.2585000000066, "episode_reward_min": -9237.583499999984, "episode_reward_mean": -2151.543619999997, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -1856.6529999999989}, "policy_reward_max": {"shared_policy": 143.8059999999997}, "policy_reward_mean": {"shared_policy": -430.30872400000015}, "custom_metrics": {"delivered_mean_agents_mean": 232.98, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 319.0, "backlog_mean_agents_mean": 14.02, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 45.0, "manual_delivery_mean_agents_mean": 0.05, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.024000000000000004, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.016, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.006000000000000001, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00014155667295202178, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-9008.001999999964, -6520.371499999972, -9237.583499999984, -8500.011499999988, -8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956, 517.3764999999976, 534.9649999999991, 502.33249999999657, 484.77099999999655, 536.2184999999987, -353.5290000000061, 498.253499999993, 538.044, 585.393500000002, 573.4955000000017, 585.2130000000036, 578.9460000000008, -2537.6894999999886, -3717.389000000016, -7670.596999999969, -6440.988999999994, -552.6165000000024, 201.21949999999916, 79.91249999999752, 627.2585000000066, -1652.591500000002, -2507.2619999999965, -4429.50750000003, -2808.7314999999953, -5925.102500000056, -4068.401000000015, -5661.03749999999, 293.56199999999757, -5411.226999999998, -7003.3535, -5466.829499999998, -8853.799499999832, 352.8004999999991, -2913.889499999999, -8377.752999999924, -7715.906999999968], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1795.3045000000002, -1807.3380000000006, -1793.2850000000012, -1805.8534999999997, -1806.221, -1301.4880000000023, -1314.1120000000028, -1296.3805000000025, -1300.9055000000035, -1307.4855000000032, -1845.2784999999988, -1856.6529999999989, -1837.8344999999988, -1845.781999999999, -1852.0354999999984, -1692.0604999999985, -1709.1789999999983, -1693.6879999999976, -1701.9654999999989, -1703.1184999999984, -1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018, 80.85000000000018, 106.65700000000008, 124.92999999999984, 110.31750000000002, 94.62200000000007, 80.67100000000028, 114.94000000000007, 129.05549999999997, 117.83150000000012, 92.46700000000017, 75.10000000000022, 108.11750000000019, 123.35350000000005, 100.48400000000007, 95.2775, 76.32000000000018, 102.40250000000016, 112.00699999999999, 99.83300000000023, 94.20850000000019, 85.73000000000027, 114.335, 123.46249999999999, 106.63900000000008, 106.05200000000006, -92.17999999999992, -66.78199999999978, -57.08549999999983, -62.67299999999985, -74.8084999999997, 77.61100000000039, 108.72750000000009, 115.34650000000018, 104.47850000000021, 92.09000000000029, 79.83050000000027, 111.03000000000004, 124.1635, 116.36800000000008, 106.652, 92.76550000000029, 125.47200000000002, 134.73549999999997, 116.94200000000001, 115.47850000000017, 93.38450000000027, 116.03550000000008, 129.49649999999997, 119.50700000000003, 115.07200000000022, 94.94000000000021, 121.61050000000007, 133.37899999999993, 118.94850000000001, 116.33500000000002, 93.34200000000034, 117.13300000000014, 135.44199999999995, 118.24550000000006, 114.78350000000003, -519.6820000000008, -510.37100000000066, -490.08450000000056, -505.2565000000007, -512.2955000000007, -762.3184999999996, -747.4039999999999, -727.2814999999996, -739.2879999999993, -741.097, -1545.8235000000009, -1541.0495000000012, -1518.568000000001, -1526.7804999999998, -1538.3755000000017, -1301.6400000000006, -1294.4789999999991, -1272.3984999999989, -1284.4529999999993, -1288.018499999999, -129.76949999999982, -106.70200000000004, -94.57000000000008, -108.60900000000007, -112.96599999999997, 23.801500000000125, 51.15749999999984, 53.63499999999997, 44.212499999999835, 28.41300000000011, -6.664999999999669, 15.80850000000021, 35.93300000000004, 19.63300000000008, 15.203000000000086, 95.81000000000031, 134.44550000000015, 143.8059999999997, 127.32000000000014, 125.87700000000017, -343.9869999999998, -327.06749999999965, -312.7054999999999, -334.86949999999973, -333.9619999999999, -514.3450000000005, -501.0945000000001, -487.5235000000002, -499.5350000000003, -504.7639999999999, -896.2499999999993, -885.9869999999992, -867.5819999999994, -884.1549999999988, -895.5334999999991, -568.8080000000004, -563.3885000000007, -545.5455000000002, -560.0940000000002, -570.8955000000007, -1183.0154999999977, -1183.2959999999975, -1173.542499999998, -1187.8734999999979, -1197.3749999999975, -824.5245000000002, -816.3505000000001, -795.0304999999997, -813.4645000000003, -819.031, -1141.0085000000001, -1127.0375, -1115.328, -1133.7635000000002, -1143.9000000000003, 40.08250000000022, 68.4520000000001, 69.40499999999982, 59.29800000000013, 56.32450000000017, -1084.2600000000023, -1079.4250000000025, -1070.3025000000018, -1088.0090000000018, -1089.2305000000024, -1407.3805000000007, -1399.6775000000016, -1385.4035000000022, -1404.3535000000015, -1406.538500000001, -1098.9980000000014, -1092.021500000001, -1076.1150000000016, -1094.4425000000015, -1105.2525000000016, -1770.1585000000027, -1768.9495000000031, -1756.4075000000028, -1778.8670000000034, -1779.4170000000029, 52.29749999999988, 80.92150000000012, 87.09349999999984, 67.73600000000013, 64.7520000000001, -591.0305000000005, -581.8610000000001, -569.8960000000001, -584.1435, -586.9585000000003, -1676.6245000000042, -1681.073500000005, -1656.0655000000036, -1679.8805000000045, -1684.1090000000052, -1547.9490000000017, -1544.3945000000017, -1529.6755000000012, -1545.2330000000013, -1548.6550000000013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.73941649188243, "mean_inference_ms": 6.133857715257984, "mean_action_processing_ms": 0.6449346181110975, "mean_env_wait_ms": 4.237356641636244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017766237258911133, "StateBufferConnector_ms": 0.021586894989013672, "ViewRequirementAgentConnector_ms": 0.6298534870147705}, "num_episodes": 4, "episode_return_max": 627.2585000000066, "episode_return_min": -9237.583499999984, "episode_return_mean": -2151.543619999997, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 25.50062863856546, "num_env_steps_trained_throughput_per_sec": 25.50062863856546, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 152324.235, "restore_workers_time_ms": 0.1, "training_step_time_ms": 152324.034, "sample_time_ms": 62770.589, "learn_time_ms": 89549.64, "learn_throughput": 44.668, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 26, "trial_id": "386ba_00000", "date": "2026-02-09_23-26-23", "timestamp": 1770675983, "time_this_iter_s": 156.8663957118988, "time_total_s": 3906.773313522339, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA09272DD0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3906.773313522339, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 31.15129533678757, "ram_util_percent": 41.247150259067354, "gpu_util_percent0": 0.2776165803108808, "vram_util_percent0": 0.23917156662979563}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.604598999023438, "cur_kl_coeff": 0.225, "cur_lr": 0.0003, "total_loss": 6.514822797208328, "policy_loss": -0.031924279700399176, "vf_loss": 6.542751751128276, "vf_explained_var": 0.845584588382401, "kl": 0.0177569801612983, "entropy": 0.5025405696939258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 124815.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": 627.2585000000066, "episode_reward_min": -8853.799499999832, "episode_reward_mean": -1900.8047299999976, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_timesteps_total": 100000, "policy_reward_min": {"shared_policy": -1779.4170000000029}, "policy_reward_max": {"shared_policy": 143.8059999999997}, "policy_reward_mean": {"shared_policy": -380.16094600000014}, "custom_metrics": {"delivered_mean_agents_mean": 233.66, "delivered_mean_agents_min": 193.0, "delivered_mean_agents_max": 319.0, "backlog_mean_agents_mean": 13.53, "backlog_mean_agents_min": 0.0, "backlog_mean_agents_max": 45.0, "manual_delivery_mean_agents_mean": 0.05200000000000001, "manual_delivery_mean_agents_min": 0.0, "manual_delivery_mean_agents_max": 0.4, "harvest_mean_agents_mean": 0.026000000000000006, "harvest_mean_agents_min": 0.0, "harvest_mean_agents_max": 0.2, "enqueue_mean_agents_mean": 0.014000000000000002, "enqueue_mean_agents_min": 0.0, "enqueue_mean_agents_max": 0.2, "drone_credit_mean_agents_mean": 0.006000000000000001, "drone_credit_mean_agents_min": 0.0, "drone_credit_mean_agents_max": 0.2, "drone_share_proxy_mean": 0.00014155667295202178, "drone_share_proxy_min": 0.0, "drone_share_proxy_max": 0.005}, "hist_stats": {"episode_reward": [-8424.537499999977, -8310.122999999954, -8313.9595, -6812.3434999999845, -3029.8654999999967, -6558.96949999995, -6136.35250000001, -689.5405000000069, -1521.4759999999958, -7156.924499999981, -4758.690999999973, -8281.58450000006, -4364.64850000002, -548.2685000000001, -335.4194999999981, -3599.5505000000144, -4231.2545000000055, -2335.845999999997, -2879.6050000000128, -4535.820499999987, -3027.5264999999767, -833.3840000000023, -328.7140000000006, -796.9630000000045, 442.73149999999623, 176.75649999999465, 49.74599999999966, 332.0729999999951, -953.965999999999, -1654.7725000000094, -2028.7935000000039, -157.65700000000248, -364.99149999999935, 96.5834999999954, 327.62099999999543, 415.04149999999623, 419.86199999999815, -5.5385000000030935, 447.82549999999605, 146.0909999999976, 424.4679999999968, 462.7799999999959, 406.75149999999473, 413.0704999999957, 275.7044999999959, 252.50349999999472, 486.0194999999949, -1005.6580000000057, 478.30049999999585, 125.62249999999808, 462.37599999999634, 479.77699999999624, 35.5829999999935, 479.801499999996, 454.349499999997, 453.719499999996, -1303.440500000002, 471.0454999999967, 511.6464999999965, 448.3819999999956, 517.3764999999976, 534.9649999999991, 502.33249999999657, 484.77099999999655, 536.2184999999987, -353.5290000000061, 498.253499999993, 538.044, 585.393500000002, 573.4955000000017, 585.2130000000036, 578.9460000000008, -2537.6894999999886, -3717.389000000016, -7670.596999999969, -6440.988999999994, -552.6165000000024, 201.21949999999916, 79.91249999999752, 627.2585000000066, -1652.591500000002, -2507.2619999999965, -4429.50750000003, -2808.7314999999953, -5925.102500000056, -4068.401000000015, -5661.03749999999, 293.56199999999757, -5411.226999999998, -7003.3535, -5466.829499999998, -8853.799499999832, 352.8004999999991, -2913.889499999999, -8377.752999999924, -7715.906999999968, -3933.7750000000083, -1361.2209999999977, -3485.1744999999664, 588.0910000000038], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "policy_shared_policy_reward": [-1676.2729999999997, -1693.1055000000003, -1672.2355000000005, -1690.7935000000007, -1692.1300000000003, -1655.8310000000017, -1672.332000000002, -1652.8725000000015, -1662.029000000002, -1667.058500000002, -1657.3245000000009, -1674.069000000001, -1650.1590000000003, -1662.1180000000006, -1670.2890000000011, -1358.9899999999996, -1376.3364999999994, -1351.6324999999995, -1365.9114999999983, -1359.472999999999, -606.7475000000005, -614.0085000000009, -598.4730000000004, -604.6415000000007, -605.9950000000009, -1305.9300000000035, -1318.383500000003, -1297.0225000000037, -1323.1460000000031, -1314.487500000003, -1224.3265000000017, -1235.186000000002, -1216.9240000000016, -1226.626000000002, -1233.2900000000013, -139.46449999999973, -144.61949999999985, -130.02949999999987, -138.16899999999978, -137.25799999999992, -302.953, -307.4289999999998, -296.9560000000002, -305.92949999999996, -308.20849999999984, -1426.4924999999998, -1441.372500000001, -1423.9275000000011, -1430.3230000000012, -1434.8090000000009, -950.5000000000002, -959.7575000000005, -938.3255000000004, -952.5410000000002, -957.5670000000005, -1650.2339999999992, -1666.431499999998, -1650.6929999999982, -1654.1394999999975, -1660.0864999999983, -870.6379999999996, -878.9859999999994, -858.0424999999999, -877.6729999999992, -879.3089999999993, -118.72900000000004, -110.27899999999995, -98.83249999999997, -107.61950000000002, -112.80850000000011, -70.41849999999998, -64.09899999999996, -63.17099999999997, -68.022, -69.70899999999996, -717.0785000000001, -723.0669999999999, -708.5520000000001, -722.7355000000001, -728.1174999999997, -844.6500000000001, -849.0114999999997, -839.33, -851.9765000000003, -846.2864999999995, -467.8330000000005, -474.4375000000004, -456.44700000000034, -464.23550000000046, -472.8930000000006, -574.9570000000002, -578.88, -561.535, -582.341, -581.8920000000003, -903.9620000000003, -913.2710000000002, -896.9575000000007, -911.5025000000006, -910.1275000000005, -606.007, -607.137, -596.3519999999997, -608.5230000000003, -609.5075, -170.63699999999994, -163.84199999999993, -161.16700000000012, -160.5810000000001, -177.15699999999998, -73.42200000000007, -63.14350000000004, -57.33450000000005, -59.047000000000054, -75.76700000000004, -165.51, -162.45749999999987, -151.03249999999983, -159.2169999999999, -158.74599999999992, 72.58000000000015, 88.89050000000012, 105.79549999999998, 91.30550000000007, 84.16000000000005, 26.53999999999998, 32.40100000000002, 50.98750000000003, 41.5215, 25.3065, 3.6910000000000287, 11.12599999999999, 23.612499999999997, 8.45949999999999, 2.8570000000000255, 58.46000000000022, 67.73650000000019, 76.28750000000005, 72.01850000000013, 57.570500000000216, -196.02000000000007, -189.084, -175.36800000000008, -197.90149999999997, -195.59250000000006, -332.27599999999984, -332.20650000000006, -320.22750000000013, -331.84299999999996, -338.2195, -407.99600000000015, -408.54549999999966, -390.16749999999985, -410.4264999999998, -411.65800000000013, -39.46999999999996, -32.74299999999997, -20.17649999999984, -29.491999999999962, -35.77549999999997, -81.6059999999999, -70.46799999999993, -61.07749999999991, -71.85599999999997, -79.98399999999994, 9.62000000000006, 21.71100000000009, 32.42050000000016, 18.615000000000105, 14.217000000000068, 52.24050000000012, 61.942000000000135, 81.5020000000002, 71.29850000000009, 60.638000000000176, 68.19000000000017, 81.90250000000009, 98.33600000000008, 88.07000000000012, 78.54300000000016, 72.13050000000011, 86.09550000000003, 92.16749999999992, 91.43449999999987, 78.03400000000009, -11.819499999999907, 4.28250000000021, 8.29400000000006, 1.6955000000000255, -7.991000000000014, 75.28000000000014, 94.13550000000012, 101.53100000000009, 91.94400000000013, 84.93500000000009, 16.760500000000082, 38.91100000000004, 35.1375, 29.951000000000043, 25.331000000000074, 66.05000000000015, 83.85700000000016, 102.43600000000002, 95.22450000000006, 76.90050000000011, 77.30000000000022, 94.89350000000015, 107.06650000000002, 96.03400000000012, 87.48600000000012, 65.6800000000002, 84.40300000000018, 93.25000000000014, 83.29450000000018, 80.12400000000014, 66.99000000000012, 90.0805000000001, 101.41950000000004, 83.13900000000015, 71.44150000000018, 42.4805000000002, 59.911000000000136, 66.96450000000004, 58.31150000000006, 48.03700000000019, 34.75000000000002, 54.256000000000064, 67.04700000000022, 56.09900000000014, 40.35150000000008, 79.49000000000022, 108.09750000000015, 115.15050000000016, 91.48050000000019, 91.80100000000016, -206.2844999999998, -197.7299999999998, -192.7544999999998, -200.96949999999973, -207.91949999999989, 77.8005000000002, 102.51249999999999, 115.39350000000006, 93.37550000000023, 89.21850000000022, 16.50099999999994, 33.503500000000045, 37.80450000000005, 17.394999999999943, 20.41850000000001, 76.82050000000018, 102.18800000000019, 114.55200000000004, 86.19100000000012, 82.62450000000015, 78.82000000000022, 102.89950000000009, 112.79150000000003, 99.7520000000001, 85.51400000000015, -10.89849999999986, 9.34350000000028, 22.673500000000278, 10.509500000000251, 3.955000000000332, 78.77000000000021, 103.10600000000015, 112.97299999999998, 98.97750000000013, 85.97500000000008, 66.89050000000013, 100.3975000000001, 105.9105, 95.36900000000003, 85.78200000000011, 71.0100000000002, 94.09000000000013, 104.62950000000004, 102.31900000000003, 81.6710000000002, -267.5099999999999, -258.3564999999999, -251.57499999999982, -257.77099999999996, -268.22799999999995, 75.7620000000002, 103.31550000000014, 112.19749999999999, 95.91250000000005, 83.85800000000008, 80.95000000000026, 114.00550000000007, 118.77299999999993, 99.99900000000012, 97.91900000000011, 69.22000000000023, 97.59200000000023, 107.93000000000002, 96.18850000000009, 77.45150000000018, 80.85000000000018, 106.65700000000008, 124.92999999999984, 110.31750000000002, 94.62200000000007, 80.67100000000028, 114.94000000000007, 129.05549999999997, 117.83150000000012, 92.46700000000017, 75.10000000000022, 108.11750000000019, 123.35350000000005, 100.48400000000007, 95.2775, 76.32000000000018, 102.40250000000016, 112.00699999999999, 99.83300000000023, 94.20850000000019, 85.73000000000027, 114.335, 123.46249999999999, 106.63900000000008, 106.05200000000006, -92.17999999999992, -66.78199999999978, -57.08549999999983, -62.67299999999985, -74.8084999999997, 77.61100000000039, 108.72750000000009, 115.34650000000018, 104.47850000000021, 92.09000000000029, 79.83050000000027, 111.03000000000004, 124.1635, 116.36800000000008, 106.652, 92.76550000000029, 125.47200000000002, 134.73549999999997, 116.94200000000001, 115.47850000000017, 93.38450000000027, 116.03550000000008, 129.49649999999997, 119.50700000000003, 115.07200000000022, 94.94000000000021, 121.61050000000007, 133.37899999999993, 118.94850000000001, 116.33500000000002, 93.34200000000034, 117.13300000000014, 135.44199999999995, 118.24550000000006, 114.78350000000003, -519.6820000000008, -510.37100000000066, -490.08450000000056, -505.2565000000007, -512.2955000000007, -762.3184999999996, -747.4039999999999, -727.2814999999996, -739.2879999999993, -741.097, -1545.8235000000009, -1541.0495000000012, -1518.568000000001, -1526.7804999999998, -1538.3755000000017, -1301.6400000000006, -1294.4789999999991, -1272.3984999999989, -1284.4529999999993, -1288.018499999999, -129.76949999999982, -106.70200000000004, -94.57000000000008, -108.60900000000007, -112.96599999999997, 23.801500000000125, 51.15749999999984, 53.63499999999997, 44.212499999999835, 28.41300000000011, -6.664999999999669, 15.80850000000021, 35.93300000000004, 19.63300000000008, 15.203000000000086, 95.81000000000031, 134.44550000000015, 143.8059999999997, 127.32000000000014, 125.87700000000017, -343.9869999999998, -327.06749999999965, -312.7054999999999, -334.86949999999973, -333.9619999999999, -514.3450000000005, -501.0945000000001, -487.5235000000002, -499.5350000000003, -504.7639999999999, -896.2499999999993, -885.9869999999992, -867.5819999999994, -884.1549999999988, -895.5334999999991, -568.8080000000004, -563.3885000000007, -545.5455000000002, -560.0940000000002, -570.8955000000007, -1183.0154999999977, -1183.2959999999975, -1173.542499999998, -1187.8734999999979, -1197.3749999999975, -824.5245000000002, -816.3505000000001, -795.0304999999997, -813.4645000000003, -819.031, -1141.0085000000001, -1127.0375, -1115.328, -1133.7635000000002, -1143.9000000000003, 40.08250000000022, 68.4520000000001, 69.40499999999982, 59.29800000000013, 56.32450000000017, -1084.2600000000023, -1079.4250000000025, -1070.3025000000018, -1088.0090000000018, -1089.2305000000024, -1407.3805000000007, -1399.6775000000016, -1385.4035000000022, -1404.3535000000015, -1406.538500000001, -1098.9980000000014, -1092.021500000001, -1076.1150000000016, -1094.4425000000015, -1105.2525000000016, -1770.1585000000027, -1768.9495000000031, -1756.4075000000028, -1778.8670000000034, -1779.4170000000029, 52.29749999999988, 80.92150000000012, 87.09349999999984, 67.73600000000013, 64.7520000000001, -591.0305000000005, -581.8610000000001, -569.8960000000001, -584.1435, -586.9585000000003, -1676.6245000000042, -1681.073500000005, -1656.0655000000036, -1679.8805000000045, -1684.1090000000052, -1547.9490000000017, -1544.3945000000017, -1529.6755000000012, -1545.2330000000013, -1548.6550000000013, -790.0655000000002, -785.9034999999996, -774.8284999999996, -783.7639999999999, -799.2135, -283.5475, -264.49049999999977, -257.79349999999977, -274.9894999999999, -280.39999999999986, -703.2260000000006, -695.1350000000009, -679.2840000000009, -698.8900000000008, -708.6395000000005, 89.83000000000028, 125.84749999999993, 133.1405000000001, 123.6134999999998, 115.65950000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.73914167446389, "mean_inference_ms": 6.0936276681882235, "mean_action_processing_ms": 0.6444166548142971, "mean_env_wait_ms": 4.229383252886368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01576828956604004, "StateBufferConnector_ms": 0.02259206771850586, "ViewRequirementAgentConnector_ms": 0.6222333908081055}, "num_episodes": 4, "episode_return_max": 627.2585000000066, "episode_return_min": -8853.799499999832, "episode_return_mean": -1900.8047299999976, "episodes_this_iter": 4}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.197943344721324, "num_env_steps_trained_throughput_per_sec": 29.197943344721324, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 148942.032, "restore_workers_time_ms": 0.1, "training_step_time_ms": 148941.832, "sample_time_ms": 61843.631, "learn_time_ms": 87094.343, "learn_throughput": 45.927, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 27, "trial_id": "386ba_00000", "date": "2026-02-09_23-28-40", "timestamp": 1770676120, "time_this_iter_s": 137.0049591064453, "time_total_s": 4043.778272628784, "pid": 63704, "hostname": "DESKTOP-1HI26E8", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MultiAgentVine", "env_config": {"render_mode": "terminal", "topology_mode": "row", "vineyard_file": "d:\\PhD\\agriRL\\data\\Vinha_Maria_Teresa_RL.xlsx", "num_humans": 5, "num_drones": 1, "max_boxes_per_vine": 10, "max_steps": 1000, "max_backlog": 10, "dt": 1.0, "harvest_time": 5.0, "human_speed": 0.5, "drone_speed": 1.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "sync", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "torch_action_mask_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001EA092731C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class '__main__.VineyardKPI'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4043.778272628784, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 28.31588235294118, "ram_util_percent": 41.55117647058824, "gpu_util_percent0": 0.22276470588235292, "vram_util_percent0": 0.2408179832753815}}
